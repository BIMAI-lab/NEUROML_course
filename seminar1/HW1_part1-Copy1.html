

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Homework1, part 1. EEG analysis (7 pt) &#8212; Neuroimaging and Machine Learning for Biomedicine</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'seminar1/HW1_part1-Copy1';</script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to the Neuroimaging and Machine Learning for Biomedicine coursebook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../bio/intro_links.html">Links</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1AM67Sd37J0hIJ-kLyzAZRm8op_JcUQ9b?usp=sharing">Intro to shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar0/Seminar1_python_colab.html">How to work with Python</a></li>




<li class="toctree-l1"><a class="reference internal" href="../seminar0/Seminar1_ML.html">Intro to ML</a></li>

















<li class="toctree-l1"><a class="reference internal" href="../seminar0/00_pytorch_fundamentals.html">Pytorch fundamentals</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1q0XncKq2y_wHLXJaxhjfBCDGHABmzrjM/view?usp=sharing">Intro to computer vision</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminar 1. Working with EEG</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="seminar1_working_with_eeg_ipynb_.html">Seminar 1. EEG analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminars 2-3. Working with MRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../seminar2/docker.html">Preparation to Seminar 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar2/seminar2_1_mri.html">Seminar 2.1. MRI data analysis, databases and tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar2/seminar2_2_transform.html">Transformations</a></li>





<li class="toctree-l1"><a class="reference internal" href="../seminar2/seminar2_3_freesurfer.html">FREESURFER</a></li>


<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1HuS7ChgQvch4vrD8gfITGUZP9E8hZ8Hw/view?usp=sharing">Seminar 3.1. MRI classification with 3D CNN</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1m7mWY0LI2M6PdevJf5rLCdm-WrAOoXJ-/view?usp=sharing">Seminar 3.2. MRI segmentation with 3D U-net</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminar 4-6. Working with fMRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../seminar4/README.html">Preparation to Seminar 4</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1V3pLq3B_AdMFBL3EVJD9VFU7GJ0PvAA5?usp=sharing">Seminar 5. Functional connectivity</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1elqHcFpcx1_QX4jhbNihM0whPgfJzBV3?usp=sharing">Seminar 6.1. Extract ICA components from fMRI data</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1zFSdOD0HkhTi9r2l4t_pbW--FFgTK9fm?usp=sharing">Seminar 6.2. Deep Learning methods for fMRI data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminar 7. Interpretation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1sJtU1uWezC-hEpDSkyhl0toioOt3F8FF?usp=sharing">Seminar 7. Interpretation of 3D CNNs for Brain MRI Data Classification</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BIMAI-lab/NEUROML_course" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BIMAI-lab/NEUROML_course/issues/new?title=Issue%20on%20page%20%2Fseminar1/HW1_part1-Copy1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/seminar1/HW1_part1-Copy1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Homework1, part 1. EEG analysis (7 pt)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-and-visualize-the-data-2-pt">1. Read and visualize the data (2 pt)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-the-data-s010r03-edf-and-get-info-0-5-pt">1.1 Read the data <code class="docutils literal notranslate"><span class="pre">S010R03.edf</span></code> and get info (0.5 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-sampling-frequency-0-25-pt">1.2 Calculate the sampling frequency (0.25 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-best-montage-for-the-data-1-pt">Set the best montage for the data (1 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#channel-selection-and-adding-a-montage">Channel selection and adding a montage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-the-signals">Explore the signals</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#band-pass-filtering">Band-pass filtering</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-eeg-signals">Plot EEG signals</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-events">Extracting events</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2">Part 2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-component-analysis-for-artifact-removal">Independent Component Analysis for Artifact Removal</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-eeg-artifacts">Types of EEG artifacts</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="homework1-part-1-eeg-analysis-7-pt">
<h1>Homework1, part 1. EEG analysis (7 pt)<a class="headerlink" href="#homework1-part-1-eeg-analysis-7-pt" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/drive/1H81W_DpkHv-ZC9bEbOBW9zfcOe7SCDnR?usp=sharing"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p><strong>Plan</strong></p>
<ol class="arabic simple">
<li><p>Read and visualize the data (<strong>2 pt</strong>)</p></li>
<li><p>Preprocess the data (<strong>1 pt</strong>)</p></li>
<li><p>Use ICA for noise reduction (<strong>2 pt</strong>)</p></li>
<li><p>Compute ERP, plot topomaps for ERP, and analyze (<strong>2 pt</strong>)</p></li>
</ol>
<p><strong>If the notebook is hard to read, we will subtract 1 point. If the notebook is not reproducible (the random seed is not fixed) and/or runs with errors, this part of the homework will be scored with 0 points.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For Colab only</span>
<span class="c1"># !pip install mne</span>
<span class="c1"># !pip install mne-connectivity</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># not in colab</span>
<span class="c1"># %matplotlib notebook</span>
<span class="c1"># in colab</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>We will work with data for one patient from <a class="reference external" href="https://www.physionet.org/content/eegmmidb/1.0.0/">EEG Motor Movement/Imagery Dataset</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># !wget &quot;https://www.physionet.org/files/eegmmidb/1.0.0/S010/S010R03.edf&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># !ls</span>
</pre></div>
</div>
</div>
</div>
<section id="read-and-visualize-the-data-2-pt">
<h2>1. Read and visualize the data (2 pt)<a class="headerlink" href="#read-and-visualize-the-data-2-pt" title="Permalink to this headline">#</a></h2>
<section id="read-the-data-s010r03-edf-and-get-info-0-5-pt">
<h3>1.1 Read the data <code class="docutils literal notranslate"><span class="pre">S010R03.edf</span></code> and get info (0.5 pt)<a class="headerlink" href="#read-the-data-s010r03-edf-and-get-info-0-5-pt" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-the-sampling-frequency-0-25-pt">
<h3>1.2 Calculate the sampling frequency (0.25 pt)<a class="headerlink" href="#calculate-the-sampling-frequency-0-25-pt" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-the-best-montage-for-the-data-1-pt">
<h3>Set the best montage for the data (1 pt)<a class="headerlink" href="#set-the-best-montage-for-the-data-1-pt" title="Permalink to this headline">#</a></h3>
<p>The EEGs in the data were recorded from 64 electrodes as per the international 10-10 system. Find the montage from <code class="docutils literal notranslate"><span class="pre">mne.channels.get_builtin_montages(descriptions=True)</span></code> with 10-10 electrode names. Correct the channel names and <code class="docutils literal notranslate"><span class="pre">pick</span></code> only that channels that the montage has.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mne</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">get_builtin_montages</span><span class="p">(</span><span class="n">descriptions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;standard_1005&#39;,
  &#39;Electrodes are named and positioned according to the international 10-05 system (343+3 locations)&#39;),
 (&#39;standard_1020&#39;,
  &#39;Electrodes are named and positioned according to the international 10-20 system (94+3 locations)&#39;),
 (&#39;standard_alphabetic&#39;,
  &#39;Electrodes are named with LETTER-NUMBER combinations (A1, B2, F4, …) (65+3 locations)&#39;),
 (&#39;standard_postfixed&#39;,
  &#39;Electrodes are named according to the international 10-20 system using postfixes for intermediate positions (100+3 locations)&#39;),
 (&#39;standard_prefixed&#39;,
  &#39;Electrodes are named according to the international 10-20 system using prefixes for intermediate positions (74+3 locations)&#39;),
 (&#39;standard_primed&#39;,
  &quot;Electrodes are named according to the international 10-20 system using prime marks (&#39; and &#39;&#39;) for intermediate positions (100+3 locations)&quot;),
 (&#39;biosemi16&#39;, &#39;BioSemi cap with 16 electrodes (16+3 locations)&#39;),
 (&#39;biosemi32&#39;, &#39;BioSemi cap with 32 electrodes (32+3 locations)&#39;),
 (&#39;biosemi64&#39;, &#39;BioSemi cap with 64 electrodes (64+3 locations)&#39;),
 (&#39;biosemi128&#39;, &#39;BioSemi cap with 128 electrodes (128+3 locations)&#39;),
 (&#39;biosemi160&#39;, &#39;BioSemi cap with 160 electrodes (160+3 locations)&#39;),
 (&#39;biosemi256&#39;, &#39;BioSemi cap with 256 electrodes (256+3 locations)&#39;),
 (&#39;easycap-M1&#39;, &#39;EasyCap with 10-05 electrode names (74 locations)&#39;),
 (&#39;easycap-M10&#39;, &#39;EasyCap with numbered electrodes (61 locations)&#39;),
 (&#39;easycap-M43&#39;, &#39;EasyCap with numbered electrodes (64 locations)&#39;),
 (&#39;EGI_256&#39;, &#39;Geodesic Sensor Net (256 locations)&#39;),
 (&#39;GSN-HydroCel-32&#39;, &#39;HydroCel Geodesic Sensor Net and Cz (33+3 locations)&#39;),
 (&#39;GSN-HydroCel-64_1.0&#39;, &#39;HydroCel Geodesic Sensor Net (64+3 locations)&#39;),
 (&#39;GSN-HydroCel-65_1.0&#39;,
  &#39;HydroCel Geodesic Sensor Net and Cz (65+3 locations)&#39;),
 (&#39;GSN-HydroCel-128&#39;, &#39;HydroCel Geodesic Sensor Net (128+3 locations)&#39;),
 (&#39;GSN-HydroCel-129&#39;, &#39;HydroCel Geodesic Sensor Net and Cz (129+3 locations)&#39;),
 (&#39;GSN-HydroCel-256&#39;, &#39;HydroCel Geodesic Sensor Net (256+3 locations)&#39;),
 (&#39;GSN-HydroCel-257&#39;, &#39;HydroCel Geodesic Sensor Net and Cz (257+3 locations)&#39;),
 (&#39;mgh60&#39;, &#39;The (older) 60-channel cap used at MGH (60+3 locations)&#39;),
 (&#39;mgh70&#39;,
  &#39;The (newer) 70-channel BrainVision cap used at MGH (70+3 locations)&#39;),
 (&#39;artinis-octamon&#39;, &#39;Artinis OctaMon fNIRS (8 sources, 2 detectors)&#39;),
 (&#39;artinis-brite23&#39;, &#39;Artinis Brite23 fNIRS (11 sources, 7 detectors)&#39;),
 (&#39;brainproducts-RNP-BA-128&#39;,
  &#39;Brain Products with 10-10 electrode names (128 channels)&#39;)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Length in seconds</span>
<span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">/</span> <span class="n">sample</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="ne">C</span>:\Users\ALEXAN~1\AppData\Local\Temp/ipykernel_1988/3760960029.py in &lt;module&gt;
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Length in seconds</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">/</span> <span class="n">sample</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;sample&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of channels</span>
<span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">ch_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>64
</pre></div>
</div>
</div>
</div>
</section>
<section id="channel-selection-and-adding-a-montage">
<h3>Channel selection and adding a montage<a class="headerlink" href="#channel-selection-and-adding-a-montage" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">ch_names</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Fc5.&#39;, &#39;Fc3.&#39;, &#39;Fc1.&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fix trailing dots in channel names</span>
<span class="c1"># use sample.rename_channels(map)</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="nb">map</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">sample</span><span class="o">.</span><span class="n">ch_names</span><span class="p">:</span>
    <span class="nb">map</span><span class="p">[</span><span class="n">ch</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">sample</span><span class="o">.</span><span class="n">rename_channels</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><details open>
    <summary><strong>General</strong></summary>
    <table class="table table-hover table-striped table-sm table-responsive small">
        <tr>
            <th>Measurement date</th>
            
            <td>August 12, 2009  16:15:00 GMT</td>
            
        </tr>
        <tr>
            <th>Experimenter</th>
            
            <td>Unknown</td>
            
        </tr>
        <tr>
            <th>Participant</th>
            
            
            <td>X</td>
            
            
        </tr>
    </table>
    </details>
    <details open>
        <summary><strong>Channels</strong></summary>
        <table class="table table-hover table-striped table-sm table-responsive small">
            <tr>
                <th>Digitized points</th>
                
                <td>Not available</td>
                
            </tr>
            <tr>
                <th>Good channels</th>
                <td>64 EEG</td>
            </tr>
            <tr>
                <th>Bad channels</th>
                <td>None</td>
            </tr>
            <tr>
                <th>EOG channels</th>
                <td>Not available</td>
            </tr>
            <tr>
                <th>ECG channels</th>
                <td>Not available</td>
            </tr>
        </table>
        </details>
        <details open>
            <summary><strong>Data</strong></summary>
            <table class="table table-hover table-striped table-sm table-responsive small">
                
                <tr>
                    <th>Sampling frequency</th>
                    <td>160.00 Hz</td>
                </tr>
                
                
                <tr>
                    <th>Highpass</th>
                    <td>0.00 Hz</td>
                </tr>
                
                
                <tr>
                    <th>Lowpass</th>
                    <td>80.00 Hz</td>
                </tr>
                
                
                
                <tr>
                    <th>Filenames</th>
                    <td>S010R03.edf</td>
                </tr>
                
                
                <tr>
                    <th>Duration</th>
                    <td>00:02:03 (HH:MM:SS)</td>
                </tr>
                
            </table>
            </details></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">ch_names</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Fc5&#39;, &#39;Fc3&#39;, &#39;Fc1&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # 19 channels from International 10-20 system. no A1 and A2 here</span>
<span class="c1"># # Be careful. Pure 10-20 labeling differs from high-resolution montages</span>
<span class="c1"># # In MNE, 10-20 montage is actually an extended high-resulution version of 10-20</span>
<span class="c1"># # FYI, mapping from pure 10-20 to high-resolution versions</span>
<span class="c1"># # T3 = T7</span>
<span class="c1"># # T4 = T8</span>
<span class="c1"># # T5 = P7</span>
<span class="c1"># # T6 = P8</span>

<span class="c1"># channels_to_use = [</span>
<span class="c1">#     # prefrontal</span>
<span class="c1">#     &#39;Fp1&#39;,</span>
<span class="c1">#     &#39;Fp2&#39;,</span>
<span class="c1">#     # frontal</span>
<span class="c1">#     &#39;F7&#39;,</span>
<span class="c1">#     &#39;F3&#39;,</span>
<span class="c1">#     &#39;F4&#39;,</span>
<span class="c1">#     &#39;Fz&#39;,</span>
<span class="c1">#     &#39;F8&#39;,</span>
<span class="c1">#     # central and temporal</span>
<span class="c1">#     &#39;T7&#39;,</span>
<span class="c1">#     &#39;C3&#39;,</span>
<span class="c1">#     &#39;Cz&#39;,</span>
<span class="c1">#     &#39;C4&#39;,</span>
<span class="c1">#     &#39;T8&#39;,</span>
<span class="c1">#     # parietal</span>
<span class="c1">#     &#39;P7&#39;,</span>
<span class="c1">#     &#39;P3&#39;,</span>
<span class="c1">#     &#39;Pz&#39;,</span>
<span class="c1">#     &#39;P4&#39;,</span>
<span class="c1">#     &#39;P8&#39;,</span>
<span class="c1">#     # occipital</span>
<span class="c1">#     &#39;O1&#39;,</span>
<span class="c1">#     &#39;O2&#39;,</span>
<span class="c1"># ]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mne.channels.get_builtin_montages()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sample_1020 = sample.copy().pick(channels_to_use)</span>

<span class="c1"># # check that everything is OK</span>
<span class="c1"># assert len(channels_to_use) == len(sample_1020.ch_names)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ten_twenty_montage</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">make_standard_montage</span><span class="p">(</span><span class="s1">&#39;brainproducts-RNP-BA-128&#39;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">ten_twenty_montage</span><span class="o">.</span><span class="n">ch_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>130
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ten_twenty_montage.ch_names</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">sample</span><span class="o">.</span><span class="n">ch_names</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;Fp&#39;</span> <span class="ow">in</span> <span class="n">ch</span><span class="p">:</span>
        <span class="nb">map</span><span class="p">[</span><span class="n">ch</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span>
    <span class="k">elif</span> <span class="s1">&#39;z&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ch</span><span class="p">:</span>
        <span class="nb">map</span><span class="p">[</span><span class="n">ch</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">map</span><span class="p">[</span><span class="n">ch</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;z&#39;</span>
<span class="n">sample</span><span class="o">.</span><span class="n">rename_channels</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><details open>
    <summary><strong>General</strong></summary>
    <table class="table table-hover table-striped table-sm table-responsive small">
        <tr>
            <th>Measurement date</th>
            
            <td>August 12, 2009  16:15:00 GMT</td>
            
        </tr>
        <tr>
            <th>Experimenter</th>
            
            <td>Unknown</td>
            
        </tr>
        <tr>
            <th>Participant</th>
            
            
            <td>X</td>
            
            
        </tr>
    </table>
    </details>
    <details open>
        <summary><strong>Channels</strong></summary>
        <table class="table table-hover table-striped table-sm table-responsive small">
            <tr>
                <th>Digitized points</th>
                
                <td>Not available</td>
                
            </tr>
            <tr>
                <th>Good channels</th>
                <td>64 EEG</td>
            </tr>
            <tr>
                <th>Bad channels</th>
                <td>None</td>
            </tr>
            <tr>
                <th>EOG channels</th>
                <td>Not available</td>
            </tr>
            <tr>
                <th>ECG channels</th>
                <td>Not available</td>
            </tr>
        </table>
        </details>
        <details open>
            <summary><strong>Data</strong></summary>
            <table class="table table-hover table-striped table-sm table-responsive small">
                
                <tr>
                    <th>Sampling frequency</th>
                    <td>160.00 Hz</td>
                </tr>
                
                
                <tr>
                    <th>Highpass</th>
                    <td>0.00 Hz</td>
                </tr>
                
                
                <tr>
                    <th>Lowpass</th>
                    <td>80.00 Hz</td>
                </tr>
                
                
                
                <tr>
                    <th>Filenames</th>
                    <td>S010R03.edf</td>
                </tr>
                
                
                <tr>
                    <th>Duration</th>
                    <td>00:02:03 (HH:MM:SS)</td>
                </tr>
                
            </table>
            </details></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">channels_to_use</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FC5&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FC3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FC1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FCz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FC2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FC4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FC6&#39;</span><span class="p">,</span>
 <span class="s1">&#39;C5&#39;</span><span class="p">,</span>
 <span class="s1">&#39;C3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;C1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;C2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;C4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;C6&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CP5&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CP3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CP1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CPz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CP2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CP4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CP6&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fp1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fpz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fp2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AF7&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AF3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AFz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AF4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AF8&#39;</span><span class="p">,</span>
 <span class="s1">&#39;F7&#39;</span><span class="p">,</span>
 <span class="s1">&#39;F5&#39;</span><span class="p">,</span>
 <span class="s1">&#39;F3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;F1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;F2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;F4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;F6&#39;</span><span class="p">,</span>
 <span class="s1">&#39;F8&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FT7&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FT8&#39;</span><span class="p">,</span>
 <span class="s1">&#39;T7&#39;</span><span class="p">,</span>
 <span class="s1">&#39;T8&#39;</span><span class="p">,</span>
 <span class="s1">&#39;TP7&#39;</span><span class="p">,</span>
 <span class="s1">&#39;TP8&#39;</span><span class="p">,</span>
 <span class="s1">&#39;P7&#39;</span><span class="p">,</span>
 <span class="s1">&#39;P5&#39;</span><span class="p">,</span>
 <span class="s1">&#39;P3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;P1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;P2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;P4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;P6&#39;</span><span class="p">,</span>
 <span class="s1">&#39;P8&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PO7&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PO3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;POz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PO4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PO8&#39;</span><span class="p">,</span>
 <span class="s1">&#39;O1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Oz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;O2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Iz&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1010</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">pick</span><span class="p">(</span><span class="n">channels_to_use</span><span class="p">)</span>

<span class="c1"># check that everything is OK</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels_to_use</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_1010</span><span class="o">.</span><span class="n">ch_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1010</span><span class="o">.</span><span class="n">set_montage</span><span class="p">(</span><span class="n">ten_twenty_montage</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><details open>
    <summary><strong>General</strong></summary>
    <table class="table table-hover table-striped table-sm table-responsive small">
        <tr>
            <th>Measurement date</th>
            
            <td>August 12, 2009  16:15:00 GMT</td>
            
        </tr>
        <tr>
            <th>Experimenter</th>
            
            <td>Unknown</td>
            
        </tr>
        <tr>
            <th>Participant</th>
            
            
            <td>X</td>
            
            
        </tr>
    </table>
    </details>
    <details open>
        <summary><strong>Channels</strong></summary>
        <table class="table table-hover table-striped table-sm table-responsive small">
            <tr>
                <th>Digitized points</th>
                
                <td>65 points</td>
                
            </tr>
            <tr>
                <th>Good channels</th>
                <td>62 EEG</td>
            </tr>
            <tr>
                <th>Bad channels</th>
                <td>None</td>
            </tr>
            <tr>
                <th>EOG channels</th>
                <td>Not available</td>
            </tr>
            <tr>
                <th>ECG channels</th>
                <td>Not available</td>
            </tr>
        </table>
        </details>
        <details open>
            <summary><strong>Data</strong></summary>
            <table class="table table-hover table-striped table-sm table-responsive small">
                
                <tr>
                    <th>Sampling frequency</th>
                    <td>160.00 Hz</td>
                </tr>
                
                
                <tr>
                    <th>Highpass</th>
                    <td>0.00 Hz</td>
                </tr>
                
                
                <tr>
                    <th>Lowpass</th>
                    <td>80.00 Hz</td>
                </tr>
                
                
                
                <tr>
                    <th>Filenames</th>
                    <td>S010R03.edf</td>
                </tr>
                
                
                <tr>
                    <th>Duration</th>
                    <td>00:02:03 (HH:MM:SS)</td>
                </tr>
                
            </table>
            </details></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1010</span><span class="o">.</span><span class="n">plot_sensors</span><span class="p">(</span><span class="n">show_names</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a436db482b7d5ac9e5efffa0c06ec2876456d1e19d1312c8e52a981db366f041.png" src="../_images/a436db482b7d5ac9e5efffa0c06ec2876456d1e19d1312c8e52a981db366f041.png" />
</div>
</div>
</section>
<section id="explore-the-signals">
<h3>Explore the signals<a class="headerlink" href="#explore-the-signals" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1010</span><span class="o">.</span><span class="n">compute_psd</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Effective window size : 12.800 (s)
Plotting power spectral density (dB=True).
</pre></div>
</div>
<img alt="../_images/69ce4dae6198ba8c34aec19f8c17e29e97ccbe75bf85bdb7bc22f744ec40a4ee.png" src="../_images/69ce4dae6198ba8c34aec19f8c17e29e97ccbe75bf85bdb7bc22f744ec40a4ee.png" />
</div>
</div>
<p>Do you see peaks connected to power line noise?</p>
<p>The <a class="reference external" href="https://mne.tools/stable/generated/mne.filter.notch_filter.html#mne-filter-notch-filter">notch filter’s</a> purpose is to filter out activity at a specific frequency (rather than a frequency range). Because the alternating current in standard electric outlets in North America oscillates at 60 Hz, electric fields produced by the 60-Hz activity in the environment that surrounds us in our indoor environments frequently contaminates the EEG. Sixty-hertz notch filters (filters designed specifically to filter out 60-Hz activity) are used to attenuate or eliminate this unwanted signal. In countries where line frequencies are 50 Hz, 50-Hz notch filters are used for the same purpose.</p>
<section id="band-pass-filtering">
<h4>Band-pass filtering<a class="headerlink" href="#band-pass-filtering" title="Permalink to this headline">#</a></h4>
<p>It’s better to remove low-freq components &lt; 1 Hz and high-freq &gt; 50Hz (non-informative for EEG)</p>
<p>Let’s use IIR filter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1010</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">l_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">h_freq</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;iir&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 50 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 1.00, 50.00 Hz: -6.02, -6.02 dB
</pre></div>
</div>
<div class="output text_html"><details open>
    <summary><strong>General</strong></summary>
    <table class="table table-hover table-striped table-sm table-responsive small">
        <tr>
            <th>Measurement date</th>
            
            <td>August 12, 2009  16:15:00 GMT</td>
            
        </tr>
        <tr>
            <th>Experimenter</th>
            
            <td>Unknown</td>
            
        </tr>
        <tr>
            <th>Participant</th>
            
            
            <td>X</td>
            
            
        </tr>
    </table>
    </details>
    <details open>
        <summary><strong>Channels</strong></summary>
        <table class="table table-hover table-striped table-sm table-responsive small">
            <tr>
                <th>Digitized points</th>
                
                <td>65 points</td>
                
            </tr>
            <tr>
                <th>Good channels</th>
                <td>62 EEG</td>
            </tr>
            <tr>
                <th>Bad channels</th>
                <td>None</td>
            </tr>
            <tr>
                <th>EOG channels</th>
                <td>Not available</td>
            </tr>
            <tr>
                <th>ECG channels</th>
                <td>Not available</td>
            </tr>
        </table>
        </details>
        <details open>
            <summary><strong>Data</strong></summary>
            <table class="table table-hover table-striped table-sm table-responsive small">
                
                <tr>
                    <th>Sampling frequency</th>
                    <td>160.00 Hz</td>
                </tr>
                
                
                <tr>
                    <th>Highpass</th>
                    <td>1.00 Hz</td>
                </tr>
                
                
                <tr>
                    <th>Lowpass</th>
                    <td>50.00 Hz</td>
                </tr>
                
                
                
                <tr>
                    <th>Filenames</th>
                    <td>S010R03.edf</td>
                </tr>
                
                
                <tr>
                    <th>Duration</th>
                    <td>00:02:03 (HH:MM:SS)</td>
                </tr>
                
            </table>
            </details></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot psd after filtering</span>

<span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-eeg-signals">
<h4>Plot EEG signals<a class="headerlink" href="#plot-eeg-signals" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1010</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cec1f6fa7a871891b2dd0e46c4ecf3f150e575cb0bb5864683b97c8461b31b19.png" src="../_images/cec1f6fa7a871891b2dd0e46c4ecf3f150e575cb0bb5864683b97c8461b31b19.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot in better scale. Use &#39;scalings&#39; argument</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="n">sample_1010</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scalings</span><span class="o">=</span><span class="mf">3e-4</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3f186c149b57a087fbbe068af65ffe883288fa9bfac2492c74cd23f6d1dc8a55.png" src="../_images/3f186c149b57a087fbbe068af65ffe883288fa9bfac2492c74cd23f6d1dc8a55.png" />
</div>
</div>
</section>
</section>
<section id="extracting-events">
<h3>Extracting events<a class="headerlink" href="#extracting-events" title="Permalink to this headline">#</a></h3>
<p>Mne has several functions for event selection.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mne.find_events</span></code> is used when events are stored in trigger channels (e.g. FIFF format)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mne.events_from_annotations</span></code> is used for when events are stored in annotations (EDF+ format)</p></li>
</ul>
<p>Look for documentation for your EEG-record format</p>
<p>Here we have EDF+ format</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events</span><span class="p">,</span> <span class="n">events_dict</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">events_from_annotations</span><span class="p">(</span><span class="n">sample_1010</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Used Annotations descriptions: [&#39;T0&#39;, &#39;T1&#39;, &#39;T2&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;T0&#39;: 1, &#39;T1&#39;: 2, &#39;T2&#39;: 3}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[   0,    0,    1],
       [ 656,    0,    3],
       [1312,    0,    1],
       [1968,    0,    2],
       [2624,    0,    1]])
</pre></div>
</div>
</div>
</div>
<p><strong>Epochs</strong> objects are a data structure for representing and analyzing equal-duration chunks of the EEG/MEG signal. Epochs are most often used to represent data that is time-locked to repeated experimental events. The Raw object and the events array are the bare minimum needed to create an Epochs object, which we create with the <code class="docutils literal notranslate"><span class="pre">mne.Epochs</span></code> class constructor.</p>
<p>However, you will almost surely want to change some of the other default parameters. Here we’ll change <code class="docutils literal notranslate"><span class="pre">tmin</span></code> and <code class="docutils literal notranslate"><span class="pre">tmax</span></code> (the time relative to each event at which to start and end each epoch).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">sample_1010</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span>  <span class="n">tmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not setting metadata
30 matching events found
Setting baseline interval to [-0.5, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Using data from preloaded Raw for 30 events and 209 original time points ...
1 bad epochs dropped
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">events</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;__&#39;</span><span class="p">,</span> <span class="s1">&#39;event_id&#39;</span><span class="p">])[</span><span class="s1">&#39;event_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>event_id
1    14
2     8
3     7
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Check that length is right</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">epochs</span><span class="p">:</span>
    <span class="k">break</span>
<span class="n">epoch</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(62, 209)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epoch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">sample_1010</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.30625
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1010</span><span class="o">.</span><span class="n">to_data_frame</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(19680, 63)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">epochs</span><span class="o">.</span><span class="n">to_data_frame</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>condition</th>
      <th>epoch</th>
      <th>FC5</th>
      <th>FC3</th>
      <th>FC1</th>
      <th>FCz</th>
      <th>FC2</th>
      <th>FC4</th>
      <th>FC6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.50000</td>
      <td>3</td>
      <td>1</td>
      <td>-6.147051</td>
      <td>-29.453544</td>
      <td>-52.122295</td>
      <td>12.717840</td>
      <td>-24.930906</td>
      <td>-27.622466</td>
      <td>1.054839</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.49375</td>
      <td>3</td>
      <td>1</td>
      <td>-21.278346</td>
      <td>-39.551894</td>
      <td>-72.608158</td>
      <td>-4.906761</td>
      <td>-29.578207</td>
      <td>-29.809705</td>
      <td>6.806334</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.48750</td>
      <td>3</td>
      <td>1</td>
      <td>-18.695884</td>
      <td>-39.901813</td>
      <td>-89.440871</td>
      <td>-15.903870</td>
      <td>-41.332091</td>
      <td>-43.059623</td>
      <td>-6.924708</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">sample_1010</span><span class="o">.</span><span class="n">ch_names</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;epoch&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;epoch&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">arr</span><span class="p">:</span> <span class="n">arr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">arr</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e833d46344b76bcef7ef6691347c26cca415482cc2d58703cc0355af1a8b6910.png" src="../_images/e833d46344b76bcef7ef6691347c26cca415482cc2d58703cc0355af1a8b6910.png" />
</div>
</div>
<p>Note also that the Epochs constructor accepts parameters <code class="docutils literal notranslate"><span class="pre">reject</span></code> for rejecting individual epochs based on signal amplitude.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">sample_1010</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span>  <span class="n">tmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;eeg&#39;</span><span class="p">:</span> <span class="mf">600e-6</span><span class="p">},</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not setting metadata
30 matching events found
Applying baseline correction (mode: mean)
0 projection items activated
Using data from preloaded Raw for 30 events and 209 original time points ...
    Rejecting  epoch based on EEG : [&#39;Fp1&#39;, &#39;Fpz&#39;, &#39;Fp2&#39;, &#39;AF7&#39;, &#39;AF3&#39;, &#39;AF8&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp1&#39;, &#39;Fpz&#39;, &#39;Fp2&#39;, &#39;AF7&#39;]
3 bad epochs dropped
</pre></div>
</div>
</div>
</div>
<p>PSD on epochs differs from the raw. More averaging is used</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NOTE: plot_psd() is a legacy function. New code should use .compute_psd().plot().
    Using multitaper spectrum estimation with 7 DPSS windows
Plotting power spectral density (dB=True).
Averaging across epochs...
</pre></div>
</div>
<img alt="../_images/de4c229d27dbc031871de2a1eca7fea5ff1c43abfb7811bcd851b5b6d3d5e9ab.png" src="../_images/de4c229d27dbc031871de2a1eca7fea5ff1c43abfb7811bcd851b5b6d3d5e9ab.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">scalings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;eeg&#39;</span><span class="p">:</span><span class="mf">3e-4</span><span class="p">});</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9a460ff8571e682cda0de6b137190b92b4d28d4b15cb03002dd3ba5b04b653da.png" src="../_images/9a460ff8571e682cda0de6b137190b92b4d28d4b15cb03002dd3ba5b04b653da.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">event_id</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;1&#39;: 1, &#39;2&#39;: 2, &#39;3&#39;: 3}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check number of events of each type</span>
<span class="c1"># use epochs.events</span>

<span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T0</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">evoked_T1</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">evoked_T2</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/77b71f87614f91830330853c1a588b244edce70fe756ef922e62dd16a032b717.png" src="../_images/77b71f87614f91830330853c1a588b244edce70fe756ef922e62dd16a032b717.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b4b58cda4ea30fb58005da934e12b6a99bbf1c5af6fcc660962d2bfea82188b1.png" src="../_images/b4b58cda4ea30fb58005da934e12b6a99bbf1c5af6fcc660962d2bfea82188b1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/78b7bdfe4c13424618141c2f8e350facf0884030be966ed7e4e7e131c6fc9a6f.png" src="../_images/78b7bdfe4c13424618141c2f8e350facf0884030be966ed7e4e7e131c6fc9a6f.png" />
</div>
</div>
</section>
</section>
<section id="part-2">
<h2>Part 2<a class="headerlink" href="#part-2" title="Permalink to this headline">#</a></h2>
<section id="independent-component-analysis-for-artifact-removal">
<h3>Independent Component Analysis for Artifact Removal<a class="headerlink" href="#independent-component-analysis-for-artifact-removal" title="Permalink to this headline">#</a></h3>
<p>Independent component analysis (ICA) is used to estimate sources given noisy measurements. Imagine 3 instruments playing simultaneously and 3 microphones recording the mixed signals. ICA is used to recover the sources ie. what is played by each instrument.</p>
<p><img alt="" src="https://scikit-learn.org/stable/_images/sphx_glr_plot_ica_blind_source_separation_001.png" /></p>
<p>ICA can be used for artifact repair in EEG data. We denote an “artifact” as any component of the EEG signal that is not directly produced by human brain activity.</p>
<section id="types-of-eeg-artifacts">
<h4>Types of EEG artifacts<a class="headerlink" href="#types-of-eeg-artifacts" title="Permalink to this headline">#</a></h4>
<p>The ability to recognize artifacts is the first step in removing them. EEG artifacts can be classified depending on their origin, which can be physiological or external to the human body (non-physiological). The most usual are:</p>
<p>Physiological artifacts:</p>
<ul class="simple">
<li><p>Ocular activity</p></li>
<li><p>Muscle activity</p></li>
<li><p>Cardiac activity</p></li>
<li><p>Perspiration</p></li>
<li><p>Respiration</p></li>
</ul>
<p>Non-physiological / Technical artifacts:</p>
<ul class="simple">
<li><p>Electrode pop</p></li>
<li><p>Cable movement</p></li>
<li><p>Incorrect reference placement</p></li>
<li><p>AC electrical and electromagnetic interferences</p></li>
<li><p>Body movements</p></li>
</ul>
<p>More information can be found via links:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.learningeeg.com/artifacts">Types of artefacts</a></p></li>
<li><p><a class="reference external" href="https://www.bitbrain.com/blog/eeg-artifacts">How to detect them using ICA</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">ICA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">sample_1010</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting ICA to data using 62 channels (please be patient, this may take a while)
Selecting by number: 20 components
Fitting ICA took 14.7s.
</pre></div>
</div>
<div class="output text_html"><table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Method</th>
        <td>fastica</td>
    </tr>
    <tr>
        <th>Fit parameters</th>
        <td>algorithm=parallel<br />fun=logcosh<br />fun_args=None<br />max_iter=1000<br /></td>
    </tr>
    <tr>
        <th>Fit</th>
        <td>1000 iterations on raw data (19680 samples)</td>
    </tr>
    
    <tr>
        <th>ICA components</th>
        <td>20</td>
    </tr>
    <tr>
        <th>Available PCA components</th>
        <td>62</td>
    </tr>
    <tr>
        <th>Channel types</th>
        <td>eeg</td>
    </tr>
    <tr>
        <th>ICA components marked for exclusion</th>
        <td>&mdash;</td>
    </tr>
    
</table></div></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">get_explained_variance_ratio()</span></code>, we can retrieve the fraction of variance in the original data that is explained by our ICA components in the form of a dictionary:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">explained_var_ratio</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">get_explained_variance_ratio</span><span class="p">(</span><span class="n">sample_1010</span><span class="p">)</span>
<span class="k">for</span> <span class="n">channel_type</span><span class="p">,</span> <span class="n">ratio</span> <span class="ow">in</span> <span class="n">explained_var_ratio</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fraction of </span><span class="si">{</span><span class="n">channel_type</span><span class="si">}</span><span class="s2"> variance explained by all components: </span><span class="si">{</span><span class="n">ratio</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fraction of eeg variance explained by all components: 0.8688336313085088
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_sources</span><span class="p">(</span><span class="n">sample_1010</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Creating RawArray with float64 data, n_channels=20, n_times=19680
    Range : 0 ... 19679 =      0.000 ...   122.994 secs
Ready.
</pre></div>
</div>
<img alt="../_images/b299411855b9150c3ff359b8849998456e9bffdf007aa2367d2d8d5f7819891f.png" src="../_images/b299411855b9150c3ff359b8849998456e9bffdf007aa2367d2d8d5f7819891f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_components</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/76fe180fb8394f46ad740753566ff16a074252711a3586e0ebd04c767ec75668.png" src="../_images/76fe180fb8394f46ad740753566ff16a074252711a3586e0ebd04c767ec75668.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_properties</span><span class="p">(</span><span class="n">sample_1010</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Using multitaper spectrum estimation with 7 DPSS windows
Not setting metadata
61 matching events found
No baseline correction applied
0 projection items activated
</pre></div>
</div>
<img alt="../_images/1d134178c6dd8ec61cdbe23d1319f5735ff78323c80b11a6b7f0579e52eb90b4.png" src="../_images/1d134178c6dd8ec61cdbe23d1319f5735ff78323c80b11a6b7f0579e52eb90b4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># blinks</span>
<span class="n">ica</span><span class="o">.</span><span class="n">plot_overlay</span><span class="p">(</span><span class="n">sample_1010</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 62 PCA components
</pre></div>
</div>
<img alt="../_images/6c7c29caaab9afb84f44818be53c2fa9072d77df8acb0e03806a11c628b72366.png" src="../_images/6c7c29caaab9afb84f44818be53c2fa9072d77df8acb0e03806a11c628b72366.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1010_clr</span> <span class="o">=</span> <span class="n">sample_1010</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sample_1010_clr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 62 PCA components
</pre></div>
</div>
<div class="output text_html"><details open>
    <summary><strong>General</strong></summary>
    <table class="table table-hover table-striped table-sm table-responsive small">
        <tr>
            <th>Measurement date</th>
            
            <td>August 12, 2009  16:15:00 GMT</td>
            
        </tr>
        <tr>
            <th>Experimenter</th>
            
            <td>Unknown</td>
            
        </tr>
        <tr>
            <th>Participant</th>
            
            
            <td>X</td>
            
            
        </tr>
    </table>
    </details>
    <details open>
        <summary><strong>Channels</strong></summary>
        <table class="table table-hover table-striped table-sm table-responsive small">
            <tr>
                <th>Digitized points</th>
                
                <td>65 points</td>
                
            </tr>
            <tr>
                <th>Good channels</th>
                <td>62 EEG</td>
            </tr>
            <tr>
                <th>Bad channels</th>
                <td>None</td>
            </tr>
            <tr>
                <th>EOG channels</th>
                <td>Not available</td>
            </tr>
            <tr>
                <th>ECG channels</th>
                <td>Not available</td>
            </tr>
        </table>
        </details>
        <details open>
            <summary><strong>Data</strong></summary>
            <table class="table table-hover table-striped table-sm table-responsive small">
                
                <tr>
                    <th>Sampling frequency</th>
                    <td>160.00 Hz</td>
                </tr>
                
                
                <tr>
                    <th>Highpass</th>
                    <td>1.00 Hz</td>
                </tr>
                
                
                <tr>
                    <th>Lowpass</th>
                    <td>50.00 Hz</td>
                </tr>
                
                
                
                <tr>
                    <th>Filenames</th>
                    <td>S010R03.edf</td>
                </tr>
                
                
                <tr>
                    <th>Duration</th>
                    <td>00:02:03 (HH:MM:SS)</td>
                </tr>
                
            </table>
            </details></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot channels</span>

<span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">sample_1010_clr</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span>  <span class="n">tmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;eeg&#39;</span><span class="p">:</span> <span class="mf">600e-6</span><span class="p">},</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not setting metadata
30 matching events found
Applying baseline correction (mode: mean)
0 projection items activated
Using data from preloaded Raw for 30 events and 209 original time points ...
1 bad epochs dropped
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T0</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">evoked_T1</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">evoked_T2</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f166e3129df6d9dba844e94147ca9ad162a063e5024bdd817e954aeb4a06be18.png" src="../_images/f166e3129df6d9dba844e94147ca9ad162a063e5024bdd817e954aeb4a06be18.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/618bb6d2d41c19a2ddc5aa14b8ce999c204fe138eab23e831b8678de5e230b12.png" src="../_images/618bb6d2d41c19a2ddc5aa14b8ce999c204fe138eab23e831b8678de5e230b12.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/01d305d1ba0f913604e50f32f9ebf7ac8f4875d5f979a273e63492a167f9845e.png" src="../_images/01d305d1ba0f913604e50f32f9ebf7ac8f4875d5f979a273e63492a167f9845e.png" />
</div>
</div>
<p>Let’s plot Global Field Power (GFP).</p>
<p>GFP is, generally speaking, a measure of agreement of the signals picked up by all sensors across the entire scalp: if all sensors have the same value at a given time point, the GFP will be zero at that time point. If the signals differ, the GFP will be non-zero at that time point. GFP peaks may reflect “interesting” brain activity, warranting further investigation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_compare_evokeds</span><span class="p">(</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">rest</span><span class="o">=</span><span class="n">evoked_T0</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">evoked_T1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">evoked_T2</span><span class="p">),</span>
    <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
    <span class="n">show_sensors</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>combining channels using GFP (eeg channels)
combining channels using GFP (eeg channels)
combining channels using GFP (eeg channels)
</pre></div>
</div>
<img alt="../_images/c00dcf5596bd956e52deab09b846ac1fd6bd8ebeee1fec1887876f5ed2b6799d.png" src="../_images/c00dcf5596bd956e52deab09b846ac1fd6bd8ebeee1fec1887876f5ed2b6799d.png" />
</div>
</div>
<p>We can also get a more detailed view of each Evoked object using other plotting methods such as <code class="docutils literal notranslate"><span class="pre">plot_joint</span></code> or <code class="docutils literal notranslate"><span class="pre">plot_topomap</span></code>. For both plots we can set time points. However, if we choose <code class="docutils literal notranslate"><span class="pre">times</span> <span class="pre">=</span> <span class="pre">'peaks'</span></code>, time points will be chosen automatically by checking for 3 local maxima in Global Field Power (GFP).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T0</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">()</span>
<span class="n">evoked_T0</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No projector specified for this dataset. Please consider the method self.add_proj.
</pre></div>
</div>
<img alt="../_images/d1a5dca7eb11c2290670103edb17e0f4292d64d24ac3db1a91c590bc69c81bd1.png" src="../_images/d1a5dca7eb11c2290670103edb17e0f4292d64d24ac3db1a91c590bc69c81bd1.png" />
<img alt="../_images/f9854841a943b882d70a7af51876584b1a06eb0d555313a504fd1a6a60862fd4.png" src="../_images/f9854841a943b882d70a7af51876584b1a06eb0d555313a504fd1a6a60862fd4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T1</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">()</span>
<span class="n">evoked_T1</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No projector specified for this dataset. Please consider the method self.add_proj.
</pre></div>
</div>
<img alt="../_images/7b1735a7a4ca7bd56d62668cce3301813031fdb4193125e257e9dcae5e96fbc3.png" src="../_images/7b1735a7a4ca7bd56d62668cce3301813031fdb4193125e257e9dcae5e96fbc3.png" />
<img alt="../_images/c0f8f8beaec3263a065c876ea3c27fce1e7df7eb18412e302dd41430b854596f.png" src="../_images/c0f8f8beaec3263a065c876ea3c27fce1e7df7eb18412e302dd41430b854596f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T2</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">()</span>
<span class="n">evoked_T2</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No projector specified for this dataset. Please consider the method self.add_proj.
</pre></div>
</div>
<img alt="../_images/f9c257074a73e6d5357e035a5749f220cae0473796c2b1af1534f7a358eecee8.png" src="../_images/f9c257074a73e6d5357e035a5749f220cae0473796c2b1af1534f7a358eecee8.png" />
<img alt="../_images/bdccc4d358df5f45f906f254e91aeaea490739eca18661f94cda73e95106d958.png" src="../_images/bdccc4d358df5f45f906f254e91aeaea490739eca18661f94cda73e95106d958.png" />
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./seminar1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-and-visualize-the-data-2-pt">1. Read and visualize the data (2 pt)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-the-data-s010r03-edf-and-get-info-0-5-pt">1.1 Read the data <code class="docutils literal notranslate"><span class="pre">S010R03.edf</span></code> and get info (0.5 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-sampling-frequency-0-25-pt">1.2 Calculate the sampling frequency (0.25 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-best-montage-for-the-data-1-pt">Set the best montage for the data (1 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#channel-selection-and-adding-a-montage">Channel selection and adding a montage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-the-signals">Explore the signals</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#band-pass-filtering">Band-pass filtering</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-eeg-signals">Plot EEG signals</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-events">Extracting events</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2">Part 2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-component-analysis-for-artifact-removal">Independent Component Analysis for Artifact Removal</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-eeg-artifacts">Types of EEG artifacts</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nadezhda Alsahanova
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>