
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Seminar 1. EEG analysis &#8212; Neuroimaging and Machine Learning for Biomedicine</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/myadmonitions.css?v=0009bf62" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'seminar1_working_with_eeg_ipynb_';</script>
    <link rel="icon" href="_static/logo.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Neuroimaging and Machine Learning for Biomedicine - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Neuroimaging and Machine Learning for Biomedicine - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the Neuroimaging and Machine Learning for Biomedicine coursebook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bio/intro_links.html">Links</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1AM67Sd37J0hIJ-kLyzAZRm8op_JcUQ9b?usp=sharing">Intro to shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="seminar0/Seminar1_python_colab.html">How to work with Python</a></li>




<li class="toctree-l1"><a class="reference internal" href="seminar0/Seminar1_ML.html">Intro to ML</a></li>

















<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1jkf4Jt0QvDz2O7UoZ-sZAi0V0oke5Yju?usp=sharing">Machine learning fundamentals on medical data</a></li>
<li class="toctree-l1"><a class="reference internal" href="seminar0/00_pytorch_fundamentals.html">Pytorch fundamentals</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1q0XncKq2y_wHLXJaxhjfBCDGHABmzrjM/view?usp=sharing">Intro to computer vision</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminar 0. Opening Seminar</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro/intro.html">Lecture Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro/opening_seminar.html">Motivation &amp; Overview</a></li>










</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminar 1. Working with EEG</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="seminar1/seminar1_working_with_eeg_ipynb_.html">Seminar 1. EEG analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminars 2-3. Working with MRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="seminar2/docker.html">Preparation to Seminar 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="seminar2/seminar2_1_mri.html">Seminar 2.1. MRI data analysis, databases and tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="seminar2/seminar2_2_transform.html">Transformations</a></li>





<li class="toctree-l1"><a class="reference internal" href="seminar2/seminar2_3_freesurfer.html">FREESURFER</a></li>


<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1HuS7ChgQvch4vrD8gfITGUZP9E8hZ8Hw/view?usp=sharing">Seminar 3.1. MRI classification with 3D CNN</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1m7mWY0LI2M6PdevJf5rLCdm-WrAOoXJ-/view?usp=sharing">Seminar 3.2. MRI segmentation with 3D U-net</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminar 4-6. Working with fMRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="seminar4/README.html">Preparation to Seminar 4-5</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1yrb9DbrZoGs0bD7li_UuU3jPvf7_KH1B?usp=sharing">Seminar 6. Analyze task-based fMRI for motor and emotion task</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminar 7. Interpretation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1sJtU1uWezC-hEpDSkyhl0toioOt3F8FF?usp=sharing">Seminar 7. Interpretation of 3D CNNs for Brain MRI Data Classification</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BIMAI-lab/NEUROML_course" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BIMAI-lab/NEUROML_course/issues/new?title=Issue%20on%20page%20%2Fseminar1_working_with_eeg_ipynb_.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/seminar1_working_with_eeg_ipynb_.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Seminar 1. EEG analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1">Part 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-loading-reading-physionet-eeg-motor-movement-imagery-for-demonstration-we-use-a-single-recording-s003r03-edf-event">Data: loading/reading PhysioNet EEG Motor Movement/Imagery. For demonstration, we use a single recording: S003R03.edf (+ .event).</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#channel-selection-and-adding-a-montage">Channel selection and adding a montage</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mne-channels-make-standard-montage-standard-1020">mne.channels.make_standard_montage(‘standard_1020’)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#raw-1020-set-montage-mont">raw_1020.set_montage(mont)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-and-cleaning-eeg-spectrum">Checking and Cleaning EEG Spectrum</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#main-signal-energy-is-concentrated-in-low-frequencies-10-hz">1. Main signal energy is concentrated in low frequencies (&lt;10 Hz)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#weak-50-60-hz-peak">2. Weak 50/60-Hz peak</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#band-pass-filtering">Band-pass filtering</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-eeg-signals">Plot EEG signals</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#event-detection-triggers-vs-annotations">Event Detection: Triggers vs Annotations</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-it-matters-for-your-data">Why it matters for your data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-epochs">Creating Epochs</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#peak-to-peak-amplitude-qc">Peak-to-peak amplitude (QC)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#psd-of-epochs">PSD of epochs</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#averaging-evoked-responses">Averaging (Evoked responses)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2">Part 2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-component-analysis-ica-for-artifact-removal">Independent Component Analysis (ICA) for Artifact Removal</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#common-types-of-eeg-artifacts">Common Types of EEG Artifacts</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#explained-variance-ratio">Explained variance ratio</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#global-field-power-gfp">Global Field Power (GFP)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-evoked-responses-in-more-detail">Visualizing Evoked responses in more detail</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-choose-the-time-points">How to choose the time points</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-connectivity-in-eeg">Functional Connectivity in EEG</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-connectivity">Spectral Connectivity</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="seminar-1-eeg-analysis">
<h1>Seminar 1. EEG analysis<a class="headerlink" href="#seminar-1-eeg-analysis" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/drive/1H81W_DpkHv-ZC9bEbOBW9zfcOe7SCDnR?usp=sharing"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p><strong>Plan</strong></p>
<p>Part 1.</p>
<p>Preparation and Basic Analysis</p>
<ol class="arabic simple">
<li><p>Load data (PhysioNet EEG Motor Movement/Imagery).</p></li>
<li><p>Channel selection &amp; montage.</p></li>
<li><p>Spectral check &amp; filtering.</p></li>
<li><p>Visualization of raw signals.</p></li>
<li><p>Event detection &amp; epoching.</p></li>
<li><p>Quality control.</p></li>
<li><p>Evoked responses (ERP) (averaging, comparison of rest/left/right).</p></li>
</ol>
<p>Part 2.</p>
<p>ICA and Artifact Removal</p>
<ol class="arabic simple">
<li><p>Run ICA (decompose into independent components).</p></li>
<li><p>Identify artifacts.</p></li>
<li><p>Exclude ICs and clean data (apply ICA, recompute ERP).</p></li>
</ol>
<p>Global Measures and ERP Visualization</p>
<ol class="arabic simple">
<li><p>Global Field Power (GFP) to detect peaks.</p></li>
<li><p>ERP visualization (plot_joint, plot_topomap).</p></li>
</ol>
<p>Functional Connectivity</p>
<ol class="arabic simple">
<li><p>Concept of coherence (spectral connectivity).</p></li>
<li><p>Compute coherence (rest vs left vs right).</p></li>
<li><p>Visualize networks (connectivity matrices, topomap graphs).</p></li>
<li><p>Beta band focus (12–20 Hz) on motor cortex (C3/Cz/C4).</p></li>
</ol>
<section id="part-1">
<h2>Part 1<a class="headerlink" href="#part-1" title="Link to this heading">#</a></h2>
<p>All preprocessing and some data analysis of EEG data can be done using the <a class="reference external" href="https://mne.tools/stable/auto_tutorials/index.html">Python library MNE</a>.</p>
<section id="data-loading-reading-physionet-eeg-motor-movement-imagery-for-demonstration-we-use-a-single-recording-s003r03-edf-event">
<h3>Data: loading/reading PhysioNet EEG Motor Movement/Imagery. For demonstration, we use a single recording: S003R03.edf (+ .event).<a class="headerlink" href="#data-loading-reading-physionet-eeg-motor-movement-imagery-for-demonstration-we-use-a-single-recording-s003r03-edf-event" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For Colab only</span>
<span class="c1"># ! pip install mne</span>
<span class="c1"># ! pip install mne-connectivity</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mne</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mne_connectivity</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># not in colab</span>
<span class="c1"># %matplotlib notebook</span>
<span class="c1"># in colab</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="http://mne.io">mne.io</a> includes the funtions for different EEG-record formats:
<a class="reference external" href="https://mne.tools/stable/documentation/implementation.html#supported-data-formats">https://mne.tools/stable/documentation/implementation.html#supported-data-formats</a></p>
<p>We will work with data for one patient from <a class="reference external" href="https://www.physionet.org/content/eegmmidb/1.0.0/">EEG Motor Movement/Imagery Dataset</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>wget<span class="w"> </span><span class="s2">&quot;https://www.physionet.org/files/eegmmidb/1.0.0/S003/S003R03.edf&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>zsh:1: command not found: wget
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>wget<span class="w"> </span><span class="s2">&quot;https://www.physionet.org/files/eegmmidb/1.0.0/S003/S003R03.edf.event&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>zsh:1: command not found: wget
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># !ls</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_edf</span><span class="p">(</span><span class="s1">&#39;S003R03.edf&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_edf</span><span class="p">(</span><span class="s1">&#39;S003R03.edf&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">File ~/Documents/projects/.venv/lib/python3.13/site-packages/mne/io/edf/edf.py:1700,</span> in <span class="ni">read_raw_edf</span><span class="nt">(input_fname, eog, misc, stim_channel, exclude, infer_types, include, preload, units, encoding, exclude_after_unique, verbose)</span>
<span class="g g-Whitespace">   </span><span class="mi">1698</span> <span class="k">if</span> <span class="n">ext</span> <span class="o">!=</span> <span class="s2">&quot;edf&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1699</span>     <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Only EDF files are supported, got </span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1700</span> <span class="k">return</span> <span class="n">RawEDF</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1701</span>     <span class="n">input_fname</span><span class="o">=</span><span class="n">input_fname</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1702</span>     <span class="n">eog</span><span class="o">=</span><span class="n">eog</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1703</span>     <span class="n">misc</span><span class="o">=</span><span class="n">misc</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1704</span>     <span class="n">stim_channel</span><span class="o">=</span><span class="n">stim_channel</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1705</span>     <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1706</span>     <span class="n">infer_types</span><span class="o">=</span><span class="n">infer_types</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1707</span>     <span class="n">preload</span><span class="o">=</span><span class="n">preload</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1708</span>     <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1709</span>     <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1710</span>     <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1711</span>     <span class="n">exclude_after_unique</span><span class="o">=</span><span class="n">exclude_after_unique</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1712</span>     <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1713</span> <span class="p">)</span>

<span class="nn">File &lt;decorator-gen-330&gt;:10,</span> in <span class="ni">__init__</span><span class="nt">(self, input_fname, eog, misc, stim_channel, exclude, infer_types, preload, include, units, encoding, exclude_after_unique, verbose)</span>

<span class="nn">File ~/Documents/projects/.venv/lib/python3.13/site-packages/mne/io/edf/edf.py:152,</span> in <span class="ni">RawEDF.__init__</span><span class="nt">(self, input_fname, eog, misc, stim_channel, exclude, infer_types, preload, include, units, encoding, exclude_after_unique, verbose)</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extracting EDF parameters from </span><span class="si">{</span><span class="n">input_fname</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span> <span class="n">input_fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">input_fname</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">152</span> <span class="n">info</span><span class="p">,</span> <span class="n">edf_info</span><span class="p">,</span> <span class="n">orig_units</span> <span class="o">=</span> <span class="n">_get_info</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span>     <span class="n">input_fname</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span>     <span class="n">stim_channel</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span>     <span class="n">eog</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">156</span>     <span class="n">misc</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">157</span>     <span class="n">exclude</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span>     <span class="n">infer_types</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">159</span>     <span class="n">preload</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">160</span>     <span class="n">include</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span>     <span class="n">exclude_after_unique</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">162</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">163</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating raw.info structure...&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">165</span> <span class="n">_validate_type</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="s2">&quot;units&quot;</span><span class="p">)</span>

<span class="nn">File ~/Documents/projects/.venv/lib/python3.13/site-packages/mne/io/edf/edf.py:541,</span> in <span class="ni">_get_info</span><span class="nt">(fname, stim_channel, eog, misc, exclude, infer_types, preload, include, exclude_after_unique)</span>
<span class="g g-Whitespace">    </span><span class="mi">538</span> <span class="n">eog</span> <span class="o">=</span> <span class="n">eog</span> <span class="k">if</span> <span class="n">eog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">539</span> <span class="n">misc</span> <span class="o">=</span> <span class="n">misc</span> <span class="k">if</span> <span class="n">misc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
<span class="ne">--&gt; </span><span class="mi">541</span> <span class="n">edf_info</span><span class="p">,</span> <span class="n">orig_units</span> <span class="o">=</span> <span class="n">_read_header</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">542</span>     <span class="n">fname</span><span class="p">,</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">infer_types</span><span class="p">,</span> <span class="n">include</span><span class="p">,</span> <span class="n">exclude_after_unique</span>
<span class="g g-Whitespace">    </span><span class="mi">543</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">545</span> <span class="c1"># XXX: `tal_ch_names` to pass to `_check_stim_channel` should be computed</span>
<span class="g g-Whitespace">    </span><span class="mi">546</span> <span class="c1">#      from `edf_info[&#39;ch_names&#39;]` and `edf_info[&#39;tal_idx&#39;]` but &#39;tal_idx&#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">547</span> <span class="c1">#      contains stim channels that are not TAL.</span>
<span class="g g-Whitespace">    </span><span class="mi">548</span> <span class="n">stim_channel_idxs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_check_stim_channel</span><span class="p">(</span><span class="n">stim_channel</span><span class="p">,</span> <span class="n">edf_info</span><span class="p">[</span><span class="s2">&quot;ch_names&quot;</span><span class="p">])</span>

<span class="nn">File ~/Documents/projects/.venv/lib/python3.13/site-packages/mne/io/edf/edf.py:515,</span> in <span class="ni">_read_header</span><span class="nt">(fname, exclude, infer_types, include, exclude_after_unique)</span>
<span class="g g-Whitespace">    </span><span class="mi">513</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ext</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> file detected&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">514</span> <span class="k">if</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;bdf&quot;</span><span class="p">,</span> <span class="s2">&quot;edf&quot;</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">515</span>     <span class="k">return</span> <span class="n">_read_edf_header</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">516</span>         <span class="n">fname</span><span class="p">,</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">infer_types</span><span class="p">,</span> <span class="n">include</span><span class="p">,</span> <span class="n">exclude_after_unique</span>
<span class="g g-Whitespace">    </span><span class="mi">517</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">518</span> <span class="k">elif</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;gdf&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">519</span>     <span class="k">return</span> <span class="n">_read_gdf_header</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">include</span><span class="p">),</span> <span class="kc">None</span>

<span class="nn">File ~/Documents/projects/.venv/lib/python3.13/site-packages/mne/io/edf/edf.py:809,</span> in <span class="ni">_read_edf_header</span><span class="nt">(fname, exclude, infer_types, include, exclude_after_unique)</span>
<span class="g g-Whitespace">    </span><span class="mi">806</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Read header information from EDF+ or BDF file.&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">807</span> <span class="n">edf_info</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="ne">--&gt; </span><span class="mi">809</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">810</span>     <span class="n">fid</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># version (unused here)</span>
<span class="g g-Whitespace">    </span><span class="mi">812</span>     <span class="c1"># patient ID</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/Users/rahmatullaev/Documents/projects/NEUROML_course/S003R03.edf&#39;
</pre></div>
</div>
</div>
</div>
<p>Get some info about a record</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">info</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    // must be `var` (not `const`) because this can get embedded multiple times on a page
var toggleVisibility = (className) => {

    const elements = document.querySelectorAll(`.${className}`);

    elements.forEach(element => {
        if (element.classList.contains("mne-repr-section-header")) {
            return  // Don't collapse the section header row
        }
        element.classList.toggle("mne-repr-collapsed");
    });

    // trigger caret to rotate
    var sel = `.mne-repr-section-header.${className} > th.mne-repr-section-toggle > button`;
    const button = document.querySelector(sel);
    button.classList.toggle("collapsed");

    // adjust tooltip
    sel = `tr.mne-repr-section-header.${className}`;
    const secHeadRow = document.querySelector(sel);
    secHeadRow.classList.toggle("collapsed");
    secHeadRow.title = secHeadRow.title === "Hide section" ? "Show section" : "Hide section";
}
</script>

<style type="text/css">
    /*
Styles in this section apply both to the sphinx-built website docs and to notebooks
rendered in an IDE or in Jupyter. In our web docs, styles here are complemented by
doc/_static/styles.css and other CSS files (e.g. from the sphinx theme, sphinx-gallery,
or bootstrap). In IDEs/Jupyter, those style files are unavailable, so only the rules in
this file apply (plus whatever default styling the IDE applies).
*/
.mne-repr-table {
    display: inline;  /* prevent using full container width */
}
.mne-repr-table tr.mne-repr-section-header > th {
    padding-top: 1rem;
    text-align: left;
    vertical-align: middle;
}
.mne-repr-section-toggle > button {
    all: unset;
    display: block;
    height: 1rem;
    width: 1rem;
}
.mne-repr-section-toggle > button > svg {
    height: 60%;
}

/* transition (rotation) effects on the collapser button */
.mne-repr-section-toggle > button.collapsed > svg {
    transition: 0.1s ease-out;
    transform: rotate(-90deg);
}
.mne-repr-section-toggle > button:not(.collapsed) > svg {
    transition: 0.1s ease-out;
    transform: rotate(0deg);
}

/* hide collapsed table rows */
.mne-repr-collapsed {
    display: none;
}


@layer {
    /*
    Selectors in a `@layer` will always be lower-precedence than selectors outside the
    layer. So even though e.g. `div.output_html` is present in the sphinx-rendered
    website docs, the styles here won't take effect there as long as some other rule
    somewhere in the page's CSS targets the same element.

    In IDEs or Jupyter notebooks, though, the CSS files from the sphinx theme,
    sphinx-gallery, and bootstrap are unavailable, so these styles will apply.

    Notes:

    - the selector `.accordion-body` is for MNE Reports
    - the selector `.output_html` is for VSCode's notebook interface
    - the selector `.jp-RenderedHTML` is for Jupyter notebook
    - variables starting with `--theme-` are VSCode-specific.
    - variables starting with `--jp-` are Jupyter styles, *some of which* are also
      available in VSCode. Here we try the `--theme-` variable first, then fall back to
      the `--jp-` ones.
    */
    .mne-repr-table {
        --mne-toggle-color: var(--theme-foreground, var(--jp-ui-font-color1));
        --mne-button-bg-color: var(--theme-button-background, var(--jp-info-color0, var(--jp-content-link-color)));
        --mne-button-fg-color: var(--theme-button-foreground, var(--jp-ui-inverse-font-color0, var(--jp-editor-background)));
        --mne-button-hover-bg-color: var(--theme-button-hover-background, var(--jp-info-color1));
        --mne-button-radius: var(--jp-border-radius, 0.25rem);
    }
    /* chevron position/alignment; in VSCode it looks ok without adjusting */
    .accordion-body .mne-repr-section-toggle > button,
    .jp-RenderedHTML .mne-repr-section-toggle > button {
        padding: 0 0 45% 25% !important;
    }
    /* chevron color; MNE Report doesn't have light/dark mode */
    div.output_html .mne-repr-section-toggle > button > svg > path,
    .jp-RenderedHTML .mne-repr-section-toggle > button > svg > path {
        fill: var(--mne-toggle-color);
    }
    .accordion-body .mne-ch-names-btn,
    div.output_html .mne-ch-names-btn,
    .jp-RenderedHTML .mne-ch-names-btn {
        -webkit-border-radius: var(--mne-button-radius);
        -moz-border-radius: var(--mne-button-radius);
        border-radius: var(--mne-button-radius);
        border: none;
        background-image: none;
        background-color: var(--mne-button-bg-color);
        color: var(--mne-button-fg-color);
        font-size: inherit;
        min-width: 1.5rem;
        padding: 0.25rem;
        text-align: center;
        text-decoration: none;
    }
    .accordion-body .mne-ch-names-btn:hover,
    div.output_html .mne.ch-names-btn:hover,
    .jp-RenderedHTML .mne-ch-names-btn:hover {
        background-color: var(--mne-button-hover-bg-color);
        text-decoration: underline;
    }
    .accordion-body .mne-ch-names-btn:focus-visible,
    div.output_html .mne-ch-names-btn:focus-visible,
    .jp-RenderedHTML .mne-ch-names-btn:focus-visible {
        outline: 0.1875rem solid var(--mne-button-bg-color) !important;
        outline-offset: 0.1875rem !important;
    }
}
</style>



<table class="table mne-repr-table">
    







<tr class="mne-repr-section-header general-14519491-0ef6-4339-ae56-ebcf0003561b"
     title="Hide section" 
    onclick="toggleVisibility('general-14519491-0ef6-4339-ae56-ebcf0003561b')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>


<tr class="repr-element general-14519491-0ef6-4339-ae56-ebcf0003561b ">
    <td class="mne-repr-section-toggle"></td>
    <td>MNE object type</td>
    <td>Info</td>
</tr>
<tr class="repr-element general-14519491-0ef6-4339-ae56-ebcf0003561b ">
    <td class="mne-repr-section-toggle"></td>
    <td>Measurement date</td>
    
    <td>2009-08-12 at 16:15:00 UTC</td>
    
</tr>
<tr class="repr-element general-14519491-0ef6-4339-ae56-ebcf0003561b ">
    <td class="mne-repr-section-toggle"></td>
    <td>Participant</td>
    
    
    <td>X</td>
    
    
</tr>
<tr class="repr-element general-14519491-0ef6-4339-ae56-ebcf0003561b ">
    <td class="mne-repr-section-toggle"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="mne-repr-section-header acquisition-e5223431-de3c-42fa-af75-d77c5c060b12"
     title="Hide section" 
    onclick="toggleVisibility('acquisition-e5223431-de3c-42fa-af75-d77c5c060b12')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>









<tr class="repr-element acquisition-e5223431-de3c-42fa-af75-d77c5c060b12 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Sampling frequency</td>
    <td>160.00 Hz</td>
</tr>



    







<tr class="mne-repr-section-header channels-e6511190-d740-4b39-9654-502fdc13bf59"
     title="Hide section" 
    onclick="toggleVisibility('channels-e6511190-d740-4b39-9654-502fdc13bf59')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


    
<tr class="repr-element channels-e6511190-d740-4b39-9654-502fdc13bf59 ">
    <td class="mne-repr-section-toggle"></td>
    <td>EEG</td>
    <td>
        <button class="mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm" onclick="alert('Good EEG:\n\nFc5., Fc3., Fc1., Fcz., Fc2., Fc4., Fc6., C5.., C3.., C1.., Cz.., C2.., C4.., C6.., Cp5., Cp3., Cp1., Cpz., Cp2., Cp4., Cp6., Fp1., Fpz., Fp2., Af7., Af3., Afz., Af4., Af8., F7.., F5.., F3.., F1.., Fz.., F2.., F4.., F6.., F8.., Ft7., Ft8., T7.., T8.., T9.., T10., Tp7., Tp8., P7.., P5.., P3.., P1.., Pz.., P2.., P4.., P6.., P8.., Po7., Po3., Poz., Po4., Po8., O1.., Oz.., O2.., Iz..')" title="(Click to open in popup)&#13;&#13;Fc5., Fc3., Fc1., Fcz., Fc2., Fc4., Fc6., C5.., C3.., C1.., Cz.., C2.., C4.., C6.., Cp5., Cp3., Cp1., Cpz., Cp2., Cp4., Cp6., Fp1., Fpz., Fp2., Af7., Af3., Afz., Af4., Af8., F7.., F5.., F3.., F1.., Fz.., F2.., F4.., F6.., F8.., Ft7., Ft8., T7.., T8.., T9.., T10., Tp7., Tp8., P7.., P5.., P3.., P1.., Pz.., P2.., P4.., P6.., P8.., Po7., Po3., Poz., Po4., Po8., O1.., Oz.., O2.., Iz..">
            64
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-e6511190-d740-4b39-9654-502fdc13bf59 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Head & sensor digitization</td>
    
    <td>Not available</td>
    
</tr>
    







<tr class="mne-repr-section-header filters-a57e2cd2-eb59-4642-9a86-77b3bb1cd9bb"
     title="Hide section" 
    onclick="toggleVisibility('filters-a57e2cd2-eb59-4642-9a86-77b3bb1cd9bb')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>


<tr class="repr-element filters-a57e2cd2-eb59-4642-9a86-77b3bb1cd9bb ">
    <td class="mne-repr-section-toggle"></td>
    <td>Highpass</td>
    <td>0.00 Hz</td>
</tr>


<tr class="repr-element filters-a57e2cd2-eb59-4642-9a86-77b3bb1cd9bb ">
    <td class="mne-repr-section-toggle"></td>
    <td>Lowpass</td>
    <td>80.00 Hz</td>
</tr>


</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sampling freq:&quot;</span><span class="p">,</span> <span class="n">sample</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;sfreq&quot;</span><span class="p">],</span> <span class="s2">&quot;Hz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling freq: 160.0 Hz
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Duration (s):&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">/</span> <span class="n">sample</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;sfreq&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duration (s): 125.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;N channels:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">ch_names</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>N channels: 64
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Reflection: data exploration</p>
<ol class="arabic simple">
<li><p><strong>How many channels and what is the sampling frequency? Why is it important to know this?</strong></p></li>
<li><p><strong>What modality and experimental paradigm are used?</strong></p></li>
<li><p><strong>What artifacts can be expected and why?</strong></p></li>
</ol>
</div>
</section>
<section id="channel-selection-and-adding-a-montage">
<h3>Channel selection and adding a montage<a class="headerlink" href="#channel-selection-and-adding-a-montage" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">ch_names</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Fc5.&#39;, &#39;Fc3.&#39;, &#39;Fc1.&#39;]
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Fixing trailing dots in channel names</p>
<p>In some EEG recordings, channel names contain trailing dots (e.g., <code class="docutils literal notranslate"><span class="pre">Fc3.</span></code>).<br />
Fix this using the <code class="docutils literal notranslate"><span class="pre">rename_channels</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># create a mapping: old name → new name (without dot)</span>
<span class="nb">map</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">sample</span><span class="o">.</span><span class="n">ch_names</span><span class="p">:</span>
    <span class="nb">map</span><span class="p">[</span><span class="n">ch</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># apply renaming</span>
<span class="n">sample</span><span class="o">.</span><span class="n">rename_channels</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>

<span class="c1"># check the first channels</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">ch_names</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">sample</span><span class="o">.</span><span class="n">ch_names</span><span class="p">:</span>
    <span class="nb">map</span><span class="p">[</span><span class="n">ch</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">sample</span><span class="o">.</span><span class="n">rename_channels</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    // must be `var` (not `const`) because this can get embedded multiple times on a page
var toggleVisibility = (className) => {

    const elements = document.querySelectorAll(`.${className}`);

    elements.forEach(element => {
        if (element.classList.contains("mne-repr-section-header")) {
            return  // Don't collapse the section header row
        }
        element.classList.toggle("mne-repr-collapsed");
    });

    // trigger caret to rotate
    var sel = `.mne-repr-section-header.${className} > th.mne-repr-section-toggle > button`;
    const button = document.querySelector(sel);
    button.classList.toggle("collapsed");

    // adjust tooltip
    sel = `tr.mne-repr-section-header.${className}`;
    const secHeadRow = document.querySelector(sel);
    secHeadRow.classList.toggle("collapsed");
    secHeadRow.title = secHeadRow.title === "Hide section" ? "Show section" : "Hide section";
}
</script>

<style type="text/css">
    /*
Styles in this section apply both to the sphinx-built website docs and to notebooks
rendered in an IDE or in Jupyter. In our web docs, styles here are complemented by
doc/_static/styles.css and other CSS files (e.g. from the sphinx theme, sphinx-gallery,
or bootstrap). In IDEs/Jupyter, those style files are unavailable, so only the rules in
this file apply (plus whatever default styling the IDE applies).
*/
.mne-repr-table {
    display: inline;  /* prevent using full container width */
}
.mne-repr-table tr.mne-repr-section-header > th {
    padding-top: 1rem;
    text-align: left;
    vertical-align: middle;
}
.mne-repr-section-toggle > button {
    all: unset;
    display: block;
    height: 1rem;
    width: 1rem;
}
.mne-repr-section-toggle > button > svg {
    height: 60%;
}

/* transition (rotation) effects on the collapser button */
.mne-repr-section-toggle > button.collapsed > svg {
    transition: 0.1s ease-out;
    transform: rotate(-90deg);
}
.mne-repr-section-toggle > button:not(.collapsed) > svg {
    transition: 0.1s ease-out;
    transform: rotate(0deg);
}

/* hide collapsed table rows */
.mne-repr-collapsed {
    display: none;
}


@layer {
    /*
    Selectors in a `@layer` will always be lower-precedence than selectors outside the
    layer. So even though e.g. `div.output_html` is present in the sphinx-rendered
    website docs, the styles here won't take effect there as long as some other rule
    somewhere in the page's CSS targets the same element.

    In IDEs or Jupyter notebooks, though, the CSS files from the sphinx theme,
    sphinx-gallery, and bootstrap are unavailable, so these styles will apply.

    Notes:

    - the selector `.accordion-body` is for MNE Reports
    - the selector `.output_html` is for VSCode's notebook interface
    - the selector `.jp-RenderedHTML` is for Jupyter notebook
    - variables starting with `--theme-` are VSCode-specific.
    - variables starting with `--jp-` are Jupyter styles, *some of which* are also
      available in VSCode. Here we try the `--theme-` variable first, then fall back to
      the `--jp-` ones.
    */
    .mne-repr-table {
        --mne-toggle-color: var(--theme-foreground, var(--jp-ui-font-color1));
        --mne-button-bg-color: var(--theme-button-background, var(--jp-info-color0, var(--jp-content-link-color)));
        --mne-button-fg-color: var(--theme-button-foreground, var(--jp-ui-inverse-font-color0, var(--jp-editor-background)));
        --mne-button-hover-bg-color: var(--theme-button-hover-background, var(--jp-info-color1));
        --mne-button-radius: var(--jp-border-radius, 0.25rem);
    }
    /* chevron position/alignment; in VSCode it looks ok without adjusting */
    .accordion-body .mne-repr-section-toggle > button,
    .jp-RenderedHTML .mne-repr-section-toggle > button {
        padding: 0 0 45% 25% !important;
    }
    /* chevron color; MNE Report doesn't have light/dark mode */
    div.output_html .mne-repr-section-toggle > button > svg > path,
    .jp-RenderedHTML .mne-repr-section-toggle > button > svg > path {
        fill: var(--mne-toggle-color);
    }
    .accordion-body .mne-ch-names-btn,
    div.output_html .mne-ch-names-btn,
    .jp-RenderedHTML .mne-ch-names-btn {
        -webkit-border-radius: var(--mne-button-radius);
        -moz-border-radius: var(--mne-button-radius);
        border-radius: var(--mne-button-radius);
        border: none;
        background-image: none;
        background-color: var(--mne-button-bg-color);
        color: var(--mne-button-fg-color);
        font-size: inherit;
        min-width: 1.5rem;
        padding: 0.25rem;
        text-align: center;
        text-decoration: none;
    }
    .accordion-body .mne-ch-names-btn:hover,
    div.output_html .mne.ch-names-btn:hover,
    .jp-RenderedHTML .mne-ch-names-btn:hover {
        background-color: var(--mne-button-hover-bg-color);
        text-decoration: underline;
    }
    .accordion-body .mne-ch-names-btn:focus-visible,
    div.output_html .mne-ch-names-btn:focus-visible,
    .jp-RenderedHTML .mne-ch-names-btn:focus-visible {
        outline: 0.1875rem solid var(--mne-button-bg-color) !important;
        outline-offset: 0.1875rem !important;
    }
}
</style>



<table class="table mne-repr-table">
    







<tr class="mne-repr-section-header general-e2b1d0fe-b9fe-4e93-adb1-f3364091b795"
     title="Hide section" 
    onclick="toggleVisibility('general-e2b1d0fe-b9fe-4e93-adb1-f3364091b795')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>


<tr class="repr-element general-e2b1d0fe-b9fe-4e93-adb1-f3364091b795 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Filename(s)</td>
    <td>
        
        S003R03.edf
        
        
    </td>
</tr>

<tr class="repr-element general-e2b1d0fe-b9fe-4e93-adb1-f3364091b795 ">
    <td class="mne-repr-section-toggle"></td>
    <td>MNE object type</td>
    <td>RawEDF</td>
</tr>
<tr class="repr-element general-e2b1d0fe-b9fe-4e93-adb1-f3364091b795 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Measurement date</td>
    
    <td>2009-08-12 at 16:15:00 UTC</td>
    
</tr>
<tr class="repr-element general-e2b1d0fe-b9fe-4e93-adb1-f3364091b795 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Participant</td>
    
    
    <td>X</td>
    
    
</tr>
<tr class="repr-element general-e2b1d0fe-b9fe-4e93-adb1-f3364091b795 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="mne-repr-section-header acquisition-645a2b20-4512-4aac-94e9-4b85d6820721"
     title="Hide section" 
    onclick="toggleVisibility('acquisition-645a2b20-4512-4aac-94e9-4b85d6820721')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>


<tr class="repr-element acquisition-645a2b20-4512-4aac-94e9-4b85d6820721 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Duration</td>
    <td>00:02:05 (HH:MM:SS)</td>
</tr>








<tr class="repr-element acquisition-645a2b20-4512-4aac-94e9-4b85d6820721 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Sampling frequency</td>
    <td>160.00 Hz</td>
</tr>


<tr class="repr-element acquisition-645a2b20-4512-4aac-94e9-4b85d6820721 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Time points</td>
    <td>20,000</td>
</tr>


    







<tr class="mne-repr-section-header channels-e5273bf9-9c7c-4b26-8aa7-d6ae43b74ee9"
     title="Hide section" 
    onclick="toggleVisibility('channels-e5273bf9-9c7c-4b26-8aa7-d6ae43b74ee9')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


    
<tr class="repr-element channels-e5273bf9-9c7c-4b26-8aa7-d6ae43b74ee9 ">
    <td class="mne-repr-section-toggle"></td>
    <td>EEG</td>
    <td>
        <button class="mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm" onclick="alert('Good EEG:\n\nFc5, Fc3, Fc1, Fcz, Fc2, Fc4, Fc6, C5, C3, C1, Cz, C2, C4, C6, Cp5, Cp3, Cp1, Cpz, Cp2, Cp4, Cp6, Fp1, Fpz, Fp2, Af7, Af3, Afz, Af4, Af8, F7, F5, F3, F1, Fz, F2, F4, F6, F8, Ft7, Ft8, T7, T8, T9, T10, Tp7, Tp8, P7, P5, P3, P1, Pz, P2, P4, P6, P8, Po7, Po3, Poz, Po4, Po8, O1, Oz, O2, Iz')" title="(Click to open in popup)&#13;&#13;Fc5, Fc3, Fc1, Fcz, Fc2, Fc4, Fc6, C5, C3, C1, Cz, C2, C4, C6, Cp5, Cp3, Cp1, Cpz, Cp2, Cp4, Cp6, Fp1, Fpz, Fp2, Af7, Af3, Afz, Af4, Af8, F7, F5, F3, F1, Fz, F2, F4, F6, F8, Ft7, Ft8, T7, T8, T9, T10, Tp7, Tp8, P7, P5, P3, P1, Pz, P2, P4, P6, P8, Po7, Po3, Poz, Po4, Po8, O1, Oz, O2, Iz">
            64
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-e5273bf9-9c7c-4b26-8aa7-d6ae43b74ee9 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Head & sensor digitization</td>
    
    <td>Not available</td>
    
</tr>
    







<tr class="mne-repr-section-header filters-059f1f50-0c5e-49ca-aff0-8d27ae91c073"
     title="Hide section" 
    onclick="toggleVisibility('filters-059f1f50-0c5e-49ca-aff0-8d27ae91c073')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>


<tr class="repr-element filters-059f1f50-0c5e-49ca-aff0-8d27ae91c073 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Highpass</td>
    <td>0.00 Hz</td>
</tr>


<tr class="repr-element filters-059f1f50-0c5e-49ca-aff0-8d27ae91c073 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Lowpass</td>
    <td>80.00 Hz</td>
</tr>


</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">ch_names</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Fc5&#39;, &#39;Fc3&#39;, &#39;Fc1&#39;]
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Why select exactly these 19 channels?</p>
<p>We restrict the analysis to the <strong>classic 19 electrodes of the 10–20 system</strong>.<br />
This ensures comparability with textbooks and standard ERP protocols.</p>
<ul class="simple">
<li><p><strong>A1/A2 are not included</strong> → they are ear electrodes, not always present.</p></li>
<li><p><strong>MNE uses an extended version</strong> of the 10–20 montage (closer to 10–10), so some labels differ:</p>
<ul>
<li><p>T3 = T7, T4 = T8</p></li>
<li><p>T5 = P7, T6 = P8</p></li>
</ul>
</li>
<li><p><strong>Why this matters</strong>: when reading old papers (T3/T4 notation) or working with datasets using different conventions, you must map them consistently.</p></li>
<li><p><strong>Takeaway</strong>: consistent channel selection = reproducible and interpretable analysis.</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">channels_to_use</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># prefrontal</span>
    <span class="s1">&#39;Fp1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Fp2&#39;</span><span class="p">,</span>
    <span class="c1"># frontal</span>
    <span class="s1">&#39;F7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;F3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;F4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Fz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;F8&#39;</span><span class="p">,</span>
    <span class="c1"># central and temporal</span>
    <span class="s1">&#39;T7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;T8&#39;</span><span class="p">,</span>
    <span class="c1"># parietal</span>
    <span class="s1">&#39;P7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;P3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Pz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;P4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;P8&#39;</span><span class="p">,</span>
    <span class="c1"># occipital</span>
    <span class="s1">&#39;O1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;O2&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1020</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">pick</span><span class="p">(</span><span class="n">channels_to_use</span><span class="p">)</span>

<span class="c1"># check that everything is OK</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels_to_use</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_1020</span><span class="o">.</span><span class="n">ch_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ten_twenty_montage</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">make_standard_montage</span><span class="p">(</span><span class="s1">&#39;standard_1020&#39;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">ten_twenty_montage</span><span class="o">.</span><span class="n">ch_names</span><span class="p">)</span> <span class="c1">#This command shows how many channels are embedded in the standard 10–20 montage we loaded. In MNE it is an extended version, so the number will be much greater than 19.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>94
</pre></div>
</div>
</div>
</div>
<section id="mne-channels-make-standard-montage-standard-1020">
<h4>mne.channels.make_standard_montage(‘standard_1020’)<a class="headerlink" href="#mne-channels-make-standard-montage-standard-1020" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Creates a montage object (electrode layout) for the standard 10–20 system.</p></li>
<li><p>It contains 3D coordinates (x, y, z) of each electrode on the scalp.</p></li>
<li><p>Essentially, it is a “map” of electrode positions.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1020</span><span class="o">.</span><span class="n">set_montage</span><span class="p">(</span><span class="n">ten_twenty_montage</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
    // must be `var` (not `const`) because this can get embedded multiple times on a page
var toggleVisibility = (className) => {

    const elements = document.querySelectorAll(`.${className}`);

    elements.forEach(element => {
        if (element.classList.contains("mne-repr-section-header")) {
            return  // Don't collapse the section header row
        }
        element.classList.toggle("mne-repr-collapsed");
    });

    // trigger caret to rotate
    var sel = `.mne-repr-section-header.${className} > th.mne-repr-section-toggle > button`;
    const button = document.querySelector(sel);
    button.classList.toggle("collapsed");

    // adjust tooltip
    sel = `tr.mne-repr-section-header.${className}`;
    const secHeadRow = document.querySelector(sel);
    secHeadRow.classList.toggle("collapsed");
    secHeadRow.title = secHeadRow.title === "Hide section" ? "Show section" : "Hide section";
}
</script>

<style type="text/css">
    /*
Styles in this section apply both to the sphinx-built website docs and to notebooks
rendered in an IDE or in Jupyter. In our web docs, styles here are complemented by
doc/_static/styles.css and other CSS files (e.g. from the sphinx theme, sphinx-gallery,
or bootstrap). In IDEs/Jupyter, those style files are unavailable, so only the rules in
this file apply (plus whatever default styling the IDE applies).
*/
.mne-repr-table {
    display: inline;  /* prevent using full container width */
}
.mne-repr-table tr.mne-repr-section-header > th {
    padding-top: 1rem;
    text-align: left;
    vertical-align: middle;
}
.mne-repr-section-toggle > button {
    all: unset;
    display: block;
    height: 1rem;
    width: 1rem;
}
.mne-repr-section-toggle > button > svg {
    height: 60%;
}

/* transition (rotation) effects on the collapser button */
.mne-repr-section-toggle > button.collapsed > svg {
    transition: 0.1s ease-out;
    transform: rotate(-90deg);
}
.mne-repr-section-toggle > button:not(.collapsed) > svg {
    transition: 0.1s ease-out;
    transform: rotate(0deg);
}

/* hide collapsed table rows */
.mne-repr-collapsed {
    display: none;
}


@layer {
    /*
    Selectors in a `@layer` will always be lower-precedence than selectors outside the
    layer. So even though e.g. `div.output_html` is present in the sphinx-rendered
    website docs, the styles here won't take effect there as long as some other rule
    somewhere in the page's CSS targets the same element.

    In IDEs or Jupyter notebooks, though, the CSS files from the sphinx theme,
    sphinx-gallery, and bootstrap are unavailable, so these styles will apply.

    Notes:

    - the selector `.accordion-body` is for MNE Reports
    - the selector `.output_html` is for VSCode's notebook interface
    - the selector `.jp-RenderedHTML` is for Jupyter notebook
    - variables starting with `--theme-` are VSCode-specific.
    - variables starting with `--jp-` are Jupyter styles, *some of which* are also
      available in VSCode. Here we try the `--theme-` variable first, then fall back to
      the `--jp-` ones.
    */
    .mne-repr-table {
        --mne-toggle-color: var(--theme-foreground, var(--jp-ui-font-color1));
        --mne-button-bg-color: var(--theme-button-background, var(--jp-info-color0, var(--jp-content-link-color)));
        --mne-button-fg-color: var(--theme-button-foreground, var(--jp-ui-inverse-font-color0, var(--jp-editor-background)));
        --mne-button-hover-bg-color: var(--theme-button-hover-background, var(--jp-info-color1));
        --mne-button-radius: var(--jp-border-radius, 0.25rem);
    }
    /* chevron position/alignment; in VSCode it looks ok without adjusting */
    .accordion-body .mne-repr-section-toggle > button,
    .jp-RenderedHTML .mne-repr-section-toggle > button {
        padding: 0 0 45% 25% !important;
    }
    /* chevron color; MNE Report doesn't have light/dark mode */
    div.output_html .mne-repr-section-toggle > button > svg > path,
    .jp-RenderedHTML .mne-repr-section-toggle > button > svg > path {
        fill: var(--mne-toggle-color);
    }
    .accordion-body .mne-ch-names-btn,
    div.output_html .mne-ch-names-btn,
    .jp-RenderedHTML .mne-ch-names-btn {
        -webkit-border-radius: var(--mne-button-radius);
        -moz-border-radius: var(--mne-button-radius);
        border-radius: var(--mne-button-radius);
        border: none;
        background-image: none;
        background-color: var(--mne-button-bg-color);
        color: var(--mne-button-fg-color);
        font-size: inherit;
        min-width: 1.5rem;
        padding: 0.25rem;
        text-align: center;
        text-decoration: none;
    }
    .accordion-body .mne-ch-names-btn:hover,
    div.output_html .mne.ch-names-btn:hover,
    .jp-RenderedHTML .mne-ch-names-btn:hover {
        background-color: var(--mne-button-hover-bg-color);
        text-decoration: underline;
    }
    .accordion-body .mne-ch-names-btn:focus-visible,
    div.output_html .mne-ch-names-btn:focus-visible,
    .jp-RenderedHTML .mne-ch-names-btn:focus-visible {
        outline: 0.1875rem solid var(--mne-button-bg-color) !important;
        outline-offset: 0.1875rem !important;
    }
}
</style>



<table class="table mne-repr-table">
    







<tr class="mne-repr-section-header general-4e97b887-557c-468e-91e0-748a04dc54aa"
     title="Hide section" 
    onclick="toggleVisibility('general-4e97b887-557c-468e-91e0-748a04dc54aa')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>


<tr class="repr-element general-4e97b887-557c-468e-91e0-748a04dc54aa ">
    <td class="mne-repr-section-toggle"></td>
    <td>Filename(s)</td>
    <td>
        
        S003R03.edf
        
        
    </td>
</tr>

<tr class="repr-element general-4e97b887-557c-468e-91e0-748a04dc54aa ">
    <td class="mne-repr-section-toggle"></td>
    <td>MNE object type</td>
    <td>RawEDF</td>
</tr>
<tr class="repr-element general-4e97b887-557c-468e-91e0-748a04dc54aa ">
    <td class="mne-repr-section-toggle"></td>
    <td>Measurement date</td>
    
    <td>2009-08-12 at 16:15:00 UTC</td>
    
</tr>
<tr class="repr-element general-4e97b887-557c-468e-91e0-748a04dc54aa ">
    <td class="mne-repr-section-toggle"></td>
    <td>Participant</td>
    
    
    <td>X</td>
    
    
</tr>
<tr class="repr-element general-4e97b887-557c-468e-91e0-748a04dc54aa ">
    <td class="mne-repr-section-toggle"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="mne-repr-section-header acquisition-e232aace-2acf-47c4-a6e8-56f6a2505d16"
     title="Hide section" 
    onclick="toggleVisibility('acquisition-e232aace-2acf-47c4-a6e8-56f6a2505d16')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>


<tr class="repr-element acquisition-e232aace-2acf-47c4-a6e8-56f6a2505d16 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Duration</td>
    <td>00:02:05 (HH:MM:SS)</td>
</tr>








<tr class="repr-element acquisition-e232aace-2acf-47c4-a6e8-56f6a2505d16 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Sampling frequency</td>
    <td>160.00 Hz</td>
</tr>


<tr class="repr-element acquisition-e232aace-2acf-47c4-a6e8-56f6a2505d16 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Time points</td>
    <td>20,000</td>
</tr>


    







<tr class="mne-repr-section-header channels-609b7f0d-a445-4bdd-b866-7011d76bb88e"
     title="Hide section" 
    onclick="toggleVisibility('channels-609b7f0d-a445-4bdd-b866-7011d76bb88e')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


    
<tr class="repr-element channels-609b7f0d-a445-4bdd-b866-7011d76bb88e ">
    <td class="mne-repr-section-toggle"></td>
    <td>EEG</td>
    <td>
        <button class="mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm" onclick="alert('Good EEG:\n\nFp1, Fp2, F7, F3, F4, Fz, F8, T7, C3, Cz, C4, T8, P7, P3, Pz, P4, P8, O1, O2')" title="(Click to open in popup)&#13;&#13;Fp1, Fp2, F7, F3, F4, Fz, F8, T7, C3, Cz, C4, T8, P7, P3, Pz, P4, P8, O1, O2">
            19
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-609b7f0d-a445-4bdd-b866-7011d76bb88e ">
    <td class="mne-repr-section-toggle"></td>
    <td>Head & sensor digitization</td>
    
    <td>22 points</td>
    
</tr>
    







<tr class="mne-repr-section-header filters-f8d6b448-abc8-4225-ad09-fd4cd47f025b"
     title="Hide section" 
    onclick="toggleVisibility('filters-f8d6b448-abc8-4225-ad09-fd4cd47f025b')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>


<tr class="repr-element filters-f8d6b448-abc8-4225-ad09-fd4cd47f025b ">
    <td class="mne-repr-section-toggle"></td>
    <td>Highpass</td>
    <td>0.00 Hz</td>
</tr>


<tr class="repr-element filters-f8d6b448-abc8-4225-ad09-fd4cd47f025b ">
    <td class="mne-repr-section-toggle"></td>
    <td>Lowpass</td>
    <td>80.00 Hz</td>
</tr>


</table></div></div>
</div>
</section>
<section id="raw-1020-set-montage-mont">
<h4>raw_1020.set_montage(mont)<a class="headerlink" href="#raw-1020-set-montage-mont" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Assigns this map to the raw_1020 object.</p></li>
<li><p>Each EEG channel now has a known spatial position.</p></li>
<li><p>Required for topomaps, sensor plots, connectivity</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1020</span><span class="o">.</span><span class="n">plot_sensors</span><span class="p">(</span><span class="n">show_names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3cc55b7bab0e95fa0ebf4f676dfa117e4c50376ed8f28b8e214d30008e47954a.png" src="_images/3cc55b7bab0e95fa0ebf4f676dfa117e4c50376ed8f28b8e214d30008e47954a.png" />
<img alt="_images/3cc55b7bab0e95fa0ebf4f676dfa117e4c50376ed8f28b8e214d30008e47954a.png" src="_images/3cc55b7bab0e95fa0ebf4f676dfa117e4c50376ed8f28b8e214d30008e47954a.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Reflection: montage</p>
<p><strong>Q1. Why is it important to standardize/normalize channel names before analysis?</strong><br />
<strong>Q2. Why do we need to set a montage? What problems arise for topomaps if we skip it?</strong><br />
<strong>Q3. Which of the selected 10–20 channels are located over the motor cortex?</strong><br />
<strong>Q4. How can you distinguish temporal from occipital channels in the 10–20 scheme?</strong></p>
</div>
</section>
</section>
<section id="checking-and-cleaning-eeg-spectrum">
<h3>Checking and Cleaning EEG Spectrum<a class="headerlink" href="#checking-and-cleaning-eeg-spectrum" title="Link to this heading">#</a></h3>
<p>We first inspect the power spectrum (PSD) to detect line noise and drifts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1020</span><span class="o">.</span><span class="n">compute_psd</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Effective window size : 12.800 (s)
Plotting power spectral density (dB=True).
</pre></div>
</div>
<img alt="_images/b07edf98abcc83055a78aa1fa3cb364b674cb9062ba2e18b5ab9367065f13d29.png" src="_images/b07edf98abcc83055a78aa1fa3cb364b674cb9062ba2e18b5ab9367065f13d29.png" />
<img alt="_images/b07edf98abcc83055a78aa1fa3cb364b674cb9062ba2e18b5ab9367065f13d29.png" src="_images/b07edf98abcc83055a78aa1fa3cb364b674cb9062ba2e18b5ab9367065f13d29.png" />
</div>
</div>
<section id="main-signal-energy-is-concentrated-in-low-frequencies-10-hz">
<h4>1. Main signal energy is concentrated in low frequencies (&lt;10 Hz)<a class="headerlink" href="#main-signal-energy-is-concentrated-in-low-frequencies-10-hz" title="Link to this heading">#</a></h4>
<p>This reflects basic EEG physiology: in humans, most of the power lies in slow oscillations.</p>
<ul class="simple">
<li><p><strong>1–4 Hz (delta)</strong> — dominant during sleep, but also partly present as background during wakefulness.</p></li>
<li><p><strong>4–8 Hz (theta)</strong> — associated with drowsiness and attention.</p></li>
<li><p><strong>8–13 Hz (alpha)</strong> — typical for occipital areas, especially with eyes closed.</p></li>
</ul>
<p>The fact that low frequencies dominate the spectrum confirms that this is real EEG, not just noise.</p>
</section>
<section id="weak-50-60-hz-peak">
<h4>2. Weak 50/60-Hz peak<a class="headerlink" href="#weak-50-60-hz-peak" title="Link to this heading">#</a></h4>
<p>In real recordings, a <em>spike</em> at the power line frequency (50 Hz in Europe, 60 Hz in North America) is often visible.</p>
<p>Here it is weak, which means:</p>
<ul class="simple">
<li><p>either the equipment was well shielded,</p></li>
<li><p>or the artifact was attenuated by the filter (<code class="docutils literal notranslate"><span class="pre">h_freq=50</span></code> (60)).</p></li>
</ul>
<p>➡️ This is convenient: a separate notch filter is not required.</p>
<ul class="simple">
<li><p><strong>What The <a class="reference external" href="https://mne.tools/stable/generated/mne.filter.notch_filter.html#mne-filter-notch-filter">notch filter</a> does:</strong> it is a <em>targeted filter</em> that removes a narrow band around a single frequency (e.g., exactly 50 or 60 Hz).</p></li>
<li><p><strong>Why:</strong> the power grid operates at a fixed frequency (50/60 Hz), and this activity “leaks” into EEG recordings as a characteristic spike in the spectrum.</p></li>
<li><p><strong>Problem:</strong> this activity is not brain-related but can mask real neural rhythms.</p></li>
<li><p><strong>Solution:</strong> the notch filter selectively removes this noise while preserving neighboring frequencies (e.g., the alpha rhythm at 10 Hz or the beta rhythm at 20 Hz).</p></li>
</ul>
</section>
<section id="band-pass-filtering">
<h4>Band-pass filtering<a class="headerlink" href="#band-pass-filtering" title="Link to this heading">#</a></h4>
<p>➡️ We apply a band-pass filter (1–50 Hz) to preserve only brain rhythms and remove drift and noise. For this, we use a digital IIR filter, which works efficiently and is applied in MNE in a safe zero-phase mode without time distortion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1020</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">l_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">h_freq</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;iir&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 50 Hz

IIR filter parameters
---------------------
Butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
- Filter order 16 (effective, after forward-backward)
- Cutoffs at 1.00, 50.00 Hz: -6.02, -6.02 dB
</pre></div>
</div>
<div class="output text_html"><script type="text/javascript">
    // must be `var` (not `const`) because this can get embedded multiple times on a page
var toggleVisibility = (className) => {

    const elements = document.querySelectorAll(`.${className}`);

    elements.forEach(element => {
        if (element.classList.contains("mne-repr-section-header")) {
            return  // Don't collapse the section header row
        }
        element.classList.toggle("mne-repr-collapsed");
    });

    // trigger caret to rotate
    var sel = `.mne-repr-section-header.${className} > th.mne-repr-section-toggle > button`;
    const button = document.querySelector(sel);
    button.classList.toggle("collapsed");

    // adjust tooltip
    sel = `tr.mne-repr-section-header.${className}`;
    const secHeadRow = document.querySelector(sel);
    secHeadRow.classList.toggle("collapsed");
    secHeadRow.title = secHeadRow.title === "Hide section" ? "Show section" : "Hide section";
}
</script>

<style type="text/css">
    /*
Styles in this section apply both to the sphinx-built website docs and to notebooks
rendered in an IDE or in Jupyter. In our web docs, styles here are complemented by
doc/_static/styles.css and other CSS files (e.g. from the sphinx theme, sphinx-gallery,
or bootstrap). In IDEs/Jupyter, those style files are unavailable, so only the rules in
this file apply (plus whatever default styling the IDE applies).
*/
.mne-repr-table {
    display: inline;  /* prevent using full container width */
}
.mne-repr-table tr.mne-repr-section-header > th {
    padding-top: 1rem;
    text-align: left;
    vertical-align: middle;
}
.mne-repr-section-toggle > button {
    all: unset;
    display: block;
    height: 1rem;
    width: 1rem;
}
.mne-repr-section-toggle > button > svg {
    height: 60%;
}

/* transition (rotation) effects on the collapser button */
.mne-repr-section-toggle > button.collapsed > svg {
    transition: 0.1s ease-out;
    transform: rotate(-90deg);
}
.mne-repr-section-toggle > button:not(.collapsed) > svg {
    transition: 0.1s ease-out;
    transform: rotate(0deg);
}

/* hide collapsed table rows */
.mne-repr-collapsed {
    display: none;
}


@layer {
    /*
    Selectors in a `@layer` will always be lower-precedence than selectors outside the
    layer. So even though e.g. `div.output_html` is present in the sphinx-rendered
    website docs, the styles here won't take effect there as long as some other rule
    somewhere in the page's CSS targets the same element.

    In IDEs or Jupyter notebooks, though, the CSS files from the sphinx theme,
    sphinx-gallery, and bootstrap are unavailable, so these styles will apply.

    Notes:

    - the selector `.accordion-body` is for MNE Reports
    - the selector `.output_html` is for VSCode's notebook interface
    - the selector `.jp-RenderedHTML` is for Jupyter notebook
    - variables starting with `--theme-` are VSCode-specific.
    - variables starting with `--jp-` are Jupyter styles, *some of which* are also
      available in VSCode. Here we try the `--theme-` variable first, then fall back to
      the `--jp-` ones.
    */
    .mne-repr-table {
        --mne-toggle-color: var(--theme-foreground, var(--jp-ui-font-color1));
        --mne-button-bg-color: var(--theme-button-background, var(--jp-info-color0, var(--jp-content-link-color)));
        --mne-button-fg-color: var(--theme-button-foreground, var(--jp-ui-inverse-font-color0, var(--jp-editor-background)));
        --mne-button-hover-bg-color: var(--theme-button-hover-background, var(--jp-info-color1));
        --mne-button-radius: var(--jp-border-radius, 0.25rem);
    }
    /* chevron position/alignment; in VSCode it looks ok without adjusting */
    .accordion-body .mne-repr-section-toggle > button,
    .jp-RenderedHTML .mne-repr-section-toggle > button {
        padding: 0 0 45% 25% !important;
    }
    /* chevron color; MNE Report doesn't have light/dark mode */
    div.output_html .mne-repr-section-toggle > button > svg > path,
    .jp-RenderedHTML .mne-repr-section-toggle > button > svg > path {
        fill: var(--mne-toggle-color);
    }
    .accordion-body .mne-ch-names-btn,
    div.output_html .mne-ch-names-btn,
    .jp-RenderedHTML .mne-ch-names-btn {
        -webkit-border-radius: var(--mne-button-radius);
        -moz-border-radius: var(--mne-button-radius);
        border-radius: var(--mne-button-radius);
        border: none;
        background-image: none;
        background-color: var(--mne-button-bg-color);
        color: var(--mne-button-fg-color);
        font-size: inherit;
        min-width: 1.5rem;
        padding: 0.25rem;
        text-align: center;
        text-decoration: none;
    }
    .accordion-body .mne-ch-names-btn:hover,
    div.output_html .mne.ch-names-btn:hover,
    .jp-RenderedHTML .mne-ch-names-btn:hover {
        background-color: var(--mne-button-hover-bg-color);
        text-decoration: underline;
    }
    .accordion-body .mne-ch-names-btn:focus-visible,
    div.output_html .mne-ch-names-btn:focus-visible,
    .jp-RenderedHTML .mne-ch-names-btn:focus-visible {
        outline: 0.1875rem solid var(--mne-button-bg-color) !important;
        outline-offset: 0.1875rem !important;
    }
}
</style>



<table class="table mne-repr-table">
    







<tr class="mne-repr-section-header general-45bd49fb-fe41-4dec-859b-c76f753fb7a1"
     title="Hide section" 
    onclick="toggleVisibility('general-45bd49fb-fe41-4dec-859b-c76f753fb7a1')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>


<tr class="repr-element general-45bd49fb-fe41-4dec-859b-c76f753fb7a1 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Filename(s)</td>
    <td>
        
        S003R03.edf
        
        
    </td>
</tr>

<tr class="repr-element general-45bd49fb-fe41-4dec-859b-c76f753fb7a1 ">
    <td class="mne-repr-section-toggle"></td>
    <td>MNE object type</td>
    <td>RawEDF</td>
</tr>
<tr class="repr-element general-45bd49fb-fe41-4dec-859b-c76f753fb7a1 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Measurement date</td>
    
    <td>2009-08-12 at 16:15:00 UTC</td>
    
</tr>
<tr class="repr-element general-45bd49fb-fe41-4dec-859b-c76f753fb7a1 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Participant</td>
    
    
    <td>X</td>
    
    
</tr>
<tr class="repr-element general-45bd49fb-fe41-4dec-859b-c76f753fb7a1 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="mne-repr-section-header acquisition-188ac97e-91b6-4c2e-882c-36892a696999"
     title="Hide section" 
    onclick="toggleVisibility('acquisition-188ac97e-91b6-4c2e-882c-36892a696999')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>


<tr class="repr-element acquisition-188ac97e-91b6-4c2e-882c-36892a696999 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Duration</td>
    <td>00:02:05 (HH:MM:SS)</td>
</tr>








<tr class="repr-element acquisition-188ac97e-91b6-4c2e-882c-36892a696999 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Sampling frequency</td>
    <td>160.00 Hz</td>
</tr>


<tr class="repr-element acquisition-188ac97e-91b6-4c2e-882c-36892a696999 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Time points</td>
    <td>20,000</td>
</tr>


    







<tr class="mne-repr-section-header channels-71ea450f-7a00-4295-9a46-057500f9d690"
     title="Hide section" 
    onclick="toggleVisibility('channels-71ea450f-7a00-4295-9a46-057500f9d690')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


    
<tr class="repr-element channels-71ea450f-7a00-4295-9a46-057500f9d690 ">
    <td class="mne-repr-section-toggle"></td>
    <td>EEG</td>
    <td>
        <button class="mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm" onclick="alert('Good EEG:\n\nFp1, Fp2, F7, F3, F4, Fz, F8, T7, C3, Cz, C4, T8, P7, P3, Pz, P4, P8, O1, O2')" title="(Click to open in popup)&#13;&#13;Fp1, Fp2, F7, F3, F4, Fz, F8, T7, C3, Cz, C4, T8, P7, P3, Pz, P4, P8, O1, O2">
            19
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-71ea450f-7a00-4295-9a46-057500f9d690 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Head & sensor digitization</td>
    
    <td>22 points</td>
    
</tr>
    







<tr class="mne-repr-section-header filters-e4cf7da9-e32f-4a74-a8f6-9b5bedccfa2e"
     title="Hide section" 
    onclick="toggleVisibility('filters-e4cf7da9-e32f-4a74-a8f6-9b5bedccfa2e')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>


<tr class="repr-element filters-e4cf7da9-e32f-4a74-a8f6-9b5bedccfa2e ">
    <td class="mne-repr-section-toggle"></td>
    <td>Highpass</td>
    <td>1.00 Hz</td>
</tr>


<tr class="repr-element filters-e4cf7da9-e32f-4a74-a8f6-9b5bedccfa2e ">
    <td class="mne-repr-section-toggle"></td>
    <td>Lowpass</td>
    <td>50.00 Hz</td>
</tr>


</table></div></div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Ploting psd after filtering</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">sample_1020</span><span class="o">.</span><span class="n">compute_psd</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1020</span><span class="o">.</span><span class="n">compute_psd</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Effective window size : 12.800 (s)
Plotting power spectral density (dB=True).
</pre></div>
</div>
<img alt="_images/10985d9f7df87078ce560a020cf2e31ef389a68a575765e7c017bc78cdb65c11.png" src="_images/10985d9f7df87078ce560a020cf2e31ef389a68a575765e7c017bc78cdb65c11.png" />
<img alt="_images/10985d9f7df87078ce560a020cf2e31ef389a68a575765e7c017bc78cdb65c11.png" src="_images/10985d9f7df87078ce560a020cf2e31ef389a68a575765e7c017bc78cdb65c11.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Reflection: filtering</p>
<p><strong>Q1. What is the difference between a notch and a band-pass filter? Why are both steps useful?</strong><br />
<strong>Q2. Why is it better to filter after setting the montage?</strong><br />
<strong>Q3. What does 1–50 Hz mean for EEG? Which physiological rhythms are preserved or removed?</strong><br />
<strong>Q4. Why is drift &lt;1 Hz undesirable for ERP analysis?</strong></p>
</div>
</section>
<section id="plot-eeg-signals">
<h4>Plot EEG signals<a class="headerlink" href="#plot-eeg-signals" title="Link to this heading">#</a></h4>
<p>We display several EEG channels on the screen for 20 seconds to visually check signal quality and detect artifacts that are not always visible in the spectrum. However, it is important to adjust the scalings parameter for proper visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1020</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using matplotlib as 2D backend.
</pre></div>
</div>
<img alt="_images/bc6f60c8535bc25f64270e5b813322e28b462a82f9e4cd7488196b90267eddf4.png" src="_images/bc6f60c8535bc25f64270e5b813322e28b462a82f9e4cd7488196b90267eddf4.png" />
<img alt="_images/bc6f60c8535bc25f64270e5b813322e28b462a82f9e4cd7488196b90267eddf4.png" src="_images/bc6f60c8535bc25f64270e5b813322e28b462a82f9e4cd7488196b90267eddf4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot in better scale. Use &#39;scalings&#39; argument</span>
<span class="n">sample_1020</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scalings</span><span class="o">=</span><span class="mf">3e-4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0afcea4470998fb0600bf043075fed061d7bdc2cac026ec5fb1d8e5ecdc95279.png" src="_images/0afcea4470998fb0600bf043075fed061d7bdc2cac026ec5fb1d8e5ecdc95279.png" />
<img alt="_images/0afcea4470998fb0600bf043075fed061d7bdc2cac026ec5fb1d8e5ecdc95279.png" src="_images/0afcea4470998fb0600bf043075fed061d7bdc2cac026ec5fb1d8e5ecdc95279.png" />
</div>
</div>
</section>
</section>
<section id="event-detection-triggers-vs-annotations">
<h3>Event Detection: Triggers vs Annotations<a class="headerlink" href="#event-detection-triggers-vs-annotations" title="Link to this heading">#</a></h3>
<p>In EEG processing, correctly identifying events (e.g., stimulus onsets, task markers) is critical for epoching and downstream analysis. MNE-Python offers different tools depending on how these events are encoded in your file format:</p>
<ul class="simple">
<li><p>Use <strong><code class="docutils literal notranslate"><span class="pre">mne.find_events</span></code></strong> when events are stored in a dedicated trigger channel (common in FIFF/BDF formats).</p></li>
<li><p>Use <strong><code class="docutils literal notranslate"><span class="pre">mne.events_from_annotations</span></code></strong> when events are embedded as annotations/markers (typical for EDF+ or BrainVision with annotations).</p></li>
</ul>
<section id="why-it-matters-for-your-data">
<h4>Why it matters for your data<a class="headerlink" href="#why-it-matters-for-your-data" title="Link to this heading">#</a></h4>
<p>In our case, we’re working with EDF+ files (e.g., <code class="docutils literal notranslate"><span class="pre">S003R03.edf</span></code>). That means the events are stored as annotations, not trigger channels—so we should use <code class="docutils literal notranslate"><span class="pre">mne.events_from_annotations()</span></code> to properly extract them.</p>
<p>Next, we’ll load the events and create epochs around them for further analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events</span><span class="p">,</span> <span class="n">events_dict</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">events_from_annotations</span><span class="p">(</span><span class="n">sample_1020</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Used Annotations descriptions: [np.str_(&#39;T0&#39;), np.str_(&#39;T1&#39;), np.str_(&#39;T2&#39;)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{np.str_(&#39;T0&#39;): 1, np.str_(&#39;T1&#39;): 2, np.str_(&#39;T2&#39;): 3}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">events</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[   0,    0,    1],
       [ 672,    0,    3],
       [1328,    0,    1],
       [2000,    0,    2],
       [2656,    0,    1]])
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Event array format in MNE:</p>
<p>[\text{sample_index},\ \text{previous_event_code},\ \text{current_event_code}]</p>
<ul class="simple">
<li><p>sample_index – the time point (in samples) when the event occurs.</p></li>
<li><p>previous_event_code – the code of the event/state before the change (often 0 in EDF+).</p></li>
<li><p>current_event_code – the new event code that marks what actually happened.</p></li>
</ul>
<p>👉 In EDF+ data, the middle column is usually 0 because events come from annotations, not from state changes.</p>
</div>
</section>
</section>
<section id="creating-epochs">
<h3>Creating Epochs<a class="headerlink" href="#creating-epochs" title="Link to this heading">#</a></h3>
<p>Once we have identified the events of interest in our continuous Raw data, the next logical step is to segment the continuous EEG into <strong>epochs</strong> — short, equal-duration chunks of signal that are time-locked to each event. This is crucial because averaging across many such epochs allows us to reveal consistent brain responses (ERPs) while reducing random noise.</p>
<p>In MNE, the <strong>Raw object</strong> together with the <strong>events array</strong> is the minimal input needed to create an <code class="docutils literal notranslate"><span class="pre">Epochs</span></code> object  with the <code class="docutils literal notranslate"><span class="pre">mne.Epochs</span></code> class constructor. However, in practice we rarely use the defaults: we almost always want to specify the time window relative to each event, using the parameters <code class="docutils literal notranslate"><span class="pre">tmin</span></code> and <code class="docutils literal notranslate"><span class="pre">tmax</span></code> (start and end time of each epoch relative to the event). This ensures that our epochs capture both the pre-stimulus baseline and the post-stimulus response of interest.</p>
<p>We take 500 ms before the event as a baseline and 800 ms after the event to capture the main brain responses. This is a typical window for ERP analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">sample_1020</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span>  <span class="n">tmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not setting metadata
30 matching events found
Setting baseline interval to [-0.5, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Using data from preloaded Raw for 30 events and 209 original time points ...
1 bad epochs dropped
</pre></div>
</div>
</div>
</div>
<p>We convert the list of events into a table and count how many times each event type occurs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">events</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;__&#39;</span><span class="p">,</span> <span class="s1">&#39;event_id&#39;</span><span class="p">])[</span><span class="s1">&#39;event_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>event_id
1    14
3     8
2     7
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>This is a quick way to check the class balance before creating Epochs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take the first epoch from the Epochs object</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">epochs</span><span class="p">:</span>
    <span class="k">break</span>
<span class="nb">print</span><span class="p">(</span><span class="n">epoch</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  
<span class="c1"># Output: (19, 209)</span>
<span class="c1"># -&gt; 19 EEG channels × 209 time points</span>
<span class="c1"># Each epoch is stored as a 2D NumPy array (channels × samples)</span>

<span class="c1"># Compute the duration of a single epoch in seconds</span>
<span class="n">epoch_duration</span> <span class="o">=</span> <span class="n">epoch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">sample_1020</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">epoch_duration</span><span class="p">)</span>  
<span class="c1"># 209 samples / 160 Hz sampling rate ≈ 1.3 seconds</span>
<span class="c1"># This matches the chosen window: tmin = -0.5 s, tmax = 0.8 s</span>

<span class="c1"># Convert the raw object into a pandas DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample_1020</span><span class="o">.</span><span class="n">to_data_frame</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  
<span class="c1"># (20000, 20)</span>
<span class="c1"># -&gt; 20,000 time points × 20 channels</span>
<span class="c1"># Each column corresponds to an EEG channel (plus &#39;time&#39; if included)</span>
<span class="c1"># This format is convenient for quick inspection, plotting with pandas,</span>
<span class="c1"># or exporting EEG data to other analysis pipelines.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(19, 209)
1.30625
(20000, 20)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">epochs</span><span class="o">.</span><span class="n">to_data_frame</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>condition</th>
      <th>epoch</th>
      <th>Fp1</th>
      <th>Fp2</th>
      <th>F7</th>
      <th>F3</th>
      <th>F4</th>
      <th>Fz</th>
      <th>F8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.50000</td>
      <td>3</td>
      <td>1</td>
      <td>236.675891</td>
      <td>244.275703</td>
      <td>125.936913</td>
      <td>88.829681</td>
      <td>112.445086</td>
      <td>73.438632</td>
      <td>145.805904</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.49375</td>
      <td>3</td>
      <td>1</td>
      <td>175.970007</td>
      <td>183.425016</td>
      <td>103.803572</td>
      <td>63.009365</td>
      <td>82.687750</td>
      <td>48.730906</td>
      <td>115.749079</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.48750</td>
      <td>3</td>
      <td>1</td>
      <td>127.095181</td>
      <td>132.985975</td>
      <td>61.669835</td>
      <td>31.478465</td>
      <td>62.299189</td>
      <td>33.384794</td>
      <td>93.870855</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<ul class="simple">
<li><p>We can see the raw numeric values (in µV) for each channel at each time point.</p></li>
<li><p>Easy to check that metadata (condition, epoch) are aligned correctly.</p></li>
</ul>
</div>
<section id="peak-to-peak-amplitude-qc">
<h4>Peak-to-peak amplitude (QC)<a class="headerlink" href="#peak-to-peak-amplitude-qc" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">sample_1020</span><span class="o">.</span><span class="n">ch_names</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;epoch&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;epoch&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">arr</span><span class="p">:</span> <span class="n">arr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">arr</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/12345d189b9e237dd2e5194f1dfa39615d404d51d3496709f2e218d4258527bc.png" src="_images/12345d189b9e237dd2e5194f1dfa39615d404d51d3496709f2e218d4258527bc.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<ul class="simple">
<li><p>A quick QC step: typical amplitudes and outliers.</p></li>
<li><p>If Fp1/Fp2 show very large values → likely eye blinks or EOG.</p></li>
<li><p>Helps justify setting a rejection threshold (e.g., reject={‘eeg’: 600e-6}).</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">sample_1020</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span>  <span class="n">tmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;eeg&#39;</span><span class="p">:</span> <span class="mf">600e-6</span><span class="p">},</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not setting metadata
30 matching events found
Applying baseline correction (mode: mean)
0 projection items activated
Using data from preloaded Raw for 30 events and 209 original time points ...
    Rejecting  epoch based on EEG : [&#39;Fp1&#39;, &#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp1&#39;, &#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp1&#39;, &#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp1&#39;, &#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp1&#39;, &#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp1&#39;, &#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp1&#39;, &#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp1&#39;, &#39;Fp2&#39;]
    Rejecting  epoch based on EEG : [&#39;Fp1&#39;, &#39;Fp2&#39;]
15 bad epochs dropped
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<ul class="simple">
<li><p>How many epochs are rejected and why.</p></li>
<li><p>Clean dataset for ERP analysis.</p></li>
</ul>
</div>
</section>
<section id="psd-of-epochs">
<h4>PSD of epochs<a class="headerlink" href="#psd-of-epochs" title="Link to this heading">#</a></h4>
<p>Compute and plot the Power Spectral Density across epochs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">plot_psd</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NOTE: plot_psd() is a legacy function. New code should use .compute_psd().plot().
    Using multitaper spectrum estimation with 7 DPSS windows
Plotting power spectral density (dB=True).
Averaging across epochs before plotting...
</pre></div>
</div>
<img alt="_images/7ad920ceb6b622fae538e74182330cc790150c302108f2c8755f5d57d274dfed.png" src="_images/7ad920ceb6b622fae538e74182330cc790150c302108f2c8755f5d57d274dfed.png" />
<img alt="_images/7ad920ceb6b622fae538e74182330cc790150c302108f2c8755f5d57d274dfed.png" src="_images/7ad920ceb6b622fae538e74182330cc790150c302108f2c8755f5d57d274dfed.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<ul class="simple">
<li><p>EEG shows the typical 1/f spectrum.</p></li>
<li><p>&lt;1 Hz drift and &gt;50 Hz noise are cut off.</p></li>
<li><p>No sharp spike at 50/60 Hz → line noise is not dominant.</p></li>
</ul>
</div>
<p>Check that baseline correction and filtering worked properly</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">scalings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;eeg&#39;</span><span class="p">:</span><span class="mf">3e-4</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ce835df874f6db472794d229d7ba7b2b64a923923c635bf387ecc5f455a30c3a.png" src="_images/ce835df874f6db472794d229d7ba7b2b64a923923c635bf387ecc5f455a30c3a.png" />
<img alt="_images/ce835df874f6db472794d229d7ba7b2b64a923923c635bf387ecc5f455a30c3a.png" src="_images/ce835df874f6db472794d229d7ba7b2b64a923923c635bf387ecc5f455a30c3a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">event_id</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;1&#39;: 1, &#39;2&#39;: 2, &#39;3&#39;: 3}
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Checking number of events of each type (use epochs.events)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">events</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;__&#39;</span><span class="p">,</span> <span class="s1">&#39;event_id&#39;</span><span class="p">])[</span><span class="s1">&#39;event_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="err">```</span>
</pre></div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">events</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;__&#39;</span><span class="p">,</span> <span class="s1">&#39;event_id&#39;</span><span class="p">])[</span><span class="s1">&#39;event_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>event_id
3    6
1    5
2    4
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="averaging-evoked-responses">
<h4>Averaging (Evoked responses)<a class="headerlink" href="#averaging-evoked-responses" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T0</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">evoked_T1</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">evoked_T2</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0c0405bbea29cb843886694b1bc46d9f1881b513727fa274c94fb0f792a9f784.png" src="_images/0c0405bbea29cb843886694b1bc46d9f1881b513727fa274c94fb0f792a9f784.png" />
<img alt="_images/0c0405bbea29cb843886694b1bc46d9f1881b513727fa274c94fb0f792a9f784.png" src="_images/0c0405bbea29cb843886694b1bc46d9f1881b513727fa274c94fb0f792a9f784.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b99210c2c796a78e6979c4acf0428f5fb8e2a6eba8f3bb063ca5f2988a23e8f3.png" src="_images/b99210c2c796a78e6979c4acf0428f5fb8e2a6eba8f3bb063ca5f2988a23e8f3.png" />
<img alt="_images/b99210c2c796a78e6979c4acf0428f5fb8e2a6eba8f3bb063ca5f2988a23e8f3.png" src="_images/b99210c2c796a78e6979c4acf0428f5fb8e2a6eba8f3bb063ca5f2988a23e8f3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/76c795be56ac0891cce2bd8d16ee65a639e821225ad85666bf82834f1f2aeb47.png" src="_images/76c795be56ac0891cce2bd8d16ee65a639e821225ad85666bf82834f1f2aeb47.png" />
<img alt="_images/76c795be56ac0891cce2bd8d16ee65a639e821225ad85666bf82834f1f2aeb47.png" src="_images/76c795be56ac0891cce2bd8d16ee65a639e821225ad85666bf82834f1f2aeb47.png" />
</div>
</div>
<ul class="simple">
<li><p>Compute condition-specific averages (ERPs).</p></li>
<li><p>Plot with spatial_colors=True so channels are colored by location.</p></li>
</ul>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<ul class="simple">
<li><p>Inspect ERP morphology and possible lateralization (C3/Cz/C4 for motor tasks).</p></li>
<li><p>Check N_avg in the top corner = how many epochs survived rejection.</p></li>
<li><p>If T1 vs T2 have very different N_avg, keep this in mind for statistical comparisons.</p></li>
</ul>
</div>
</section>
</section>
</section>
<section id="part-2">
<h2>Part 2<a class="headerlink" href="#part-2" title="Link to this heading">#</a></h2>
<section id="independent-component-analysis-ica-for-artifact-removal">
<h3>Independent Component Analysis (ICA) for Artifact Removal<a class="headerlink" href="#independent-component-analysis-ica-for-artifact-removal" title="Link to this heading">#</a></h3>
<p>Independent Component Analysis (ICA) is a method for estimating independent sources from mixed signals.</p>
<p><img alt="" src="https://scikit-learn.org/stable/_images/sphx_glr_plot_ica_blind_source_separation_001.png" /></p>
<p>In EEG, ICA is applied to identify and remove <strong>artifacts</strong> — signal components not generated by neural activity.</p>
<section id="common-types-of-eeg-artifacts">
<h4>Common Types of EEG Artifacts<a class="headerlink" href="#common-types-of-eeg-artifacts" title="Link to this heading">#</a></h4>
<p>Artifacts can be divided into <strong>physiological</strong> (originating from the human body but not the brain) and <strong>non-physiological/technical</strong> (external or recording-related):</p>
<ul class="simple">
<li><p><strong>Physiological artifacts</strong></p>
<ul>
<li><p>Ocular activity (blinks, saccades)</p></li>
<li><p>Muscle activity (EMG from face, jaw, or neck)</p></li>
<li><p>Cardiac activity (ECG leakage)</p></li>
<li><p>Perspiration (sweat-induced drifts)</p></li>
<li><p>Respiration (movement-related fluctuations)</p></li>
</ul>
</li>
<li><p><strong>Non-physiological / Technical artifacts</strong></p>
<ul>
<li><p>Electrode pops (sudden impedance changes)</p></li>
<li><p>Cable movement (mechanical noise)</p></li>
<li><p>Incorrect reference electrode placement</p></li>
<li><p>AC line noise (50/60 Hz) and electromagnetic interference</p></li>
<li><p>Gross body movements</p></li>
</ul>
</li>
</ul>
<p><strong>Further resources:</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.learningeeg.com/artifacts">Types of EEG artifacts</a></p></li>
<li><p><a class="reference external" href="https://www.bitbrain.com/blog/eeg-artifacts">Detecting artifacts with ICA</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">ICA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>At this stage, <strong>no computation is performed yet</strong> — we are only creating an <em>empty ICA object</em> with chosen parameters.<br />
Think of it as preparing a <strong>container</strong> where the following will be stored later:</p>
<ul class="simple">
<li><p><strong>Mixing matrix (A):</strong> how independent components (ICs) project back into EEG channels.</p></li>
<li><p><strong>Unmixing matrix (W):</strong> how EEG channels can be decomposed into independent components.</p></li>
<li><p><strong>IC time series and topographies</strong> after fitting.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">sample_1020</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting ICA to data using 19 channels (please be patient, this may take a while)
Selecting by number: 10 components
Fitting ICA took 0.2s.
</pre></div>
</div>
<div class="output text_html"><table class="table mne-repr-table">
    <tr>
        <th>Method</th>
        <td>fastica</td>
    </tr>
    <tr>
        <th>Fit parameters</th>
        <td>algorithm=parallel<br />fun=logcosh<br />fun_args=None<br />max_iter=1000<br /></td>
    </tr>
    <tr>
        <th>Fit</th>
        <td>17 iterations on raw data (20000 samples)</td>
    </tr>
    
    <tr>
        <th>ICA components</th>
        <td>10</td>
    </tr>
    <tr>
        <th>Available PCA components</th>
        <td>19</td>
    </tr>
    <tr>
        <th>Channel types</th>
        <td>eeg</td>
    </tr>
    <tr>
        <th>ICA components marked for exclusion</th>
        <td>&mdash;</td>
    </tr>
    
</table></div></div>
</div>
<p>The actual unmixing of EEG channels into independent components happens <strong>only when we call</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">sample_1020</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="explained-variance-ratio">
<h4>Explained variance ratio<a class="headerlink" href="#explained-variance-ratio" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>What it does: estimates how much of the EEG variability is explained by the selected ICs.</p></li>
<li><p>Why: a sanity check — to verify whether the chosen number of components is sufficient and whether important signal is preserved in reconstruction.</p></li>
<li><p>What to look for: values around ~0.95–0.99 for EEG are usually considered good.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">explained_var_ratio</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">get_explained_variance_ratio</span><span class="p">(</span><span class="n">sample_1020</span><span class="p">)</span>
<span class="k">for</span> <span class="n">channel_type</span><span class="p">,</span> <span class="n">ratio</span> <span class="ow">in</span> <span class="n">explained_var_ratio</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fraction of </span><span class="si">{</span><span class="n">channel_type</span><span class="si">}</span><span class="s2"> variance explained by all components: </span><span class="si">{</span><span class="n">ratio</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fraction of eeg variance explained by all components: 0.9738186007059333
</pre></div>
</div>
</div>
</div>
<p>Display the time courses of all independent components (IC000, IC001, …).
The colored bars at the top correspond to experimental segments T0/T1/T2.</p>
<p><strong>Why.</strong> To quickly spot repeating artifacts (blinks, EMG, ECG) and identify the intervals where they appear.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_sources</span><span class="p">(</span><span class="n">sample_1020</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Creating RawArray with float64 data, n_channels=10, n_times=20000
    Range : 0 ... 19999 =      0.000 ...   124.994 secs
Ready.
</pre></div>
</div>
<img alt="_images/bfa98ba97d206bf3301eca977b993056a66f13f3c08246d575b7b4fd202ab31e.png" src="_images/bfa98ba97d206bf3301eca977b993056a66f13f3c08246d575b7b4fd202ab31e.png" />
<img alt="_images/bfa98ba97d206bf3301eca977b993056a66f13f3c08246d575b7b4fd202ab31e.png" src="_images/bfa98ba97d206bf3301eca977b993056a66f13f3c08246d575b7b4fd202ab31e.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<p>What to look for.</p>
<ul class="simple">
<li><p>Large sharp peaks repeating in bursts → typically eye blinks (EOG).</p></li>
<li><p>High-frequency “roughness” → muscle activity (EMG).</p></li>
<li><p>Regular ~1 Hz waves → ECG.</p></li>
<li><p>Stable, smooth traces with rhythmic patterns → usually neural ICs.</p></li>
</ul>
<p>Typical conclusion. Select 1–3 “suspicious” ICs for detailed inspection in the next step.</p>
</div>
<p>Examine the scalp maps of IC contributions (mixing topographies)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_components</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e47819e4af1c9f90787deb202595131310bb1ebbb26575132bf0c4d60e4c4ec1.png" src="_images/e47819e4af1c9f90787deb202595131310bb1ebbb26575132bf0c4d60e4c4ec1.png" />
<img alt="_images/82fec00da5a8d229fca6b9d174bc230ecf692614e54e4fa23020118ab6795a2b.png" src="_images/82fec00da5a8d229fca6b9d174bc230ecf692614e54e4fa23020118ab6795a2b.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<p>Topography is the key to identifying the type of artifact:</p>
<ul class="simple">
<li><p>Symmetry across the forehead (Fp1/Fp2) → EOG/blinks.</p></li>
<li><p>Localized patches near the temples/cheeks → EMG.</p></li>
<li><p>Dipole-like pattern closer to the center/lower head → possible ECG.</p></li>
<li><p>Occipital dominance with alpha activity → often a neural IC.</p></li>
</ul>
<p>What to look for. Combine with the time-course analysis:
suspicious temporal dynamics + a “matching” artifact topography = a strong candidate for exclusion.</p>
</div>
<p>Analyze IC007 in detail: topography, time course, PSD, and variance across segments.</p>
<p><strong>Why.</strong> To distinguish neural components from artifact components using multiple criteria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_properties</span><span class="p">(</span><span class="n">sample_1020</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Using multitaper spectrum estimation with 7 DPSS windows
Not setting metadata
62 matching events found
No baseline correction applied
0 projection items activated
</pre></div>
</div>
<img alt="_images/eeaae85671ee9851feed3e78f23b5c54f25ff220844cbbf985141d784ac530a1.png" src="_images/eeaae85671ee9851feed3e78f23b5c54f25ff220844cbbf985141d784ac530a1.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;Figure size 700x600 with 6 Axes&gt;]
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<p>What to look for.</p>
<ul class="simple">
<li><p>Topography: is it physiologically plausible for brain/activity or for a specific artifact?</p></li>
<li><p>Spectrum (PSD): are there α (8–13 Hz) / β (13–30 Hz) peaks and an overall ~1/f falloff?
A narrow spike at 50/60 Hz → line noise; a broad high-frequency floor → EMG.</p></li>
<li><p>Time series: any large, sharp transients (suggestive of EOG/blinks)?</p></li>
<li><p>Variance across segments: many outliers (instability → more likely an artifact).</p></li>
</ul>
<p>Typical criterion. A “good” IC shows a 1/f decay, possible α/β peak, no large transients, and a plausible topography.</p>
</div>
<p>Temporarily zero out ICs with indices [0,1,2] and compare the signals before (red) and after (black).</p>
<p><strong>Why.</strong> To make sure that removing the selected ICs reduces artifacts without distorting useful neural dynamics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># blinks</span>
<span class="n">ica</span><span class="o">.</span><span class="n">plot_overlay</span><span class="p">(</span><span class="n">sample_1020</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying ICA to Raw instance
    Transforming to ICA space (10 components)
    Zeroing out 3 ICA components
    Projecting back using 19 PCA components
</pre></div>
</div>
<img alt="_images/024585c921ee84fcbaa72424ef89ffb6f8e7a5a6500111c8bc9ccf7f20a5b95b.png" src="_images/024585c921ee84fcbaa72424ef89ffb6f8e7a5a6500111c8bc9ccf7f20a5b95b.png" />
<img alt="_images/024585c921ee84fcbaa72424ef89ffb6f8e7a5a6500111c8bc9ccf7f20a5b95b.png" src="_images/024585c921ee84fcbaa72424ef89ffb6f8e7a5a6500111c8bc9ccf7f20a5b95b.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<p>What to look for.</p>
<ul class="simple">
<li><p>Blink/EMG peaks should be clearly reduced.</p></li>
<li><p>Physiological rhythms (e.g., alpha) should not disappear globally.</p></li>
</ul>
<p>Important. This is only a preview — the raw data have not been modified yet.</p>
</div>
<p>Examine how excluding ICs [0,1] affects a specific channel (F3).</p>
<p><strong>Why.</strong> To check the local effect in regions where artifacts are most noticeable (often frontal channels).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_overlay</span><span class="p">(</span><span class="n">sample_1020</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">picks</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying ICA to Raw instance
    Transforming to ICA space (10 components)
    Zeroing out 2 ICA components
    Projecting back using 19 PCA components
</pre></div>
</div>
<img alt="_images/184e4fe22c7a9bc7464685c57534e20f710f91870211e585e433b7c141e4d19b.png" src="_images/184e4fe22c7a9bc7464685c57534e20f710f91870211e585e433b7c141e4d19b.png" />
<img alt="_images/184e4fe22c7a9bc7464685c57534e20f710f91870211e585e433b7c141e4d19b.png" src="_images/184e4fe22c7a9bc7464685c57534e20f710f91870211e585e433b7c141e4d19b.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<p>What to look for. Reduction of spikes/“flickering” in F3 while preserving the overall shape of the response.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>ICA000 (blue frontal component)</strong></p>
<ul class="simple">
<li><p>Topography: maximum strictly at the forehead, symmetric over Fp1/Fp2.</p></li>
<li><p>Time course (from your ica.plot_sources): rare, very large sharp peaks.</p></li>
<li><p>Spectrum: dominance of low frequencies, without regularity.</p></li>
</ul>
<p>👉 This looks  like EOG (blinks).</p>
<p><strong>ICA001 (red “filled” component)</strong></p>
<ul class="simple">
<li><p>Topography: broader and deeper distribution, not only frontal but also extending downward/central.</p></li>
<li><p>Time course: peaks appear more regular, repeating roughly every ~1 second.</p></li>
<li><p>Spectrum: expected strong power around ~1–1.5 Hz.</p></li>
</ul>
<p>👉 This is more consistent with ECG (heartbeat).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_1020_clr</span> <span class="o">=</span> <span class="n">sample_1020</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sample_1020_clr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying ICA to Raw instance
    Transforming to ICA space (10 components)
    Zeroing out 2 ICA components
    Projecting back using 19 PCA components
</pre></div>
</div>
<div class="output text_html"><script type="text/javascript">
    // must be `var` (not `const`) because this can get embedded multiple times on a page
var toggleVisibility = (className) => {

    const elements = document.querySelectorAll(`.${className}`);

    elements.forEach(element => {
        if (element.classList.contains("mne-repr-section-header")) {
            return  // Don't collapse the section header row
        }
        element.classList.toggle("mne-repr-collapsed");
    });

    // trigger caret to rotate
    var sel = `.mne-repr-section-header.${className} > th.mne-repr-section-toggle > button`;
    const button = document.querySelector(sel);
    button.classList.toggle("collapsed");

    // adjust tooltip
    sel = `tr.mne-repr-section-header.${className}`;
    const secHeadRow = document.querySelector(sel);
    secHeadRow.classList.toggle("collapsed");
    secHeadRow.title = secHeadRow.title === "Hide section" ? "Show section" : "Hide section";
}
</script>

<style type="text/css">
    /*
Styles in this section apply both to the sphinx-built website docs and to notebooks
rendered in an IDE or in Jupyter. In our web docs, styles here are complemented by
doc/_static/styles.css and other CSS files (e.g. from the sphinx theme, sphinx-gallery,
or bootstrap). In IDEs/Jupyter, those style files are unavailable, so only the rules in
this file apply (plus whatever default styling the IDE applies).
*/
.mne-repr-table {
    display: inline;  /* prevent using full container width */
}
.mne-repr-table tr.mne-repr-section-header > th {
    padding-top: 1rem;
    text-align: left;
    vertical-align: middle;
}
.mne-repr-section-toggle > button {
    all: unset;
    display: block;
    height: 1rem;
    width: 1rem;
}
.mne-repr-section-toggle > button > svg {
    height: 60%;
}

/* transition (rotation) effects on the collapser button */
.mne-repr-section-toggle > button.collapsed > svg {
    transition: 0.1s ease-out;
    transform: rotate(-90deg);
}
.mne-repr-section-toggle > button:not(.collapsed) > svg {
    transition: 0.1s ease-out;
    transform: rotate(0deg);
}

/* hide collapsed table rows */
.mne-repr-collapsed {
    display: none;
}


@layer {
    /*
    Selectors in a `@layer` will always be lower-precedence than selectors outside the
    layer. So even though e.g. `div.output_html` is present in the sphinx-rendered
    website docs, the styles here won't take effect there as long as some other rule
    somewhere in the page's CSS targets the same element.

    In IDEs or Jupyter notebooks, though, the CSS files from the sphinx theme,
    sphinx-gallery, and bootstrap are unavailable, so these styles will apply.

    Notes:

    - the selector `.accordion-body` is for MNE Reports
    - the selector `.output_html` is for VSCode's notebook interface
    - the selector `.jp-RenderedHTML` is for Jupyter notebook
    - variables starting with `--theme-` are VSCode-specific.
    - variables starting with `--jp-` are Jupyter styles, *some of which* are also
      available in VSCode. Here we try the `--theme-` variable first, then fall back to
      the `--jp-` ones.
    */
    .mne-repr-table {
        --mne-toggle-color: var(--theme-foreground, var(--jp-ui-font-color1));
        --mne-button-bg-color: var(--theme-button-background, var(--jp-info-color0, var(--jp-content-link-color)));
        --mne-button-fg-color: var(--theme-button-foreground, var(--jp-ui-inverse-font-color0, var(--jp-editor-background)));
        --mne-button-hover-bg-color: var(--theme-button-hover-background, var(--jp-info-color1));
        --mne-button-radius: var(--jp-border-radius, 0.25rem);
    }
    /* chevron position/alignment; in VSCode it looks ok without adjusting */
    .accordion-body .mne-repr-section-toggle > button,
    .jp-RenderedHTML .mne-repr-section-toggle > button {
        padding: 0 0 45% 25% !important;
    }
    /* chevron color; MNE Report doesn't have light/dark mode */
    div.output_html .mne-repr-section-toggle > button > svg > path,
    .jp-RenderedHTML .mne-repr-section-toggle > button > svg > path {
        fill: var(--mne-toggle-color);
    }
    .accordion-body .mne-ch-names-btn,
    div.output_html .mne-ch-names-btn,
    .jp-RenderedHTML .mne-ch-names-btn {
        -webkit-border-radius: var(--mne-button-radius);
        -moz-border-radius: var(--mne-button-radius);
        border-radius: var(--mne-button-radius);
        border: none;
        background-image: none;
        background-color: var(--mne-button-bg-color);
        color: var(--mne-button-fg-color);
        font-size: inherit;
        min-width: 1.5rem;
        padding: 0.25rem;
        text-align: center;
        text-decoration: none;
    }
    .accordion-body .mne-ch-names-btn:hover,
    div.output_html .mne.ch-names-btn:hover,
    .jp-RenderedHTML .mne-ch-names-btn:hover {
        background-color: var(--mne-button-hover-bg-color);
        text-decoration: underline;
    }
    .accordion-body .mne-ch-names-btn:focus-visible,
    div.output_html .mne-ch-names-btn:focus-visible,
    .jp-RenderedHTML .mne-ch-names-btn:focus-visible {
        outline: 0.1875rem solid var(--mne-button-bg-color) !important;
        outline-offset: 0.1875rem !important;
    }
}
</style>



<table class="table mne-repr-table">
    







<tr class="mne-repr-section-header general-a8a609c5-8ce6-45c4-8fb7-07dde8905562"
     title="Hide section" 
    onclick="toggleVisibility('general-a8a609c5-8ce6-45c4-8fb7-07dde8905562')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>General</strong>
    </th>
</tr>


<tr class="repr-element general-a8a609c5-8ce6-45c4-8fb7-07dde8905562 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Filename(s)</td>
    <td>
        
        S003R03.edf
        
        
    </td>
</tr>

<tr class="repr-element general-a8a609c5-8ce6-45c4-8fb7-07dde8905562 ">
    <td class="mne-repr-section-toggle"></td>
    <td>MNE object type</td>
    <td>RawEDF</td>
</tr>
<tr class="repr-element general-a8a609c5-8ce6-45c4-8fb7-07dde8905562 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Measurement date</td>
    
    <td>2009-08-12 at 16:15:00 UTC</td>
    
</tr>
<tr class="repr-element general-a8a609c5-8ce6-45c4-8fb7-07dde8905562 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Participant</td>
    
    
    <td>X</td>
    
    
</tr>
<tr class="repr-element general-a8a609c5-8ce6-45c4-8fb7-07dde8905562 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Experimenter</td>
    
    <td>Unknown</td>
    
</tr>
    







<tr class="mne-repr-section-header acquisition-5b771515-e60b-4359-b34f-3dc234726907"
     title="Hide section" 
    onclick="toggleVisibility('acquisition-5b771515-e60b-4359-b34f-3dc234726907')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Acquisition</strong>
    </th>
</tr>


<tr class="repr-element acquisition-5b771515-e60b-4359-b34f-3dc234726907 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Duration</td>
    <td>00:02:05 (HH:MM:SS)</td>
</tr>








<tr class="repr-element acquisition-5b771515-e60b-4359-b34f-3dc234726907 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Sampling frequency</td>
    <td>160.00 Hz</td>
</tr>


<tr class="repr-element acquisition-5b771515-e60b-4359-b34f-3dc234726907 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Time points</td>
    <td>20,000</td>
</tr>


    







<tr class="mne-repr-section-header channels-734330c2-f1a9-423d-8468-5de77ed63902"
     title="Hide section" 
    onclick="toggleVisibility('channels-734330c2-f1a9-423d-8468-5de77ed63902')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Channels</strong>
    </th>
</tr>


    
<tr class="repr-element channels-734330c2-f1a9-423d-8468-5de77ed63902 ">
    <td class="mne-repr-section-toggle"></td>
    <td>EEG</td>
    <td>
        <button class="mne-ch-names-btn sd-sphinx-override sd-btn sd-btn-info sd-text-wrap sd-shadow-sm" onclick="alert('Good EEG:\n\nFp1, Fp2, F7, F3, F4, Fz, F8, T7, C3, Cz, C4, T8, P7, P3, Pz, P4, P8, O1, O2')" title="(Click to open in popup)&#13;&#13;Fp1, Fp2, F7, F3, F4, Fz, F8, T7, C3, Cz, C4, T8, P7, P3, Pz, P4, P8, O1, O2">
            19
        </button>

        
    </td>
</tr>


<tr class="repr-element channels-734330c2-f1a9-423d-8468-5de77ed63902 ">
    <td class="mne-repr-section-toggle"></td>
    <td>Head & sensor digitization</td>
    
    <td>22 points</td>
    
</tr>
    







<tr class="mne-repr-section-header filters-182241c8-a827-439e-bea0-18185eeb291b"
     title="Hide section" 
    onclick="toggleVisibility('filters-182241c8-a827-439e-bea0-18185eeb291b')">
    <th class="mne-repr-section-toggle">
        <button >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>
        </button>
    </th>
    <th colspan="2">
        <strong>Filters</strong>
    </th>
</tr>


<tr class="repr-element filters-182241c8-a827-439e-bea0-18185eeb291b ">
    <td class="mne-repr-section-toggle"></td>
    <td>Highpass</td>
    <td>1.00 Hz</td>
</tr>


<tr class="repr-element filters-182241c8-a827-439e-bea0-18185eeb291b ">
    <td class="mne-repr-section-toggle"></td>
    <td>Lowpass</td>
    <td>50.00 Hz</td>
</tr>


</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the ICA to remove the chosen components from the data</span>
<span class="n">cleaned_eeg</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sample_1020_clr</span><span class="p">)</span>

<span class="c1"># Plot the cleaned signals after excluding the chosen artifacts</span>
<span class="n">cleaned_eeg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_channels</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scalings</span><span class="o">=</span><span class="mf">3e-4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying ICA to Raw instance
    Transforming to ICA space (10 components)
    Zeroing out 2 ICA components
    Projecting back using 19 PCA components
</pre></div>
</div>
<img alt="_images/f1db59bf6295c1c7683fddea4388ab0210c30d00940dd2f97eb9f0abf829b69f.png" src="_images/f1db59bf6295c1c7683fddea4388ab0210c30d00940dd2f97eb9f0abf829b69f.png" />
<img alt="_images/f1db59bf6295c1c7683fddea4388ab0210c30d00940dd2f97eb9f0abf829b69f.png" src="_images/f1db59bf6295c1c7683fddea4388ab0210c30d00940dd2f97eb9f0abf829b69f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">sample_1020_clr</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span>  <span class="n">tmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;eeg&#39;</span><span class="p">:</span> <span class="mf">600e-6</span><span class="p">},</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not setting metadata
30 matching events found
Applying baseline correction (mode: mean)
0 projection items activated
Using data from preloaded Raw for 30 events and 209 original time points ...
1 bad epochs dropped
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T0</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">evoked_T1</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">evoked_T2</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bf02d69092f6f5eb5ec3d4118c76c5f3b8a1642094853841e0fcce88facbe871.png" src="_images/bf02d69092f6f5eb5ec3d4118c76c5f3b8a1642094853841e0fcce88facbe871.png" />
<img alt="_images/bf02d69092f6f5eb5ec3d4118c76c5f3b8a1642094853841e0fcce88facbe871.png" src="_images/bf02d69092f6f5eb5ec3d4118c76c5f3b8a1642094853841e0fcce88facbe871.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f8aac711a96f928dc1e945fc4c1262875f78b7cc4109d65535b685e15d20f5d5.png" src="_images/f8aac711a96f928dc1e945fc4c1262875f78b7cc4109d65535b685e15d20f5d5.png" />
<img alt="_images/f8aac711a96f928dc1e945fc4c1262875f78b7cc4109d65535b685e15d20f5d5.png" src="_images/f8aac711a96f928dc1e945fc4c1262875f78b7cc4109d65535b685e15d20f5d5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fb37edb52adbcb3515b40f49e78e66ef6bf851a4eba29cd4e07bc56e67bb74f6.png" src="_images/fb37edb52adbcb3515b40f49e78e66ef6bf851a4eba29cd4e07bc56e67bb74f6.png" />
<img alt="_images/fb37edb52adbcb3515b40f49e78e66ef6bf851a4eba29cd4e07bc56e67bb74f6.png" src="_images/fb37edb52adbcb3515b40f49e78e66ef6bf851a4eba29cd4e07bc56e67bb74f6.png" />
</div>
</div>
</section>
</section>
<section id="global-field-power-gfp">
<h3>Global Field Power (GFP)<a class="headerlink" href="#global-field-power-gfp" title="Link to this heading">#</a></h3>
<p>It is useful to look at <strong>Global Field Power (GFP)</strong>.<br />
GFP summarizes how much the EEG signals vary across all electrodes at each time point.</p>
<ul class="simple">
<li><p>If all sensors record the <strong>same value</strong>, there is no spatial variability → <strong>GFP = 0</strong>.</p></li>
<li><p>If the sensors differ strongly, GFP increases → <strong>GFP &gt; 0</strong>.</p></li>
</ul>
<p>In practice, <strong>GFP peaks highlight moments of strong, widespread brain activity</strong> (for example, event-related potentials).<br />
Therefore, GFP is often used as a quick overview to identify time periods that may be worth a closer look.</p>
<p>Let’s plot a comparison of averaged evoked responses (ERPs) across the three conditions:</p>
<ul class="simple">
<li><p>rest (T0) — resting state,</p></li>
<li><p>left (T1) — imagination/movement of the left hand,</p></li>
<li><p>right (T2) — imagination/movement of the right hand.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_compare_evokeds</span><span class="p">(</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">rest</span><span class="o">=</span><span class="n">evoked_T0</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">evoked_T1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">evoked_T2</span><span class="p">),</span>
    <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
    <span class="n">show_sensors</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>combining channels using GFP (eeg channels)
combining channels using GFP (eeg channels)
combining channels using GFP (eeg channels)
</pre></div>
</div>
<img alt="_images/fe9a8d52fda5a5bca112288841dfdfb3787249c6cc98d96fbf6b561072e89957.png" src="_images/fe9a8d52fda5a5bca112288841dfdfb3787249c6cc98d96fbf6b561072e89957.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;Figure size 800x600 with 2 Axes&gt;]
</pre></div>
</div>
</div>
</div>
<section id="visualizing-evoked-responses-in-more-detail">
<h4>Visualizing Evoked responses in more detail<a class="headerlink" href="#visualizing-evoked-responses-in-more-detail" title="Link to this heading">#</a></h4>
<p>To explore evoked responses, MNE provides two useful plotting methods:</p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">plot_joint</span></code></strong></p>
<ul class="simple">
<li><p>Combines the ERP time course with <strong>topographic scalp maps</strong>.</p></li>
<li><p>On the left: the ERP curve across time.</p></li>
<li><p>On the right: scalp maps showing the spatial distribution of activity at specific time points.</p></li>
<li><p>👉 This helps to connect <strong>when</strong> something happens with <strong>where</strong> on the scalp it is strongest.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">plot_topomap</span></code></strong></p>
<ul class="simple">
<li><p>Shows only the scalp maps at selected time points.</p></li>
<li><p>Useful if we want to focus on the <strong>spatial distribution</strong> of brain activity.</p></li>
</ul>
</li>
</ol>
</section>
<section id="how-to-choose-the-time-points">
<h4>How to choose the time points<a class="headerlink" href="#how-to-choose-the-time-points" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>We can <strong>set them manually</strong>, e.g. <code class="docutils literal notranslate"><span class="pre">times=[0.1,</span> <span class="pre">0.3,</span> <span class="pre">0.5]</span></code> (in seconds).</p></li>
<li><p>Or we can let MNE choose automatically with <code class="docutils literal notranslate"><span class="pre">times='peaks'</span></code>.</p>
<ul>
<li><p>In this case, MNE looks at the <strong>Global Field Power (GFP)</strong> curve.</p></li>
<li><p>GFP measures how strong and synchronized the brain’s response is across the scalp.</p></li>
<li><p>MNE finds the <strong>3 strongest peaks</strong> in GFP.</p></li>
<li><p>These peaks usually correspond to meaningful ERP components (like P100, N200, P300).</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T0</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">()</span>
<span class="n">evoked_T0</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No projector specified for this dataset. Please consider the method self.add_proj.
</pre></div>
</div>
<img alt="_images/c121282c7f80935d3bf75503cdf8f541c4e17b5a4195133cac3219b2332edf6d.png" src="_images/c121282c7f80935d3bf75503cdf8f541c4e17b5a4195133cac3219b2332edf6d.png" />
<img alt="_images/dc1150154889ccf5aee7e252bfafbfd0efcb42beb224fa4b06c17d79c97493ad.png" src="_images/dc1150154889ccf5aee7e252bfafbfd0efcb42beb224fa4b06c17d79c97493ad.png" />
<img alt="_images/e2e3d4d169529f6337f42ffc1c5ac5b040bd7196c1fb767700af855d4204c75c.png" src="_images/e2e3d4d169529f6337f42ffc1c5ac5b040bd7196c1fb767700af855d4204c75c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T1</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">()</span>
<span class="n">evoked_T1</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No projector specified for this dataset. Please consider the method self.add_proj.
</pre></div>
</div>
<img alt="_images/8cd0488818bfdc7e16c3a31544e36faf21a60035cb8b6e5dbd8b7097541b3216.png" src="_images/8cd0488818bfdc7e16c3a31544e36faf21a60035cb8b6e5dbd8b7097541b3216.png" />
<img alt="_images/5c8c9bb747e117ca9c37a5038426e7ecf1220fe4f811e7e8f66941f4c7aa6860.png" src="_images/5c8c9bb747e117ca9c37a5038426e7ecf1220fe4f811e7e8f66941f4c7aa6860.png" />
<img alt="_images/ad892c3e8892ab815a55e1d84ff3172a59215ed5028c7a6a5e9404ce5866f91c.png" src="_images/ad892c3e8892ab815a55e1d84ff3172a59215ed5028c7a6a5e9404ce5866f91c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evoked_T2</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">()</span>
<span class="n">evoked_T2</span><span class="o">.</span><span class="n">plot_topomap</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No projector specified for this dataset. Please consider the method self.add_proj.
</pre></div>
</div>
<img alt="_images/1ada9e9f7a5346863ad5427b214b5e48259744d4c9559d3438da393e016bae96.png" src="_images/1ada9e9f7a5346863ad5427b214b5e48259744d4c9559d3438da393e016bae96.png" />
<img alt="_images/34ed89f50f84cc2f3b588547cd02ffc2bae67781c3208a13df117a8bd62dff80.png" src="_images/34ed89f50f84cc2f3b588547cd02ffc2bae67781c3208a13df117a8bd62dff80.png" />
<img alt="_images/bb5b9c114f7cc260547babcce2a4cce6a2b4c7297f1ecc3550f699d7daff5471.png" src="_images/bb5b9c114f7cc260547babcce2a4cce6a2b4c7297f1ecc3550f699d7daff5471.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<p>What to look for.</p>
<ul class="simple">
<li><p>On the <strong>ERP time course</strong>: check where the peaks occur.</p></li>
<li><p>On the <strong>topomaps</strong>: see which brain regions (frontal, central, parietal, occipital) are most active at those times.</p></li>
</ul>
</div>
</section>
</section>
<section id="functional-connectivity-in-eeg">
<h3>Functional Connectivity in EEG<a class="headerlink" href="#functional-connectivity-in-eeg" title="Link to this heading">#</a></h3>
<p>So far, we have mainly looked at <strong>local activity</strong> of the brain:</p>
<ul class="simple">
<li><p>ERPs show the average response over time in each condition.</p></li>
<li><p>Topomaps reveal where on the scalp the strongest signals occur.</p></li>
<li><p>GFP summarizes overall synchrony across sensors.</p></li>
</ul>
<p>But brain function is not only about <strong>local activations</strong>.<br />
It also depends on <strong>interactions between different brain regions</strong> — how signals from one area are related to signals from another.<br />
This is called <strong>functional connectivity</strong>.</p>
<section id="spectral-connectivity">
<h4>Spectral Connectivity<a class="headerlink" href="#spectral-connectivity" title="Link to this heading">#</a></h4>
<p>Connectivity is often estimated in the <strong>frequency domain</strong>:</p>
<ul class="simple">
<li><p>We check if oscillations in two channels are synchronized at certain frequencies.</p></li>
<li><p>One popular measure is <strong>coherence (<code class="docutils literal notranslate"><span class="pre">coh</span></code>)</strong>, which quantifies how consistently two signals oscillate together.</p></li>
<li><p>High coherence means the two brain regions are likely interacting or sharing information.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conn_T1</span> <span class="o">=</span> <span class="n">mne_connectivity</span><span class="o">.</span><span class="n">spectral_connectivity_epochs</span><span class="p">(</span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;coh&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Adding metadata with 3 columns
Connectivity computation...
only using indices for lower-triangular matrix
    computing connectivity for 171 connections
    using t=-0.500s..0.800s for estimation (209 points)
    frequencies: 4.6Hz..79.6Hz (99 points)
    Using multitaper spectrum estimation with 7 DPSS windows
    the following metrics will be computed: Coherence
    computing cross-spectral density for epoch 1
    computing cross-spectral density for epoch 2
    computing cross-spectral density for epoch 3
    computing cross-spectral density for epoch 4
    computing cross-spectral density for epoch 5
    computing cross-spectral density for epoch 6
    computing cross-spectral density for epoch 7
    assembling connectivity matrix
[Connectivity computation done]
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<p>What to look for.</p>
<ul class="simple">
<li><p>Which pairs of channels show the highest coherence?</p></li>
<li><p>In which frequency bands (e.g., alpha, beta) is connectivity strongest?</p></li>
<li><p>How does connectivity differ between conditions (rest vs. left vs. right)?</p></li>
</ul>
</div>
<p>This function transforms the connectivity matrix (NxN) into a graph on the scalp, making it easy to see which brain areas work synchronously.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_topomap_connectivity_2d</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_values</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_names</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots connectivity-like data in 2d</span>

<span class="sd">    Drawing every pair of channels will likely make a mess</span>
<span class="sd">    There are two options to avoid it:</span>
<span class="sd">    - provide picks</span>
<span class="sd">    - provide specific pairs of channels to draw</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># get positions</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">topomap</span><span class="o">.</span><span class="n">_prepare_topomap_plot</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;eeg&#39;</span><span class="p">);</span>

<span class="c1">#     if picks is None and pairs is None:</span>
<span class="c1">#         picks = info.ch_names</span>

    <span class="n">ch_names_lower</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">ch_names</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">picks</span><span class="p">:</span>
        <span class="n">picks_lower</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">picks</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">pairs</span><span class="p">:</span>
        <span class="n">pairs_lower</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([</span><span class="n">ch1</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">ch2</span><span class="o">.</span><span class="n">lower</span><span class="p">()]))</span> <span class="k">for</span> <span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span>

    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx1</span><span class="p">,</span> <span class="n">ch1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ch_names_lower</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">idx2</span><span class="p">,</span> <span class="n">ch2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ch_names_lower</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ch1</span> <span class="o">&gt;=</span> <span class="n">ch2</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">picks</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ch1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">picks_lower</span> <span class="ow">or</span> <span class="n">ch2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">picks_lower</span><span class="p">):</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="n">pairs</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pairs_lower</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">((</span>
                <span class="n">pos</span><span class="p">[</span><span class="n">idx1</span><span class="p">],</span>
                <span class="n">pos</span><span class="p">[</span><span class="n">idx2</span><span class="p">],</span>
                <span class="n">con</span><span class="p">[</span><span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span><span class="p">]</span>
            <span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No pairs to plot&#39;</span><span class="p">)</span>

    <span class="n">con_to_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">con_to_plot</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">con_to_plot</span><span class="p">,</span> <span class="mi">98</span><span class="p">)</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cm</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">diverging_palette</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
    <span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_sensors</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">show_names</span><span class="o">=</span><span class="n">show_names</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">vmin</span><span class="p">)</span> <span class="ow">and</span>  <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">vmax</span><span class="p">):</span>
          <span class="n">rgba_color</span> <span class="o">=</span> <span class="n">cm</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">rgba_color</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">show_values</span><span class="p">:</span>
              <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                      <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                      <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<p>What we can  see in the figure:</p>
<ul class="simple">
<li><p>Black dots → electrode positions (Fp1, Fp2, Cz, O1, etc.).</p></li>
<li><p>Lines between them → coherence values.</p></li>
<li><p>Red/thicker lines → stronger connections.</p></li>
<li><p>Blue/thinner lines → weaker connections.</p></li>
</ul>
<p>Compute spectral connectivity (coherence) for each condition</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conn_T0</span> <span class="o">=</span> <span class="n">mne_connectivity</span><span class="o">.</span><span class="n">spectral_connectivity_epochs</span><span class="p">(</span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;coh&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">conn_T1</span> <span class="o">=</span> <span class="n">mne_connectivity</span><span class="o">.</span><span class="n">spectral_connectivity_epochs</span><span class="p">(</span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;coh&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">conn_T2</span> <span class="o">=</span> <span class="n">mne_connectivity</span><span class="o">.</span><span class="n">spectral_connectivity_epochs</span><span class="p">(</span><span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;coh&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>For rest (T0), left hand movement/imagery (T1), and right hand movement/imagery (T2), we compute coherence between all pairs of EEG channels.</p></li>
<li><p>Output: a 3D matrix → (channels × channels × frequencies).</p></li>
</ul>
<p>Check the shape of the result</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conn_T0</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(19, 19, 99)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>19 EEG channels × 19 EEG channels × 99 frequency bins.</p></li>
<li><p>This is the full coherence tensor across the scalp.</p></li>
</ul>
<p>Average across frequencies (1–50 Hz)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conn_T0_all</span> <span class="o">=</span> <span class="n">conn_T0</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">conn_T0_all</span> <span class="o">=</span> <span class="n">conn_T0_all</span> <span class="o">+</span> <span class="n">conn_T0_all</span><span class="o">.</span><span class="n">T</span>

<span class="n">conn_T1_all</span> <span class="o">=</span> <span class="n">conn_T1</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">conn_T1_all</span> <span class="o">=</span> <span class="n">conn_T1_all</span> <span class="o">+</span> <span class="n">conn_T1_all</span><span class="o">.</span><span class="n">T</span>

<span class="n">conn_T2_all</span> <span class="o">=</span> <span class="n">conn_T2</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">conn_T2_all</span> <span class="o">=</span> <span class="n">conn_T2_all</span> <span class="o">+</span> <span class="n">conn_T2_all</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Select frequencies from 1 to 50 Hz.</p></li>
<li><p>Average coherence values over this range → one mean connectivity matrix (19×19).</p></li>
<li><p>Add its transpose to make it symmetric (since coherence is theoretically symmetric).</p></li>
</ul>
<p>The same procedure is applied for T1 and T2.</p>
<p>Visualize the connectivity on the scalp</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_topomap_connectivity_2d</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">conn_T0_all</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">epochs</span><span class="o">.</span><span class="n">ch_names</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4ee8a207daebdfbb79b912751cbd4571e9f68679550993533c5cdddf43ed75b6.png" src="_images/4ee8a207daebdfbb79b912751cbd4571e9f68679550993533c5cdddf43ed75b6.png" />
</div>
</div>
<ul class="simple">
<li><p>Take the coherence matrix (e.g., for T0).</p></li>
<li><p>Plot electrodes as nodes (black dots) and coherence values as edges (lines).</p></li>
<li><p>Only strong connections above 0.5 are displayed:</p>
<ul>
<li><p>red/thicker lines = strong coherence,</p></li>
<li><p>blue/thinner lines = weaker coherence.</p></li>
</ul>
</li>
</ul>
<div class="dropdown admonition">
<p class="admonition-title">What we learn:</p>
<p>What to look for.</p>
<ul class="simple">
<li><p>When plotting connectivity for <strong>T1 (left hand)</strong> and <strong>T2 (right hand)</strong>, adjust the parameter <code class="docutils literal notranslate"><span class="pre">vmin</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vmin</span></code> defines the <strong>minimum connectivity value</strong> shown on the color scale.</p></li>
<li><p>By increasing <code class="docutils literal notranslate"><span class="pre">vmin</span></code>, only the <strong>strongest connections</strong> are displayed, making it easier to see condition-specific differences.</p></li>
</ul>
<p>How to interpret.</p>
<ul class="simple">
<li><p>Compare the <strong>patterns of strong links</strong> (red edges) between T1 and T2.</p></li>
<li><p>Focus on whether the central electrodes (C3/C4) show stronger coherence with other areas depending on the imagined hand movement.</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_topomap_connectivity_2d</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">conn_T1_all</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">epochs</span><span class="o">.</span><span class="n">ch_names</span><span class="p">,</span>  <span class="n">show_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fdd1b7f7d02f2461106a9011744543fc488fb67ef0ca9544eaf5b64e6a66074c.png" src="_images/fdd1b7f7d02f2461106a9011744543fc488fb67ef0ca9544eaf5b64e6a66074c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_topomap_connectivity_2d</span><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">conn_T2_all</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">epochs</span><span class="o">.</span><span class="n">ch_names</span><span class="p">,</span>  <span class="n">show_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d071a8b0fd7d1500cae6222e454c916a4e6f209c027e526b5933ce21b325cbe2.png" src="_images/d071a8b0fd7d1500cae6222e454c916a4e6f209c027e526b5933ce21b325cbe2.png" />
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Beta-band coherence analysis</p>
<p><strong>What we do.</strong></p>
<ul class="simple">
<li><p>Compute functional connectivity (coherence) in the <strong>beta band (12–20 Hz)</strong>.</p></li>
<li><p>Focus only on <strong>selected pairs of channels</strong> instead of plotting all-to-all connections.</p></li>
<li><p>Use the helper function <code class="docutils literal notranslate"><span class="pre">plot_topomap_connectivity_2d</span></code> with the argument<br />
<code class="docutils literal notranslate"><span class="pre">pairs=[('F7',</span> <span class="pre">'F4'),</span> <span class="pre">('O2',</span> <span class="pre">'T7'),</span> <span class="pre">...]</span></code>.</p></li>
</ul>
<p><strong>Why.</strong></p>
<ul class="simple">
<li><p>Beta activity (12–20 Hz) is strongly linked to the <strong>motor cortex</strong>.</p></li>
<li><p>Coherence in this band reflects how well different brain regions are synchronized during motor tasks.</p></li>
<li><p>By restricting to 5–10 meaningful pairs, we highlight the most relevant motor and control connections without clutter.</p></li>
</ul>
<p><strong>What to look for.</strong></p>
<ul class="simple">
<li><p>Stronger coherence between <strong>C3/Cz/C4</strong> and frontal/parietal regions → motor network engagement.</p></li>
<li><p>Differences between <strong>T1 (left hand)</strong> and <strong>T2 (right hand)</strong> conditions, reflecting lateralized motor control.</p></li>
<li><p>Red/thicker lines indicate strong synchronization; blue/thinner lines indicate weaker links.</p></li>
</ul>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1">Part 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-loading-reading-physionet-eeg-motor-movement-imagery-for-demonstration-we-use-a-single-recording-s003r03-edf-event">Data: loading/reading PhysioNet EEG Motor Movement/Imagery. For demonstration, we use a single recording: S003R03.edf (+ .event).</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#channel-selection-and-adding-a-montage">Channel selection and adding a montage</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mne-channels-make-standard-montage-standard-1020">mne.channels.make_standard_montage(‘standard_1020’)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#raw-1020-set-montage-mont">raw_1020.set_montage(mont)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-and-cleaning-eeg-spectrum">Checking and Cleaning EEG Spectrum</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#main-signal-energy-is-concentrated-in-low-frequencies-10-hz">1. Main signal energy is concentrated in low frequencies (&lt;10 Hz)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#weak-50-60-hz-peak">2. Weak 50/60-Hz peak</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#band-pass-filtering">Band-pass filtering</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-eeg-signals">Plot EEG signals</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#event-detection-triggers-vs-annotations">Event Detection: Triggers vs Annotations</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-it-matters-for-your-data">Why it matters for your data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-epochs">Creating Epochs</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#peak-to-peak-amplitude-qc">Peak-to-peak amplitude (QC)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#psd-of-epochs">PSD of epochs</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#averaging-evoked-responses">Averaging (Evoked responses)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2">Part 2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-component-analysis-ica-for-artifact-removal">Independent Component Analysis (ICA) for Artifact Removal</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#common-types-of-eeg-artifacts">Common Types of EEG Artifacts</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#explained-variance-ratio">Explained variance ratio</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#global-field-power-gfp">Global Field Power (GFP)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-evoked-responses-in-more-detail">Visualizing Evoked responses in more detail</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-choose-the-time-points">How to choose the time points</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-connectivity-in-eeg">Functional Connectivity in EEG</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-connectivity">Spectral Connectivity</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nadezhda Alsahanova, Aleksandra Beliaeva
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>