
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GLM: 1st-level Analysis &#8212; Neuroimaging and Machine Learning for Biomedicine</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myadmonitions.css?v=0009bf62" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'seminars6_7/IndividualAnalysis';</script>
    <link rel="icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Neuroimaging and Machine Learning for Biomedicine - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Neuroimaging and Machine Learning for Biomedicine - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to the Neuroimaging and Machine Learning for Biomedicine coursebook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../bio/intro_links.html">Links</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1AM67Sd37J0hIJ-kLyzAZRm8op_JcUQ9b?usp=sharing">Intro to shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar1/Seminar1_python_colab.html">How to work with Python</a></li>




<li class="toctree-l1"><a class="reference internal" href="../seminar1/Seminar1_ML.html">Intro to ML</a></li>

















<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1jkf4Jt0QvDz2O7UoZ-sZAi0V0oke5Yju?usp=sharing">Machine learning fundamentals on medical data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar1/00_pytorch_fundamentals.html">Pytorch fundamentals</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1q0XncKq2y_wHLXJaxhjfBCDGHABmzrjM/view?usp=sharing">Intro to computer vision</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminar 1. Opening Seminar</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../seminar1/intro.html">Lecture Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar1/opening_seminar.html">Motivation &amp; Overview</a></li>










</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminars 2-3. Working with EEG</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../seminars2_3/seminar1_working_with_eeg_ipynb_.html">Seminars 2 and 3. EEG analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminars 4-5. Working with MRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../seminar4/docker.html">Preparation to Seminar 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar4/seminar4_1_mri.html">Seminar 4.1. MRI data analysis, databases and tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar4/seminar4_2_transform.html">Transformations</a></li>





<li class="toctree-l1"><a class="reference internal" href="../seminar4/seminar4_3_freesurfer.html">FREESURFER</a></li>


<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/16--0U-QRcPJaWYqUe1RP5_V4zGvGOR76/view?usp=sharing">Seminar 5.1. MRI classification with classic ML</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1XMxW_Y73mbMGFIaWY6YlEfscD8YE35yN/view?usp=sharing">Seminar 5.2. MRI classification with 3D CNN</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/15M13NfhCGKN6akaWj8reFYvfDH7aLPsY/view?usp=sharing">Seminar 5.3. MRI segmentation with 3D U-net</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminars 6-8. Working with fMRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="README.html">Preparation to Seminar 6-8</a></li>
<li class="toctree-l1"><a class="reference internal" href="seminars_content.html">Summary of Seminar 6-7</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1kSrmaPF5_bKvH1xEKgp0BMtpnm_I-DtY/view?usp=drive_link">Seminar 6. Preprocessing pipeline for task-based fMRI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1-9hT7K9lG_pUTIgtjwH7pvxL1mf9QnMP/view?usp=drive_link">Seminar 7.1. 1st-level fMRI data analysis</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1EuyJWzhmST66rDVugbRgsm_p8Jpc7KTQ/view?usp=drive_link">Seminar 7.2. 2st-level (Group) Analysis</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1Hed2ggYNbyvBMeYpNeapMAepxeQBVLRL?usp=sharing">Seminar 8.1. Analyze task-based fMRI for motor and emotion task</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1F0UzTsmF1NK6F3NEsJHUw9G5K3j_-eYA?usp=sharing">Seminar 8.2. Functional connectivity</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminar 9. Interpretation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1yMqKV14iPrhREWP7veNMTIHUKyLoic5-">Seminar 9. Interpretation of 3D CNNs for Brain MRI Data Classification</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BIMAI-lab/NEUROML_course" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BIMAI-lab/NEUROML_course/issues/new?title=Issue%20on%20page%20%2Fseminars6_7/IndividualAnalysis.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/seminars6_7/IndividualAnalysis.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>GLM: 1st-level Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">GLM: 1st-level Analysis</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#st-level-analysis-in-nipype">1st Level Analysis in Nipype</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-design-matrix">Prepare design matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initiate-nodes">Initiate Nodes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-contrasts">Specify contrasts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-input-output-stream">Specify input &amp; output stream</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-workflow">Specify Workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-workflow">Visualize the workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-workflow">Run the Workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-output">Inspect output</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-results">Visualize results</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="glm-1st-level-analysis">
<h1>GLM: 1st-level Analysis<a class="headerlink" href="#glm-1st-level-analysis" title="Link to this heading">#</a></h1>
<p>The objective in this example is to model the timecourse of each voxel. This will allow us to answer question regarding to the voxel response to different stimuli.</p>
<p>We will model the activation at each voxel <span class="math notranslate nohighlight">\(y\)</span> as a weighed sum of explanatory variables <span class="math notranslate nohighlight">\(x_{i}\)</span>
and error term <span class="math notranslate nohighlight">\({\epsilon}\)</span></p>
<div class="math notranslate nohighlight">
\[{y} = {\beta}_{0} + \sum \limits _{i=1} ^{N} x_{i}{\beta}_{i} + {\epsilon} \]</div>
<p>or in matrix notation</p>
<div class="math notranslate nohighlight">
\[ y = {\beta} X + {\epsilon} \]</div>
<p>which can be solved with Ordinary Least Squares regression.</p>
<p>The parameters <span class="math notranslate nohighlight">\({\beta}\)</span> represent the contribution of each variable to the voxel activation.</p>
<p>The error terms are assumed to be independent and identically distributed.</p>
<p><img alt="Design matrix" src="https://mri-q.com/uploads/3/4/5/7/34572113/9355842_orig.jpg" /></p>
<p>The matrix  ùëã  is also called design matrix. It is up to the researcher which factors to include in the design matrix. The design matrix contains factors that a related to the hypothesis the researcher want to answer. Furthermore, sometimes in it are also included factors that are not related to the hypothesis, but are know sources of variability (nuisance factors).</p>
<p>Now lets take a look how we take into account the delayed bold response.
The hemodynamic response function might look something like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://en.wikipedia.org/wiki/Haemodynamic_response</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>


<span class="k">def</span><span class="w"> </span><span class="nf">hrf</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t</span> <span class="o">**</span> <span class="mf">8.6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="mf">0.547</span><span class="p">)</span>

<span class="n">hrf_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">hrf_signal</span> <span class="o">=</span> <span class="n">hrf</span><span class="p">(</span><span class="n">hrf_times</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hrf_times</span><span class="p">,</span> <span class="n">hrf_signal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;BOLD signal&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;HRF&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.0.2 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with &#39;pybind11&gt;=2.12&#39;.

If you are a user of the module, the easiest solution will be to
downgrade to &#39;numpy&lt;2&#39; or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File &quot;/home/fedor/anaconda3/lib/python3.9/runpy.py&quot;, line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File &quot;/home/fedor/anaconda3/lib/python3.9/runpy.py&quot;, line 87, in _run_code
    exec(code, run_globals)
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/ipykernel_launcher.py&quot;, line 16, in &lt;module&gt;
    app.launch_new_instance()
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/traitlets/config/application.py&quot;, line 846, in launch_instance
    app.start()
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/ipykernel/kernelapp.py&quot;, line 677, in start
    self.io_loop.start()
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/tornado/platform/asyncio.py&quot;, line 199, in start
    self.asyncio_loop.run_forever()
  File &quot;/home/fedor/anaconda3/lib/python3.9/asyncio/base_events.py&quot;, line 601, in run_forever
    self._run_once()
  File &quot;/home/fedor/anaconda3/lib/python3.9/asyncio/base_events.py&quot;, line 1905, in _run_once
    handle._run()
  File &quot;/home/fedor/anaconda3/lib/python3.9/asyncio/events.py&quot;, line 80, in _run
    self._context.run(self._callback, *self._args)
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/ipykernel/kernelbase.py&quot;, line 471, in dispatch_queue
    await self.process_one()
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/ipykernel/kernelbase.py&quot;, line 460, in process_one
    await dispatch(*args)
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/ipykernel/kernelbase.py&quot;, line 367, in dispatch_shell
    await result
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/ipykernel/kernelbase.py&quot;, line 662, in execute_request
    reply_content = await reply_content
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/ipykernel/ipkernel.py&quot;, line 360, in do_execute
    res = shell.run_cell(code, store_history=store_history, silent=silent)
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/ipykernel/zmqshell.py&quot;, line 532, in run_cell
    return super().run_cell(*args, **kwargs)
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py&quot;, line 2863, in run_cell
    result = self._run_cell(
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py&quot;, line 2909, in _run_cell
    return runner(coro)
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/IPython/core/async_helpers.py&quot;, line 129, in _pseudo_sync_runner
    coro.send(None)
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py&quot;, line 3106, in run_cell_async
    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py&quot;, line 3309, in run_ast_nodes
    if await self.run_code(code, result, async_=asy):
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py&quot;, line 3369, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File &quot;/tmp/ipykernel_356746/3243317228.py&quot;, line 3, in &lt;cell line: 3&gt;
    import matplotlib.pyplot as plt
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/matplotlib/__init__.py&quot;, line 109, in &lt;module&gt;
    from . import _api, _version, cbook, docstring, rcsetup
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/matplotlib/rcsetup.py&quot;, line 27, in &lt;module&gt;
    from matplotlib.colors import Colormap, is_color_like
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/matplotlib/colors.py&quot;, line 56, in &lt;module&gt;
    from matplotlib import _api, cbook, scale
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/matplotlib/scale.py&quot;, line 23, in &lt;module&gt;
    from matplotlib.ticker import (
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/matplotlib/ticker.py&quot;, line 136, in &lt;module&gt;
    from matplotlib import transforms as mtransforms
  File &quot;/home/fedor/anaconda3/lib/python3.9/site-packages/matplotlib/transforms.py&quot;, line 46, in &lt;module&gt;
    from matplotlib._path import (
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="ne">AttributeError</span>: _ARRAY_API not found
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="nn">Input In [1],</span> in <span class="ni">&lt;cell line: 3&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># https://en.wikipedia.org/wiki/Haemodynamic_response</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span> 
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="k">def</span><span class="w"> </span><span class="nf">hrf</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="k">return</span> <span class="n">t</span> <span class="o">**</span> <span class="mf">8.6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="mf">0.547</span><span class="p">)</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">109</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">    </span><span class="mi">105</span> <span class="kn">from</span><span class="w"> </span><span class="nn">packaging.version</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse</span> <span class="k">as</span> <span class="n">parse_version</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span> <span class="c1"># cbook must import matplotlib only within function</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span> <span class="c1"># definitions, so it is safe to import from it here.</span>
<span class="ne">--&gt; </span><span class="mi">109</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">_version</span><span class="p">,</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">docstring</span><span class="p">,</span> <span class="n">rcsetup</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.cbook</span><span class="w"> </span><span class="kn">import</span> <span class="n">MatplotlibDeprecationWarning</span><span class="p">,</span> <span class="n">sanitize_sequence</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.cbook</span><span class="w"> </span><span class="kn">import</span> <span class="n">mplDeprecation</span>  <span class="c1"># deprecated</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">rcsetup</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">27</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">cbook</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.cbook</span><span class="w"> </span><span class="kn">import</span> <span class="n">ls_mapper</span>
<span class="ne">---&gt; </span><span class="mi">27</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">Colormap</span><span class="p">,</span> <span class="n">is_color_like</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.fontconfig_pattern</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse_fontconfig_pattern</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib._enums</span><span class="w"> </span><span class="kn">import</span> <span class="n">JoinStyle</span><span class="p">,</span> <span class="n">CapStyle</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">colors</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">54</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="ne">---&gt; </span><span class="mi">56</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">scale</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span> <span class="kn">from</span><span class="w"> </span><span class="nn">._color_data</span><span class="w"> </span><span class="kn">import</span> <span class="n">BASE_COLORS</span><span class="p">,</span> <span class="n">TABLEAU_COLORS</span><span class="p">,</span> <span class="n">CSS4_COLORS</span><span class="p">,</span> <span class="n">XKCD_COLORS</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span> <span class="k">class</span><span class="w"> </span><span class="nc">_ColorMapping</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">scale</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">23</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">docstring</span>
<span class="ne">---&gt; </span><span class="mi">23</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span>     <span class="n">NullFormatter</span><span class="p">,</span> <span class="n">ScalarFormatter</span><span class="p">,</span> <span class="n">LogFormatterSciNotation</span><span class="p">,</span> <span class="n">LogitFormatter</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span>     <span class="n">NullLocator</span><span class="p">,</span> <span class="n">LogLocator</span><span class="p">,</span> <span class="n">AutoLocator</span><span class="p">,</span> <span class="n">AutoMinorLocator</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span>     <span class="n">SymmetricalLogLocator</span><span class="p">,</span> <span class="n">LogitLocator</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.transforms</span><span class="w"> </span><span class="kn">import</span> <span class="n">Transform</span><span class="p">,</span> <span class="n">IdentityTransform</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> <span class="k">class</span><span class="w"> </span><span class="nc">ScaleBase</span><span class="p">:</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">ticker</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">136</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">_api</span><span class="p">,</span> <span class="n">cbook</span>
<span class="ne">--&gt; </span><span class="mi">136</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">transforms</span> <span class="k">as</span> <span class="n">mtransforms</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span> <span class="n">_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">140</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;TickHelper&#39;</span><span class="p">,</span> <span class="s1">&#39;Formatter&#39;</span><span class="p">,</span> <span class="s1">&#39;FixedFormatter&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">141</span>            <span class="s1">&#39;NullFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;FuncFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;FormatStrFormatter&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span>            <span class="s1">&#39;StrMethodFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;ScalarFormatter&#39;</span><span class="p">,</span> <span class="s1">&#39;LogFormatter&#39;</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span>            <span class="s1">&#39;MultipleLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;MaxNLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;AutoMinorLocator&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>            <span class="s1">&#39;SymmetricalLogLocator&#39;</span><span class="p">,</span> <span class="s1">&#39;LogitLocator&#39;</span><span class="p">)</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.9</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">transforms</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">46</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span> <span class="kn">from</span><span class="w"> </span><span class="nn">numpy.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">inv</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">_api</span>
<span class="ne">---&gt; </span><span class="mi">46</span> <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib._path</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span>     <span class="n">affine_transform</span><span class="p">,</span> <span class="n">count_bboxes_overlapping_bbox</span><span class="p">,</span> <span class="n">update_path_extents</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> <span class="kn">from</span><span class="w"> </span><span class="nn">.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span> <span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>

<span class="ne">ImportError</span>: numpy.core.multiarray failed to import
</pre></div>
</div>
</div>
</div>
<p>In the design often we want to include variables, that indicate presence or absence of a stimuli.
Let‚Äôs say we had the 3 stimuli during the timecourse</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_time_points</span> <span class="o">=</span> <span class="mi">40</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_time_points</span><span class="p">)</span>  

<span class="n">neural_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_time_points</span><span class="p">)</span>
<span class="n">neural_signal</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># A 3 second event</span>
<span class="n">neural_signal</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">neural_signal</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">neural_signal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (seconds)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;neural signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Neural model for three impulses&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f9c30238da49399146b25f814c86062e067d1a901a6bc195e6388828ed178355.png" src="../_images/f9c30238da49399146b25f814c86062e067d1a901a6bc195e6388828ed178355.png" />
</div>
</div>
<p>Next we have to convolve signal with our hrf function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hrf_times</span><span class="p">,</span> <span class="n">hrf_signal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f17fed50f98&gt;]
</pre></div>
</div>
<img alt="../_images/8de6fb8e334ada84a4e7d16231dbe6bf235a32b869273a13db129c7548010305.png" src="../_images/8de6fb8e334ada84a4e7d16231dbe6bf235a32b869273a13db129c7548010305.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://www.tutorialspoint.com/what-is-convolution-in-signals-and-systems</span>
<span class="n">hrf_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">hrf_signal</span> <span class="o">=</span> <span class="n">hrf</span><span class="p">(</span><span class="n">hrf_times</span><span class="p">)</span>
<span class="n">bold_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">neural_signal</span><span class="p">,</span> <span class="n">hrf_signal</span><span class="p">)</span>

<span class="n">tailed_respose_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_time_points</span> <span class="o">+</span> <span class="n">hrf_times</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tailed_respose_times</span><span class="p">,</span> <span class="n">bold_signal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (seconds)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;bold signal&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Convolved signals&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/111b45e4292a872bee787d9d4a441060f80c368ef0c1077144e483e5fef0d668.png" src="../_images/111b45e4292a872bee787d9d4a441060f80c368ef0c1077144e483e5fef0d668.png" />
</div>
</div>
<p>After that we can fit our fMRI data to the design Matrix and use GLM for hypotesis testing.
We can evaluate whether a given factor <span class="math notranslate nohighlight">\(i\)</span> has a considerable contribution by its coefficient <span class="math notranslate nohighlight">\({\beta}_{i}\)</span>.
With t-test we can evaluate whether <span class="math notranslate nohighlight">\({\beta}_{i}\)</span> &gt; 0. We can also test hypothesis of the form <span class="math notranslate nohighlight">\({\beta}_{i}\)</span> &gt; <span class="math notranslate nohighlight">\({\beta}_{j}\)</span>.</p>
<p>The general form of the hypothesis tests which forms a <strong>contrast</strong> is:
$<span class="math notranslate nohighlight">\(\sum \limits _{i=1} ^{P} c_{i}{\beta}_{i} &gt; 0 \)</span>$</p>
<p>Typical values for <span class="math notranslate nohighlight">\(c\)</span> are 1 and -1.
Typically contrasts are express as:<span class="math notranslate nohighlight">\( [c_{1}, c_{2}, ..., c_{N}]\)</span>.</p>
<p>For example the contrast [1, 0] tests <span class="math notranslate nohighlight">\({\beta}_{1}\)</span> &gt; 0.</p>
<p>This contrasts form a t-statistics (Recall that <span class="math notranslate nohighlight">\(\frac{c^T \beta}{SE(c^T \beta)}\)</span> in OLS regression follow <span class="math notranslate nohighlight">\(t\)</span>-distribution with <span class="math notranslate nohighlight">\(n-p-1\)</span> df).</p>
<p>We can combine several contrasts and form F-statics. In the contexts of fMRI the F-tests help us answer questions like ‚ÄúIs effect A or effect B or effect C, or any combination of them, significantly non-zero?‚Äù.</p>
<p>Recall that F test is used for comparison between reduced model <span class="math notranslate nohighlight">\(RF\)</span> and full model <span class="math notranslate nohighlight">\(FM\)</span>:
$<span class="math notranslate nohighlight">\( F = \frac{(SSE(RM)-SSE(FM)) /(k_{FM}-k_{RM}))}{SSE(FM)/(n-k_{FM})} \)</span>$</p>
<p>where <span class="math notranslate nohighlight">\(k\)</span> - the number of model distinct parameters</p>
<p>Combining the test results from all voxels we get statistical map of brain activity.
Now that the theory out of our way we can see how it is done in Nipype.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="st-level-analysis-in-nipype">
<h1>1st Level Analysis in Nipype<a class="headerlink" href="#st-level-analysis-in-nipype" title="Link to this heading">#</a></h1>
<p>We will use the preprocessed files we got and run 1st-level analysis (individual analysis) for each subject. We will perform the following steps:</p>
<ol class="arabic simple">
<li><p>Extract onset times of stimuli from TVA file</p></li>
<li><p>Specify the model (TR, high pass filter, onset times, etc.)</p></li>
<li><p>Specify contrasts to compute</p></li>
<li><p>Estimate contrasts</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">nilearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">plotting</span>
<span class="o">%</span><span class="k">matplotlib</span> inline


<span class="kn">from</span><span class="w"> </span><span class="nn">nipype.interfaces.spm</span><span class="w"> </span><span class="kn">import</span> <span class="n">Level1Design</span><span class="p">,</span> <span class="n">EstimateModel</span><span class="p">,</span> <span class="n">EstimateContrast</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nipype.algorithms.modelgen</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpecifySPMModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nipype.interfaces.utility</span><span class="w"> </span><span class="kn">import</span> <span class="n">Function</span><span class="p">,</span> <span class="n">IdentityInterface</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nipype.interfaces.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">SelectFiles</span><span class="p">,</span> <span class="n">DataSink</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nipype</span><span class="w"> </span><span class="kn">import</span> <span class="n">Workflow</span><span class="p">,</span> <span class="n">Node</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">list_files</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># specify paths</span>
<span class="n">experiment_dir</span> <span class="o">=</span> <span class="s1">&#39;/output&#39;</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;datasink&#39;</span>
<span class="n">working_dir</span> <span class="o">=</span> <span class="s1">&#39;workingdir&#39;</span>

<span class="c1"># list of subject identifiers</span>
<span class="n">subject_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;01&#39;</span><span class="p">,</span> <span class="s1">&#39;02&#39;</span><span class="p">,</span> <span class="s1">&#39;03&#39;</span><span class="p">,</span> <span class="s1">&#39;04&#39;</span><span class="p">,</span> <span class="s1">&#39;05&#39;</span><span class="p">,</span> <span class="s1">&#39;06&#39;</span><span class="p">,</span> <span class="s1">&#39;07&#39;</span><span class="p">,</span> <span class="s1">&#39;08&#39;</span><span class="p">,</span> <span class="s1">&#39;09&#39;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">]</span> <span class="c1"># TODO: test all subjects</span>

<span class="c1"># subject_list = [&#39;01&#39;, &#39;02&#39;]</span>
<span class="c1"># Repetition time(TR) of functional images</span>
<span class="n">TR</span> <span class="o">=</span> <span class="mf">2.5</span>
</pre></div>
</div>
</div>
</div>
<section id="prepare-design-matrix">
<h2>Prepare design matrix<a class="headerlink" href="#prepare-design-matrix" title="Link to this heading">#</a></h2>
<p>Let‚Äôs take a look how the stimuli onset and duration look like.This information is store in a <code class="docutils literal notranslate"><span class="pre">tsv</span></code> file. This file will help us build the design matrix.</p>
<p>The three different conditions in the <strong>fingerfootlips</strong> task are:</p>
<ul class="simple">
<li><p><strong>finger</strong></p></li>
<li><p><strong>foot</strong></p></li>
<li><p><strong>lips</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trialinfo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;/data/ds000114/task-fingerfootlips_events.tsv&#39;</span><span class="p">)</span>
<span class="n">trialinfo</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>onset</th>
      <th>duration</th>
      <th>weight</th>
      <th>trial_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>15.0</td>
      <td>1</td>
      <td>Finger</td>
    </tr>
    <tr>
      <th>1</th>
      <td>40</td>
      <td>15.0</td>
      <td>1</td>
      <td>Foot</td>
    </tr>
    <tr>
      <th>2</th>
      <td>70</td>
      <td>15.0</td>
      <td>1</td>
      <td>Lips</td>
    </tr>
    <tr>
      <th>3</th>
      <td>100</td>
      <td>15.0</td>
      <td>1</td>
      <td>Finger</td>
    </tr>
    <tr>
      <th>4</th>
      <td>130</td>
      <td>15.0</td>
      <td>1</td>
      <td>Foot</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">subjectinfo</span><span class="p">(</span><span class="n">subject_id</span><span class="p">):</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">nipype.interfaces.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">Bunch</span>

    
    <span class="n">trialinfo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;/data/ds000114/task-fingerfootlips_events.tsv&#39;</span><span class="p">)</span>
    <span class="c1">#trialinfo.head()</span>
    <span class="n">conditions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">onsets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">trialinfo</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;trial_type&#39;</span><span class="p">):</span>
        <span class="n">conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">onsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">onset</span> <span class="o">-</span> <span class="mi">10</span><span class="p">))</span> <span class="c1"># subtracting 10s due to removing of 4 dummy scans</span>
        <span class="n">durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="c1"># Bunch is a dictionary-like class that provides attribute-style access to it‚Äôs items.</span>
    <span class="n">subject_info</span> <span class="o">=</span> <span class="p">[</span><span class="n">Bunch</span><span class="p">(</span><span class="n">conditions</span><span class="o">=</span><span class="n">conditions</span><span class="p">,</span>
                          <span class="n">onsets</span><span class="o">=</span><span class="n">onsets</span><span class="p">,</span>
                          <span class="n">durations</span><span class="o">=</span><span class="n">durations</span>
                         <span class="p">)]</span>

    <span class="k">return</span> <span class="n">subject_info</span>  <span class="c1"># this output will later be returned to infosource</span>

<span class="c1"># Get Subject Info - get subject specific condition information</span>
<span class="n">getsubjectinfo</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;subject_id&#39;</span><span class="p">],</span>
                               <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;subject_info&#39;</span><span class="p">],</span>
                               <span class="n">function</span><span class="o">=</span><span class="n">subjectinfo</span><span class="p">),</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;getsubjectinfo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="initiate-nodes">
<h2>Initiate Nodes<a class="headerlink" href="#initiate-nodes" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SpecifyModel - Generates SPM(Statistical parametric mapping)-specific Model</span>
<span class="c1">#Setup</span>
<span class="c1">#https://nipype.readthedocs.io/en/latest/api/generated/nipype.algorithms.modelgen.html#specifymodel</span>
<span class="n">modelspec</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SpecifySPMModel</span><span class="p">(</span><span class="n">concatenate_runs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">input_units</span><span class="o">=</span><span class="s1">&#39;secs&#39;</span><span class="p">,</span>
                                 <span class="n">output_units</span><span class="o">=</span><span class="s1">&#39;secs&#39;</span><span class="p">,</span>
                                 <span class="n">time_repetition</span><span class="o">=</span><span class="n">TR</span><span class="p">,</span>
                                 <span class="n">high_pass_filter_cutoff</span><span class="o">=</span><span class="mi">128</span><span class="p">),</span>
                 <span class="n">name</span><span class="o">=</span><span class="s2">&quot;modelspec&quot;</span><span class="p">)</span>

<span class="c1"># Level1Design - Generates an SPM design matrix</span>
<span class="c1">#https://www.fil.ion.ucl.ac.uk/spm/doc/manual.pdf#page=59</span>
<span class="c1">#hrf- Name of basis function(canonical)</span>
<span class="c1">#&#39;derivs&#39;: [1, 0]-Time derivatives : Time and Dispersion (additional regressors for SPM)</span>

<span class="c1">#model_serial_correlations-serial correlations using an autoregressive estimator (order 1)</span>

<span class="n">level1design</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Level1Design</span><span class="p">(</span><span class="n">bases</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hrf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;derivs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}},</span>
                                 <span class="n">timing_units</span><span class="o">=</span><span class="s1">&#39;secs&#39;</span><span class="p">,</span>
                                 <span class="n">interscan_interval</span><span class="o">=</span><span class="n">TR</span><span class="p">,</span>
                                 <span class="n">model_serial_correlations</span><span class="o">=</span><span class="s1">&#39;AR(1)&#39;</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;level1design&quot;</span><span class="p">)</span>

<span class="c1"># EstimateModel - estimate the parameters of the model</span>
<span class="c1">#https://www.fil.ion.ucl.ac.uk/spm/doc/manual.pdf#page=69</span>

<span class="n">level1estimate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">EstimateModel</span><span class="p">(</span><span class="n">estimation_method</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Classical&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span>
                      <span class="n">name</span><span class="o">=</span><span class="s2">&quot;level1estimate&quot;</span><span class="p">)</span>

<span class="c1"># EstimateContrast - estimates contrasts</span>
<span class="n">level1conest</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">EstimateContrast</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;level1conest&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="specify-contrasts">
<h2>Specify contrasts<a class="headerlink" href="#specify-contrasts" title="Link to this heading">#</a></h2>
<p>We are gona perform several T tests and one F test. Recall the general form of the hypothesis are</p>
<div class="math notranslate nohighlight">
\[\sum \limits _{i=1} ^{N} c_{i}{\beta}_{i} &gt; 0 \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Condition names</span>
<span class="n">condition_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Finger&#39;</span><span class="p">,</span> <span class="s1">&#39;Foot&#39;</span><span class="p">,</span> <span class="s1">&#39;Lips&#39;</span><span class="p">]</span>

<span class="c1"># Contrasts</span>
<span class="c1"># contrast =  [&lt;contrast_name&gt;, &lt;test&gt;, &lt;condition_names&gt;, &lt;[c1, c2, c3]&gt;]</span>
<span class="n">cont01</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>        <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">condition_names</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3.</span><span class="p">]]</span> 
<span class="n">cont02</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Finger&#39;</span><span class="p">,</span>         <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">condition_names</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span> <span class="c1"># FINGER &gt; 0</span>
<span class="n">cont03</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Foot&#39;</span><span class="p">,</span>           <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">condition_names</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span> <span class="c1"># FOOT &gt; 0</span>
<span class="n">cont04</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Lips&#39;</span><span class="p">,</span>           <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">condition_names</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="c1"># LIPS &gt; 0</span>
<span class="n">cont05</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Foot &gt; others&#39;</span><span class="p">,</span>  <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">condition_names</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]]</span> <span class="c1"># FOOT &gt; (FINGER + LIPS) / 2</span>
<span class="n">cont06</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;activation&#39;</span><span class="p">,</span>     <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cont02</span><span class="p">,</span> <span class="n">cont03</span><span class="p">,</span> <span class="n">cont04</span><span class="p">]]</span> <span class="c1"># if any </span>

<span class="n">contrast_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">cont01</span><span class="p">,</span> <span class="n">cont02</span><span class="p">,</span> <span class="n">cont03</span><span class="p">,</span> <span class="n">cont04</span><span class="p">,</span> <span class="n">cont05</span><span class="p">,</span> <span class="n">cont06</span><span class="p">]</span>
<span class="c1"># After this step we got T critical for the t-statistics</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="specify-input-output-stream">
<h2>Specify input &amp; output stream<a class="headerlink" href="#specify-input-output-stream" title="Link to this heading">#</a></h2>
<p>Specify where the input data can be found &amp; where and how to save the output data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Infosource - a function free node to iterate over the list of subject names</span>
<span class="n">infosource</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">IdentityInterface</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;subject_id&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;contrasts&#39;</span><span class="p">],</span>
                                    <span class="n">contrasts</span><span class="o">=</span><span class="n">contrast_list</span><span class="p">),</span>
                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;infosource&quot;</span><span class="p">)</span>
<span class="n">infosource</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <span class="n">subject_list</span><span class="p">)]</span>

<span class="c1"># SelectFiles - to grab the data (alternativ to DataGrabber)</span>
<span class="n">templates</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="s1">&#39;datasink/preproc/sub-</span><span class="si">{subject_id}</span><span class="s1">/task-</span><span class="si">{task_id}</span><span class="s1">/fwhm-5_ssub-</span><span class="si">{subject_id}</span><span class="s1">_ses-test_task-</span><span class="si">{task_id}</span><span class="s1">_bold.nii&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mc_param&#39;</span><span class="p">:</span> <span class="s1">&#39;datasink/preproc/sub-</span><span class="si">{subject_id}</span><span class="s1">/task-</span><span class="si">{task_id}</span><span class="s1">/sub-</span><span class="si">{subject_id}</span><span class="s1">_ses-test_task-</span><span class="si">{task_id}</span><span class="s1">_bold.par&#39;</span><span class="p">,</span>
        <span class="s1">&#39;outliers&#39;</span><span class="p">:</span> <span class="s1">&#39;datasink/preproc/sub-</span><span class="si">{subject_id}</span><span class="s1">/task-</span><span class="si">{task_id}</span><span class="s1">/art.sub-</span><span class="si">{subject_id}</span><span class="s1">_ses-test_task-</span><span class="si">{task_id}</span><span class="s1">_bold_outliers.txt&#39;</span>
    <span class="p">}</span>
<span class="n">selectfiles</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SelectFiles</span><span class="p">(</span><span class="n">templates</span><span class="p">,</span>
                               <span class="n">base_directory</span><span class="o">=</span><span class="n">experiment_dir</span><span class="p">,</span>
                               <span class="n">sort_filelist</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                   <span class="n">name</span><span class="o">=</span><span class="s2">&quot;selectfiles&quot;</span><span class="p">)</span>
<span class="n">selectfiles</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">task_id</span> <span class="o">=</span> <span class="s1">&#39;fingerfootlips&#39;</span>

<span class="c1"># Datasink - creates output folder for important outputs</span>
<span class="n">datasink</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DataSink</span><span class="p">(</span><span class="n">base_directory</span><span class="o">=</span><span class="n">experiment_dir</span><span class="p">,</span>
                         <span class="n">container</span><span class="o">=</span><span class="n">output_dir</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;datasink&quot;</span><span class="p">)</span>

<span class="c1"># Use the following DataSink output substitutions</span>
<span class="n">substitutions</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;_subject_id_&#39;</span><span class="p">,</span> <span class="s1">&#39;sub-&#39;</span><span class="p">)]</span>
<span class="n">datasink</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">substitutions</span> <span class="o">=</span> <span class="n">substitutions</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="specify-workflow">
<h2>Specify Workflow<a class="headerlink" href="#specify-workflow" title="Link to this heading">#</a></h2>
<p>Create a workflow and <strong>connect</strong> the interface nodes and the I/O stream to each other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initiation of the 1st-level analysis workflow</span>
<span class="n">l1analysis</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;l1analysis&#39;</span><span class="p">)</span>
<span class="n">l1analysis</span><span class="o">.</span><span class="n">base_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">experiment_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">working_dir</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="c1"># Connect up the 1st-level analysis components</span>
<span class="n">l1analysis</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">infosource</span><span class="p">,</span> <span class="n">selectfiles</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <span class="s1">&#39;subject_id&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">infosource</span><span class="p">,</span> <span class="n">getsubjectinfo</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;subject_id&#39;</span><span class="p">,</span>
                                                   <span class="s1">&#39;subject_id&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">getsubjectinfo</span><span class="p">,</span> <span class="n">modelspec</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;subject_info&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;subject_info&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">infosource</span><span class="p">,</span> <span class="n">level1conest</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;contrasts&#39;</span><span class="p">,</span> <span class="s1">&#39;contrasts&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">selectfiles</span><span class="p">,</span> <span class="n">modelspec</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;func&#39;</span><span class="p">,</span> <span class="s1">&#39;functional_runs&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">selectfiles</span><span class="p">,</span> <span class="n">modelspec</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;mc_param&#39;</span><span class="p">,</span> <span class="s1">&#39;realignment_parameters&#39;</span><span class="p">),</span>
                                              <span class="p">(</span><span class="s1">&#39;outliers&#39;</span><span class="p">,</span> <span class="s1">&#39;outlier_files&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">modelspec</span><span class="p">,</span> <span class="n">level1design</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;session_info&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;session_info&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">level1design</span><span class="p">,</span> <span class="n">level1estimate</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;spm_mat_file&#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;spm_mat_file&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">level1estimate</span><span class="p">,</span> <span class="n">level1conest</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;spm_mat_file&#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;spm_mat_file&#39;</span><span class="p">),</span>
                                                    <span class="p">(</span><span class="s1">&#39;beta_images&#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;beta_images&#39;</span><span class="p">),</span>
                                                    <span class="p">(</span><span class="s1">&#39;residual_image&#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;residual_image&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">level1conest</span><span class="p">,</span> <span class="n">datasink</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;spm_mat_file&#39;</span><span class="p">,</span> <span class="s1">&#39;1stLevel.@spm_mat&#39;</span><span class="p">),</span>
                                              <span class="p">(</span><span class="s1">&#39;spmT_images&#39;</span><span class="p">,</span> <span class="s1">&#39;1stLevel.@T&#39;</span><span class="p">),</span>
                                              <span class="p">(</span><span class="s1">&#39;con_images&#39;</span><span class="p">,</span> <span class="s1">&#39;1stLevel.@con&#39;</span><span class="p">),</span>
                                              <span class="p">(</span><span class="s1">&#39;spmF_images&#39;</span><span class="p">,</span> <span class="s1">&#39;1stLevel.@F&#39;</span><span class="p">),</span>
                                              <span class="p">(</span><span class="s1">&#39;ess_images&#39;</span><span class="p">,</span> <span class="s1">&#39;1stLevel.@ess&#39;</span><span class="p">),</span>
                                              <span class="p">]),</span>
                    <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-the-workflow">
<h2>Visualize the workflow<a class="headerlink" href="#visualize-the-workflow" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save the 1st-level analysis graph as png</span>
<span class="n">l1analysis</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;colored&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">simple_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Visualize the graph</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">l1analysis</span><span class="o">.</span><span class="n">base_dir</span><span class="si">}</span><span class="s1">/l1analysis/graph.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>250815-11:17:15,827 nipype.workflow INFO:
	 Generated workflow graph: /output/workingdir/l1analysis/graph.png (graph2use=colored, simple_form=True).
</pre></div>
</div>
<img alt="../_images/4cf84db5527180c0ce56f0e3387d52e7cd52425df9b74eb22f310cac8b369c62.png" src="../_images/4cf84db5527180c0ce56f0e3387d52e7cd52425df9b74eb22f310cac8b369c62.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show detailed workflow</span>
<span class="n">l1analysis</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">simple_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">l1analysis</span><span class="o">.</span><span class="n">base_dir</span><span class="si">}</span><span class="s1">/l1analysis/graph_detailed.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>250813-11:02:24,323 nipype.workflow INFO:
	 Generated workflow graph: /output/workingdir/l1analysis/graph.png (graph2use=flat, simple_form=True).
</pre></div>
</div>
<img alt="../_images/e67759f080f595a53a714108eaae848de40751296fbcba920f609bd7418ea774.png" src="../_images/e67759f080f595a53a714108eaae848de40751296fbcba920f609bd7418ea774.png" />
</div>
</div>
</section>
<section id="run-the-workflow">
<h2>Run the Workflow<a class="headerlink" href="#run-the-workflow" title="Link to this heading">#</a></h2>
<p>Run the 1st-level analysis workflow.</p>
<p>Run with ‚ÄòLinear‚Äô plugin if multiprocessing frozen during execution</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l1analysis</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;Linear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>250815-11:17:32,922 nipype.workflow INFO:
	 Workflow l1analysis settings: [&#39;check&#39;, &#39;execution&#39;, &#39;logging&#39;, &#39;monitoring&#39;]
250815-11:17:33,542 nipype.workflow INFO:
	 Running serially.
250815-11:17:33,544 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.getsubjectinfo&quot; in &quot;/output/workingdir/l1analysis/_subject_id_10/getsubjectinfo&quot;.
250815-11:17:33,611 nipype.workflow INFO:
	 [Node] Running &quot;getsubjectinfo&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
250815-11:17:33,723 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.getsubjectinfo&quot;.
250815-11:17:33,725 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.selectfiles&quot; in &quot;/output/workingdir/l1analysis/_subject_id_10/selectfiles&quot;.
250815-11:17:33,787 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-11:17:33,914 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.selectfiles&quot;.
250815-11:17:33,916 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.modelspec&quot; in &quot;/output/workingdir/l1analysis/_subject_id_10/modelspec&quot;.
250815-11:17:34,273 nipype.workflow INFO:
	 [Node] Running &quot;modelspec&quot; (&quot;nipype.algorithms.modelgen.SpecifySPMModel&quot;)
250815-11:17:34,483 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.modelspec&quot;.
250815-11:17:34,484 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1design&quot; in &quot;/output/workingdir/l1analysis/_subject_id_10/level1design&quot;.
250815-11:17:34,660 nipype.workflow INFO:
	 [Node] Running &quot;level1design&quot; (&quot;nipype.interfaces.spm.model.Level1Design&quot;)
250815-11:18:05,929 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1design&quot;.
250815-11:18:05,931 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1estimate&quot; in &quot;/output/workingdir/l1analysis/_subject_id_10/level1estimate&quot;.
250815-11:18:06,123 nipype.workflow INFO:
	 [Node] Running &quot;level1estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-11:18:39,649 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1estimate&quot;.
250815-11:18:39,651 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1conest&quot; in &quot;/output/workingdir/l1analysis/_subject_id_10/level1conest&quot;.
250815-11:18:41,38 nipype.workflow INFO:
	 [Node] Running &quot;level1conest&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-11:18:53,352 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1conest&quot;.
250815-11:18:53,354 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.datasink&quot; in &quot;/output/workingdir/l1analysis/_subject_id_10/datasink&quot;.
250815-11:18:53,820 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-11:18:53,830 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/SPM.mat -&gt; /output/datasink/1stLevel/sub-10/SPM.mat
250815-11:18:53,864 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/spmT_0001.nii -&gt; /output/datasink/1stLevel/sub-10/spmT_0001.nii
250815-11:18:53,886 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/spmT_0002.nii -&gt; /output/datasink/1stLevel/sub-10/spmT_0002.nii
250815-11:18:53,908 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/spmT_0003.nii -&gt; /output/datasink/1stLevel/sub-10/spmT_0003.nii
250815-11:18:53,929 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/spmT_0004.nii -&gt; /output/datasink/1stLevel/sub-10/spmT_0004.nii
250815-11:18:53,951 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/spmT_0005.nii -&gt; /output/datasink/1stLevel/sub-10/spmT_0005.nii
250815-11:18:53,972 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-10/spmF_0006.nii
250815-11:18:53,991 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/con_0001.nii -&gt; /output/datasink/1stLevel/sub-10/con_0001.nii
250815-11:18:54,12 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/con_0002.nii -&gt; /output/datasink/1stLevel/sub-10/con_0002.nii
250815-11:18:54,40 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/con_0003.nii -&gt; /output/datasink/1stLevel/sub-10/con_0003.nii
250815-11:18:54,73 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/con_0004.nii -&gt; /output/datasink/1stLevel/sub-10/con_0004.nii
250815-11:18:54,104 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/con_0005.nii -&gt; /output/datasink/1stLevel/sub-10/con_0005.nii
250815-11:18:54,133 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-10/ess_0006.nii
250815-11:18:54,162 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-10/spmF_0006.nii
250815-11:18:54,187 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_10/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-10/ess_0006.nii
250815-11:18:54,377 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.datasink&quot;.
250815-11:18:54,379 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.getsubjectinfo&quot; in &quot;/output/workingdir/l1analysis/_subject_id_09/getsubjectinfo&quot;.
250815-11:18:54,436 nipype.workflow INFO:
	 [Node] Running &quot;getsubjectinfo&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
250815-11:18:54,536 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.getsubjectinfo&quot;.
250815-11:18:54,538 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.selectfiles&quot; in &quot;/output/workingdir/l1analysis/_subject_id_09/selectfiles&quot;.
250815-11:18:54,602 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-11:18:54,764 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.selectfiles&quot;.
250815-11:18:54,767 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.modelspec&quot; in &quot;/output/workingdir/l1analysis/_subject_id_09/modelspec&quot;.
250815-11:18:55,163 nipype.workflow INFO:
	 [Node] Running &quot;modelspec&quot; (&quot;nipype.algorithms.modelgen.SpecifySPMModel&quot;)
250815-11:18:55,342 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.modelspec&quot;.
250815-11:18:55,344 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1design&quot; in &quot;/output/workingdir/l1analysis/_subject_id_09/level1design&quot;.
250815-11:18:55,497 nipype.workflow INFO:
	 [Node] Running &quot;level1design&quot; (&quot;nipype.interfaces.spm.model.Level1Design&quot;)
250815-11:19:22,34 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1design&quot;.
250815-11:19:22,37 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1estimate&quot; in &quot;/output/workingdir/l1analysis/_subject_id_09/level1estimate&quot;.
250815-11:19:22,221 nipype.workflow INFO:
	 [Node] Running &quot;level1estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-11:19:58,469 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1estimate&quot;.
250815-11:19:58,471 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1conest&quot; in &quot;/output/workingdir/l1analysis/_subject_id_09/level1conest&quot;.
250815-11:19:59,706 nipype.workflow INFO:
	 [Node] Running &quot;level1conest&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-11:20:12,198 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1conest&quot;.
250815-11:20:12,200 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.datasink&quot; in &quot;/output/workingdir/l1analysis/_subject_id_09/datasink&quot;.
250815-11:20:12,655 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-11:20:12,663 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/SPM.mat -&gt; /output/datasink/1stLevel/sub-09/SPM.mat
250815-11:20:12,689 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/spmT_0001.nii -&gt; /output/datasink/1stLevel/sub-09/spmT_0001.nii
250815-11:20:12,710 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/spmT_0002.nii -&gt; /output/datasink/1stLevel/sub-09/spmT_0002.nii
250815-11:20:12,729 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/spmT_0003.nii -&gt; /output/datasink/1stLevel/sub-09/spmT_0003.nii
250815-11:20:12,748 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/spmT_0004.nii -&gt; /output/datasink/1stLevel/sub-09/spmT_0004.nii
250815-11:20:12,768 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/spmT_0005.nii -&gt; /output/datasink/1stLevel/sub-09/spmT_0005.nii
250815-11:20:12,788 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-09/spmF_0006.nii
250815-11:20:12,808 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/con_0001.nii -&gt; /output/datasink/1stLevel/sub-09/con_0001.nii
250815-11:20:12,828 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/con_0002.nii -&gt; /output/datasink/1stLevel/sub-09/con_0002.nii
250815-11:20:12,849 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/con_0003.nii -&gt; /output/datasink/1stLevel/sub-09/con_0003.nii
250815-11:20:12,868 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/con_0004.nii -&gt; /output/datasink/1stLevel/sub-09/con_0004.nii
250815-11:20:12,890 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/con_0005.nii -&gt; /output/datasink/1stLevel/sub-09/con_0005.nii
250815-11:20:12,910 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-09/ess_0006.nii
250815-11:20:12,929 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-09/spmF_0006.nii
250815-11:20:12,978 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_09/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-09/ess_0006.nii
250815-11:20:13,209 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.datasink&quot;.
250815-11:20:13,211 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.getsubjectinfo&quot; in &quot;/output/workingdir/l1analysis/_subject_id_08/getsubjectinfo&quot;.
250815-11:20:13,267 nipype.workflow INFO:
	 [Node] Running &quot;getsubjectinfo&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
250815-11:20:13,370 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.getsubjectinfo&quot;.
250815-11:20:13,371 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.selectfiles&quot; in &quot;/output/workingdir/l1analysis/_subject_id_08/selectfiles&quot;.
250815-11:20:13,427 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-11:20:13,563 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.selectfiles&quot;.
250815-11:20:13,564 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.modelspec&quot; in &quot;/output/workingdir/l1analysis/_subject_id_08/modelspec&quot;.
250815-11:20:13,996 nipype.workflow INFO:
	 [Node] Running &quot;modelspec&quot; (&quot;nipype.algorithms.modelgen.SpecifySPMModel&quot;)
250815-11:20:14,198 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.modelspec&quot;.
250815-11:20:14,200 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1design&quot; in &quot;/output/workingdir/l1analysis/_subject_id_08/level1design&quot;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/miniconda-latest/envs/neuro/lib/python3.6/site-packages/nipype/algorithms/modelgen.py:491: UserWarning: loadtxt: Empty input file: &quot;/output/workingdir/l1analysis/_subject_id_08/modelspec/art.sub-08_ses-test_task-fingerfootlips_bold_outliers.txt&quot;
  outindices = np.loadtxt(filename, dtype=int)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>250815-11:20:14,374 nipype.workflow INFO:
	 [Node] Running &quot;level1design&quot; (&quot;nipype.interfaces.spm.model.Level1Design&quot;)
250815-11:20:41,148 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1design&quot;.
250815-11:20:41,151 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1estimate&quot; in &quot;/output/workingdir/l1analysis/_subject_id_08/level1estimate&quot;.
250815-11:20:41,297 nipype.workflow INFO:
	 [Node] Running &quot;level1estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-11:21:16,887 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1estimate&quot;.
250815-11:21:16,889 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1conest&quot; in &quot;/output/workingdir/l1analysis/_subject_id_08/level1conest&quot;.
250815-11:21:18,167 nipype.workflow INFO:
	 [Node] Running &quot;level1conest&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-11:21:30,19 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1conest&quot;.
250815-11:21:30,21 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.datasink&quot; in &quot;/output/workingdir/l1analysis/_subject_id_08/datasink&quot;.
250815-11:21:30,552 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-11:21:30,561 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/SPM.mat -&gt; /output/datasink/1stLevel/sub-08/SPM.mat
250815-11:21:30,589 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/spmT_0001.nii -&gt; /output/datasink/1stLevel/sub-08/spmT_0001.nii
250815-11:21:30,609 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/spmT_0002.nii -&gt; /output/datasink/1stLevel/sub-08/spmT_0002.nii
250815-11:21:30,630 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/spmT_0003.nii -&gt; /output/datasink/1stLevel/sub-08/spmT_0003.nii
250815-11:21:30,649 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/spmT_0004.nii -&gt; /output/datasink/1stLevel/sub-08/spmT_0004.nii
250815-11:21:30,668 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/spmT_0005.nii -&gt; /output/datasink/1stLevel/sub-08/spmT_0005.nii
250815-11:21:30,689 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-08/spmF_0006.nii
250815-11:21:30,709 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/con_0001.nii -&gt; /output/datasink/1stLevel/sub-08/con_0001.nii
250815-11:21:30,728 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/con_0002.nii -&gt; /output/datasink/1stLevel/sub-08/con_0002.nii
250815-11:21:30,751 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/con_0003.nii -&gt; /output/datasink/1stLevel/sub-08/con_0003.nii
250815-11:21:30,772 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/con_0004.nii -&gt; /output/datasink/1stLevel/sub-08/con_0004.nii
250815-11:21:30,818 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/con_0005.nii -&gt; /output/datasink/1stLevel/sub-08/con_0005.nii
250815-11:21:30,840 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-08/ess_0006.nii
250815-11:21:30,862 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-08/spmF_0006.nii
250815-11:21:30,884 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_08/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-08/ess_0006.nii
250815-11:21:31,68 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.datasink&quot;.
250815-11:21:31,70 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.getsubjectinfo&quot; in &quot;/output/workingdir/l1analysis/_subject_id_07/getsubjectinfo&quot;.
250815-11:21:31,162 nipype.workflow INFO:
	 [Node] Running &quot;getsubjectinfo&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
250815-11:21:31,281 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.getsubjectinfo&quot;.
250815-11:21:31,283 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.selectfiles&quot; in &quot;/output/workingdir/l1analysis/_subject_id_07/selectfiles&quot;.
250815-11:21:31,340 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-11:21:31,477 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.selectfiles&quot;.
250815-11:21:31,478 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.modelspec&quot; in &quot;/output/workingdir/l1analysis/_subject_id_07/modelspec&quot;.
250815-11:21:31,901 nipype.workflow INFO:
	 [Node] Running &quot;modelspec&quot; (&quot;nipype.algorithms.modelgen.SpecifySPMModel&quot;)
250815-11:21:32,92 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.modelspec&quot;.
250815-11:21:32,94 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1design&quot; in &quot;/output/workingdir/l1analysis/_subject_id_07/level1design&quot;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/miniconda-latest/envs/neuro/lib/python3.6/site-packages/nipype/algorithms/modelgen.py:491: UserWarning: loadtxt: Empty input file: &quot;/output/workingdir/l1analysis/_subject_id_07/modelspec/art.sub-07_ses-test_task-fingerfootlips_bold_outliers.txt&quot;
  outindices = np.loadtxt(filename, dtype=int)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>250815-11:21:32,258 nipype.workflow INFO:
	 [Node] Running &quot;level1design&quot; (&quot;nipype.interfaces.spm.model.Level1Design&quot;)
250815-11:21:59,212 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1design&quot;.
250815-11:21:59,214 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1estimate&quot; in &quot;/output/workingdir/l1analysis/_subject_id_07/level1estimate&quot;.
250815-11:21:59,398 nipype.workflow INFO:
	 [Node] Running &quot;level1estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-11:22:34,234 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1estimate&quot;.
250815-11:22:34,237 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1conest&quot; in &quot;/output/workingdir/l1analysis/_subject_id_07/level1conest&quot;.
250815-11:22:35,785 nipype.workflow INFO:
	 [Node] Running &quot;level1conest&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-11:22:50,638 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1conest&quot;.
250815-11:22:50,640 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.datasink&quot; in &quot;/output/workingdir/l1analysis/_subject_id_07/datasink&quot;.
250815-11:22:51,337 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-11:22:51,344 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/SPM.mat -&gt; /output/datasink/1stLevel/sub-07/SPM.mat
250815-11:22:51,369 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/spmT_0001.nii -&gt; /output/datasink/1stLevel/sub-07/spmT_0001.nii
250815-11:22:51,389 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/spmT_0002.nii -&gt; /output/datasink/1stLevel/sub-07/spmT_0002.nii
250815-11:22:51,408 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/spmT_0003.nii -&gt; /output/datasink/1stLevel/sub-07/spmT_0003.nii
250815-11:22:51,428 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/spmT_0004.nii -&gt; /output/datasink/1stLevel/sub-07/spmT_0004.nii
250815-11:22:51,449 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/spmT_0005.nii -&gt; /output/datasink/1stLevel/sub-07/spmT_0005.nii
250815-11:22:51,470 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-07/spmF_0006.nii
250815-11:22:51,491 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/con_0001.nii -&gt; /output/datasink/1stLevel/sub-07/con_0001.nii
250815-11:22:51,511 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/con_0002.nii -&gt; /output/datasink/1stLevel/sub-07/con_0002.nii
250815-11:22:51,529 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/con_0003.nii -&gt; /output/datasink/1stLevel/sub-07/con_0003.nii
250815-11:22:51,549 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/con_0004.nii -&gt; /output/datasink/1stLevel/sub-07/con_0004.nii
250815-11:22:51,568 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/con_0005.nii -&gt; /output/datasink/1stLevel/sub-07/con_0005.nii
250815-11:22:51,589 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-07/ess_0006.nii
250815-11:22:51,614 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-07/spmF_0006.nii
250815-11:22:51,636 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_07/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-07/ess_0006.nii
250815-11:22:51,847 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.datasink&quot;.
250815-11:22:51,848 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.getsubjectinfo&quot; in &quot;/output/workingdir/l1analysis/_subject_id_06/getsubjectinfo&quot;.
250815-11:22:51,910 nipype.workflow INFO:
	 [Node] Running &quot;getsubjectinfo&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
250815-11:22:52,32 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.getsubjectinfo&quot;.
250815-11:22:52,34 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.selectfiles&quot; in &quot;/output/workingdir/l1analysis/_subject_id_06/selectfiles&quot;.
250815-11:22:52,97 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-11:22:52,253 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.selectfiles&quot;.
250815-11:22:52,255 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.modelspec&quot; in &quot;/output/workingdir/l1analysis/_subject_id_06/modelspec&quot;.
250815-11:22:52,630 nipype.workflow INFO:
	 [Node] Running &quot;modelspec&quot; (&quot;nipype.algorithms.modelgen.SpecifySPMModel&quot;)
250815-11:22:52,854 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.modelspec&quot;.
250815-11:22:52,856 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1design&quot; in &quot;/output/workingdir/l1analysis/_subject_id_06/level1design&quot;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/miniconda-latest/envs/neuro/lib/python3.6/site-packages/nipype/algorithms/modelgen.py:491: UserWarning: loadtxt: Empty input file: &quot;/output/workingdir/l1analysis/_subject_id_06/modelspec/art.sub-06_ses-test_task-fingerfootlips_bold_outliers.txt&quot;
  outindices = np.loadtxt(filename, dtype=int)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>250815-11:22:53,22 nipype.workflow INFO:
	 [Node] Running &quot;level1design&quot; (&quot;nipype.interfaces.spm.model.Level1Design&quot;)
250815-11:23:29,390 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1design&quot;.
250815-11:23:29,392 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1estimate&quot; in &quot;/output/workingdir/l1analysis/_subject_id_06/level1estimate&quot;.
250815-11:23:29,632 nipype.workflow INFO:
	 [Node] Running &quot;level1estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-11:24:16,364 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1estimate&quot;.
250815-11:24:16,367 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1conest&quot; in &quot;/output/workingdir/l1analysis/_subject_id_06/level1conest&quot;.
250815-11:24:17,823 nipype.workflow INFO:
	 [Node] Running &quot;level1conest&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-11:24:31,958 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1conest&quot;.
250815-11:24:31,960 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.datasink&quot; in &quot;/output/workingdir/l1analysis/_subject_id_06/datasink&quot;.
250815-11:24:32,492 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-11:24:32,502 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/SPM.mat -&gt; /output/datasink/1stLevel/sub-06/SPM.mat
250815-11:24:32,538 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/spmT_0001.nii -&gt; /output/datasink/1stLevel/sub-06/spmT_0001.nii
250815-11:24:32,563 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/spmT_0002.nii -&gt; /output/datasink/1stLevel/sub-06/spmT_0002.nii
250815-11:24:32,584 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/spmT_0003.nii -&gt; /output/datasink/1stLevel/sub-06/spmT_0003.nii
250815-11:24:32,603 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/spmT_0004.nii -&gt; /output/datasink/1stLevel/sub-06/spmT_0004.nii
250815-11:24:32,622 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/spmT_0005.nii -&gt; /output/datasink/1stLevel/sub-06/spmT_0005.nii
250815-11:24:32,640 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-06/spmF_0006.nii
250815-11:24:32,666 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/con_0001.nii -&gt; /output/datasink/1stLevel/sub-06/con_0001.nii
250815-11:24:32,715 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/con_0002.nii -&gt; /output/datasink/1stLevel/sub-06/con_0002.nii
250815-11:24:32,735 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/con_0003.nii -&gt; /output/datasink/1stLevel/sub-06/con_0003.nii
250815-11:24:32,755 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/con_0004.nii -&gt; /output/datasink/1stLevel/sub-06/con_0004.nii
250815-11:24:32,774 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/con_0005.nii -&gt; /output/datasink/1stLevel/sub-06/con_0005.nii
250815-11:24:32,794 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-06/ess_0006.nii
250815-11:24:32,812 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-06/spmF_0006.nii
250815-11:24:32,832 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_06/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-06/ess_0006.nii
250815-11:24:33,40 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.datasink&quot;.
250815-11:24:33,42 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.getsubjectinfo&quot; in &quot;/output/workingdir/l1analysis/_subject_id_05/getsubjectinfo&quot;.
250815-11:24:33,108 nipype.workflow INFO:
	 [Node] Running &quot;getsubjectinfo&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
250815-11:24:33,257 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.getsubjectinfo&quot;.
250815-11:24:33,260 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.selectfiles&quot; in &quot;/output/workingdir/l1analysis/_subject_id_05/selectfiles&quot;.
250815-11:24:33,326 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-11:24:33,486 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.selectfiles&quot;.
250815-11:24:33,488 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.modelspec&quot; in &quot;/output/workingdir/l1analysis/_subject_id_05/modelspec&quot;.
250815-11:24:33,903 nipype.workflow INFO:
	 [Node] Running &quot;modelspec&quot; (&quot;nipype.algorithms.modelgen.SpecifySPMModel&quot;)
250815-11:24:34,102 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.modelspec&quot;.
250815-11:24:34,104 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1design&quot; in &quot;/output/workingdir/l1analysis/_subject_id_05/level1design&quot;.
250815-11:24:34,341 nipype.workflow INFO:
	 [Node] Running &quot;level1design&quot; (&quot;nipype.interfaces.spm.model.Level1Design&quot;)
250815-11:25:11,308 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1design&quot;.
250815-11:25:11,311 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1estimate&quot; in &quot;/output/workingdir/l1analysis/_subject_id_05/level1estimate&quot;.
250815-11:25:11,629 nipype.workflow INFO:
	 [Node] Running &quot;level1estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-11:25:58,275 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1estimate&quot;.
250815-11:25:58,277 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1conest&quot; in &quot;/output/workingdir/l1analysis/_subject_id_05/level1conest&quot;.
250815-11:26:00,186 nipype.workflow INFO:
	 [Node] Running &quot;level1conest&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-11:26:14,417 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1conest&quot;.
250815-11:26:14,419 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.datasink&quot; in &quot;/output/workingdir/l1analysis/_subject_id_05/datasink&quot;.
250815-11:26:14,907 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-11:26:14,918 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/SPM.mat -&gt; /output/datasink/1stLevel/sub-05/SPM.mat
250815-11:26:14,944 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/spmT_0001.nii -&gt; /output/datasink/1stLevel/sub-05/spmT_0001.nii
250815-11:26:14,965 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/spmT_0002.nii -&gt; /output/datasink/1stLevel/sub-05/spmT_0002.nii
250815-11:26:14,987 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/spmT_0003.nii -&gt; /output/datasink/1stLevel/sub-05/spmT_0003.nii
250815-11:26:15,5 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/spmT_0004.nii -&gt; /output/datasink/1stLevel/sub-05/spmT_0004.nii
250815-11:26:15,21 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/spmT_0005.nii -&gt; /output/datasink/1stLevel/sub-05/spmT_0005.nii
250815-11:26:15,41 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-05/spmF_0006.nii
250815-11:26:15,61 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/con_0001.nii -&gt; /output/datasink/1stLevel/sub-05/con_0001.nii
250815-11:26:15,85 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/con_0002.nii -&gt; /output/datasink/1stLevel/sub-05/con_0002.nii
250815-11:26:15,111 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/con_0003.nii -&gt; /output/datasink/1stLevel/sub-05/con_0003.nii
250815-11:26:15,140 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/con_0004.nii -&gt; /output/datasink/1stLevel/sub-05/con_0004.nii
250815-11:26:15,165 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/con_0005.nii -&gt; /output/datasink/1stLevel/sub-05/con_0005.nii
250815-11:26:15,189 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-05/ess_0006.nii
250815-11:26:15,210 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-05/spmF_0006.nii
250815-11:26:15,231 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_05/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-05/ess_0006.nii
250815-11:26:15,452 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.datasink&quot;.
250815-11:26:15,455 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.getsubjectinfo&quot; in &quot;/output/workingdir/l1analysis/_subject_id_04/getsubjectinfo&quot;.
250815-11:26:15,524 nipype.workflow INFO:
	 [Node] Running &quot;getsubjectinfo&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
250815-11:26:15,639 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.getsubjectinfo&quot;.
250815-11:26:15,641 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.selectfiles&quot; in &quot;/output/workingdir/l1analysis/_subject_id_04/selectfiles&quot;.
250815-11:26:15,699 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-11:26:15,830 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.selectfiles&quot;.
250815-11:26:15,831 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.modelspec&quot; in &quot;/output/workingdir/l1analysis/_subject_id_04/modelspec&quot;.
250815-11:26:16,238 nipype.workflow INFO:
	 [Node] Running &quot;modelspec&quot; (&quot;nipype.algorithms.modelgen.SpecifySPMModel&quot;)
250815-11:26:16,423 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.modelspec&quot;.
250815-11:26:16,425 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1design&quot; in &quot;/output/workingdir/l1analysis/_subject_id_04/level1design&quot;.
250815-11:26:16,721 nipype.workflow INFO:
	 [Node] Running &quot;level1design&quot; (&quot;nipype.interfaces.spm.model.Level1Design&quot;)
250815-11:26:57,29 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1design&quot;.
250815-11:26:57,33 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1estimate&quot; in &quot;/output/workingdir/l1analysis/_subject_id_04/level1estimate&quot;.
250815-11:26:57,376 nipype.workflow INFO:
	 [Node] Running &quot;level1estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-11:27:45,476 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1estimate&quot;.
250815-11:27:45,480 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1conest&quot; in &quot;/output/workingdir/l1analysis/_subject_id_04/level1conest&quot;.
250815-11:27:47,680 nipype.workflow INFO:
	 [Node] Running &quot;level1conest&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-11:28:03,828 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1conest&quot;.
250815-11:28:03,831 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.datasink&quot; in &quot;/output/workingdir/l1analysis/_subject_id_04/datasink&quot;.
250815-11:28:04,365 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-11:28:04,372 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/SPM.mat -&gt; /output/datasink/1stLevel/sub-04/SPM.mat
250815-11:28:04,396 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/spmT_0001.nii -&gt; /output/datasink/1stLevel/sub-04/spmT_0001.nii
250815-11:28:04,413 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/spmT_0002.nii -&gt; /output/datasink/1stLevel/sub-04/spmT_0002.nii
250815-11:28:04,430 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/spmT_0003.nii -&gt; /output/datasink/1stLevel/sub-04/spmT_0003.nii
250815-11:28:04,447 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/spmT_0004.nii -&gt; /output/datasink/1stLevel/sub-04/spmT_0004.nii
250815-11:28:04,464 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/spmT_0005.nii -&gt; /output/datasink/1stLevel/sub-04/spmT_0005.nii
250815-11:28:04,480 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-04/spmF_0006.nii
250815-11:28:04,496 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/con_0001.nii -&gt; /output/datasink/1stLevel/sub-04/con_0001.nii
250815-11:28:04,512 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/con_0002.nii -&gt; /output/datasink/1stLevel/sub-04/con_0002.nii
250815-11:28:04,527 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/con_0003.nii -&gt; /output/datasink/1stLevel/sub-04/con_0003.nii
250815-11:28:04,544 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/con_0004.nii -&gt; /output/datasink/1stLevel/sub-04/con_0004.nii
250815-11:28:04,559 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/con_0005.nii -&gt; /output/datasink/1stLevel/sub-04/con_0005.nii
250815-11:28:04,576 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-04/ess_0006.nii
250815-11:28:04,592 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-04/spmF_0006.nii
250815-11:28:04,608 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_04/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-04/ess_0006.nii
250815-11:28:04,800 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.datasink&quot;.
250815-11:28:04,802 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.getsubjectinfo&quot; in &quot;/output/workingdir/l1analysis/_subject_id_03/getsubjectinfo&quot;.
250815-11:28:04,859 nipype.workflow INFO:
	 [Node] Running &quot;getsubjectinfo&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
250815-11:28:04,964 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.getsubjectinfo&quot;.
250815-11:28:04,966 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.selectfiles&quot; in &quot;/output/workingdir/l1analysis/_subject_id_03/selectfiles&quot;.
250815-11:28:05,19 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-11:28:05,216 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.selectfiles&quot;.
250815-11:28:05,219 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.modelspec&quot; in &quot;/output/workingdir/l1analysis/_subject_id_03/modelspec&quot;.
250815-11:28:05,705 nipype.workflow INFO:
	 [Node] Running &quot;modelspec&quot; (&quot;nipype.algorithms.modelgen.SpecifySPMModel&quot;)
250815-11:28:05,922 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.modelspec&quot;.
250815-11:28:05,924 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1design&quot; in &quot;/output/workingdir/l1analysis/_subject_id_03/level1design&quot;.
250815-11:28:06,144 nipype.workflow INFO:
	 [Node] Running &quot;level1design&quot; (&quot;nipype.interfaces.spm.model.Level1Design&quot;)
250815-11:28:45,418 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1design&quot;.
250815-11:28:45,421 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1estimate&quot; in &quot;/output/workingdir/l1analysis/_subject_id_03/level1estimate&quot;.
250815-11:28:45,710 nipype.workflow INFO:
	 [Node] Running &quot;level1estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-11:29:34,279 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1estimate&quot;.
250815-11:29:34,282 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1conest&quot; in &quot;/output/workingdir/l1analysis/_subject_id_03/level1conest&quot;.
250815-11:29:35,892 nipype.workflow INFO:
	 [Node] Running &quot;level1conest&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-11:29:51,455 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.level1conest&quot;.
250815-11:29:51,457 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.datasink&quot; in &quot;/output/workingdir/l1analysis/_subject_id_03/datasink&quot;.
250815-11:29:52,81 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-11:29:52,93 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/SPM.mat -&gt; /output/datasink/1stLevel/sub-03/SPM.mat
250815-11:29:52,123 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/spmT_0001.nii -&gt; /output/datasink/1stLevel/sub-03/spmT_0001.nii
250815-11:29:52,145 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/spmT_0002.nii -&gt; /output/datasink/1stLevel/sub-03/spmT_0002.nii
250815-11:29:52,168 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/spmT_0003.nii -&gt; /output/datasink/1stLevel/sub-03/spmT_0003.nii
250815-11:29:52,189 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/spmT_0004.nii -&gt; /output/datasink/1stLevel/sub-03/spmT_0004.nii
250815-11:29:52,212 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/spmT_0005.nii -&gt; /output/datasink/1stLevel/sub-03/spmT_0005.nii
250815-11:29:52,233 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-03/spmF_0006.nii
250815-11:29:52,256 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/con_0001.nii -&gt; /output/datasink/1stLevel/sub-03/con_0001.nii
250815-11:29:52,277 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/con_0002.nii -&gt; /output/datasink/1stLevel/sub-03/con_0002.nii
250815-11:29:52,320 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/con_0003.nii -&gt; /output/datasink/1stLevel/sub-03/con_0003.nii
250815-11:29:52,345 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/con_0004.nii -&gt; /output/datasink/1stLevel/sub-03/con_0004.nii
250815-11:29:52,364 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/con_0005.nii -&gt; /output/datasink/1stLevel/sub-03/con_0005.nii
250815-11:29:52,385 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-03/ess_0006.nii
250815-11:29:52,408 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-03/spmF_0006.nii
250815-11:29:52,429 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_03/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-03/ess_0006.nii
250815-11:29:52,676 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.datasink&quot;.
250815-11:29:52,679 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.getsubjectinfo&quot; in &quot;/output/workingdir/l1analysis/_subject_id_02/getsubjectinfo&quot;.
250815-11:29:52,757 nipype.workflow INFO:
	 [Node] Cached &quot;l1analysis.getsubjectinfo&quot; - collecting precomputed outputs
250815-11:29:52,759 nipype.workflow INFO:
	 [Node] &quot;l1analysis.getsubjectinfo&quot; found cached.
250815-11:29:52,762 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.selectfiles&quot; in &quot;/output/workingdir/l1analysis/_subject_id_02/selectfiles&quot;.
250815-11:29:52,891 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-11:29:53,40 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.selectfiles&quot;.
250815-11:29:53,42 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.modelspec&quot; in &quot;/output/workingdir/l1analysis/_subject_id_02/modelspec&quot;.
250815-11:29:53,321 nipype.workflow INFO:
	 [Node] Cached &quot;l1analysis.modelspec&quot; - collecting precomputed outputs
250815-11:29:53,324 nipype.workflow INFO:
	 [Node] &quot;l1analysis.modelspec&quot; found cached.
250815-11:29:53,327 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1design&quot; in &quot;/output/workingdir/l1analysis/_subject_id_02/level1design&quot;.
250815-11:29:53,508 nipype.workflow INFO:
	 [Node] Cached &quot;l1analysis.level1design&quot; - collecting precomputed outputs
250815-11:29:53,510 nipype.workflow INFO:
	 [Node] &quot;l1analysis.level1design&quot; found cached.
250815-11:29:53,512 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1estimate&quot; in &quot;/output/workingdir/l1analysis/_subject_id_02/level1estimate&quot;.
250815-11:29:53,825 nipype.workflow INFO:
	 [Node] Cached &quot;l1analysis.level1estimate&quot; - collecting precomputed outputs
250815-11:29:53,827 nipype.workflow INFO:
	 [Node] &quot;l1analysis.level1estimate&quot; found cached.
250815-11:29:53,828 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1conest&quot; in &quot;/output/workingdir/l1analysis/_subject_id_02/level1conest&quot;.
250815-11:29:55,247 nipype.workflow INFO:
	 [Node] Cached &quot;l1analysis.level1conest&quot; - collecting precomputed outputs
250815-11:29:55,249 nipype.workflow INFO:
	 [Node] &quot;l1analysis.level1conest&quot; found cached.
250815-11:29:55,252 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.datasink&quot; in &quot;/output/workingdir/l1analysis/_subject_id_02/datasink&quot;.
250815-11:29:56,22 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-11:29:56,30 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/SPM.mat -&gt; /output/datasink/1stLevel/sub-02/SPM.mat
250815-11:29:56,52 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/spmT_0001.nii -&gt; /output/datasink/1stLevel/sub-02/spmT_0001.nii
250815-11:29:56,88 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/spmT_0002.nii -&gt; /output/datasink/1stLevel/sub-02/spmT_0002.nii
250815-11:29:56,109 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/spmT_0003.nii -&gt; /output/datasink/1stLevel/sub-02/spmT_0003.nii
250815-11:29:56,156 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/spmT_0004.nii -&gt; /output/datasink/1stLevel/sub-02/spmT_0004.nii
250815-11:29:56,177 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/spmT_0005.nii -&gt; /output/datasink/1stLevel/sub-02/spmT_0005.nii
250815-11:29:56,198 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-02/spmF_0006.nii
250815-11:29:56,219 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/con_0001.nii -&gt; /output/datasink/1stLevel/sub-02/con_0001.nii
250815-11:29:56,238 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/con_0002.nii -&gt; /output/datasink/1stLevel/sub-02/con_0002.nii
250815-11:29:56,256 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/con_0003.nii -&gt; /output/datasink/1stLevel/sub-02/con_0003.nii
250815-11:29:56,277 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/con_0004.nii -&gt; /output/datasink/1stLevel/sub-02/con_0004.nii
250815-11:29:56,296 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/con_0005.nii -&gt; /output/datasink/1stLevel/sub-02/con_0005.nii
250815-11:29:56,316 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-02/ess_0006.nii
250815-11:29:56,335 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-02/spmF_0006.nii
250815-11:29:56,353 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_02/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-02/ess_0006.nii
250815-11:29:56,606 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.datasink&quot;.
250815-11:29:56,609 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.getsubjectinfo&quot; in &quot;/output/workingdir/l1analysis/_subject_id_01/getsubjectinfo&quot;.
250815-11:29:56,682 nipype.workflow INFO:
	 [Node] Cached &quot;l1analysis.getsubjectinfo&quot; - collecting precomputed outputs
250815-11:29:56,684 nipype.workflow INFO:
	 [Node] &quot;l1analysis.getsubjectinfo&quot; found cached.
250815-11:29:56,686 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.selectfiles&quot; in &quot;/output/workingdir/l1analysis/_subject_id_01/selectfiles&quot;.
250815-11:29:56,825 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-11:29:57,14 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.selectfiles&quot;.
250815-11:29:57,15 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.modelspec&quot; in &quot;/output/workingdir/l1analysis/_subject_id_01/modelspec&quot;.
250815-11:29:57,247 nipype.workflow INFO:
	 [Node] Cached &quot;l1analysis.modelspec&quot; - collecting precomputed outputs
250815-11:29:57,249 nipype.workflow INFO:
	 [Node] &quot;l1analysis.modelspec&quot; found cached.
250815-11:29:57,255 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1design&quot; in &quot;/output/workingdir/l1analysis/_subject_id_01/level1design&quot;.
250815-11:29:57,472 nipype.workflow INFO:
	 [Node] Cached &quot;l1analysis.level1design&quot; - collecting precomputed outputs
250815-11:29:57,474 nipype.workflow INFO:
	 [Node] &quot;l1analysis.level1design&quot; found cached.
250815-11:29:57,477 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1estimate&quot; in &quot;/output/workingdir/l1analysis/_subject_id_01/level1estimate&quot;.
250815-11:29:57,867 nipype.workflow INFO:
	 [Node] Cached &quot;l1analysis.level1estimate&quot; - collecting precomputed outputs
250815-11:29:57,869 nipype.workflow INFO:
	 [Node] &quot;l1analysis.level1estimate&quot; found cached.
250815-11:29:57,872 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.level1conest&quot; in &quot;/output/workingdir/l1analysis/_subject_id_01/level1conest&quot;.
250815-11:29:59,78 nipype.workflow INFO:
	 [Node] Cached &quot;l1analysis.level1conest&quot; - collecting precomputed outputs
250815-11:29:59,80 nipype.workflow INFO:
	 [Node] &quot;l1analysis.level1conest&quot; found cached.
250815-11:29:59,82 nipype.workflow INFO:
	 [Node] Setting-up &quot;l1analysis.datasink&quot; in &quot;/output/workingdir/l1analysis/_subject_id_01/datasink&quot;.
250815-11:29:59,701 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-11:29:59,709 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/SPM.mat -&gt; /output/datasink/1stLevel/sub-01/SPM.mat
250815-11:29:59,731 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/spmT_0001.nii -&gt; /output/datasink/1stLevel/sub-01/spmT_0001.nii
250815-11:29:59,752 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/spmT_0002.nii -&gt; /output/datasink/1stLevel/sub-01/spmT_0002.nii
250815-11:29:59,775 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/spmT_0003.nii -&gt; /output/datasink/1stLevel/sub-01/spmT_0003.nii
250815-11:29:59,794 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/spmT_0004.nii -&gt; /output/datasink/1stLevel/sub-01/spmT_0004.nii
250815-11:29:59,815 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/spmT_0005.nii -&gt; /output/datasink/1stLevel/sub-01/spmT_0005.nii
250815-11:29:59,836 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-01/spmF_0006.nii
250815-11:29:59,857 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/con_0001.nii -&gt; /output/datasink/1stLevel/sub-01/con_0001.nii
250815-11:29:59,875 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/con_0002.nii -&gt; /output/datasink/1stLevel/sub-01/con_0002.nii
250815-11:29:59,895 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/con_0003.nii -&gt; /output/datasink/1stLevel/sub-01/con_0003.nii
250815-11:29:59,918 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/con_0004.nii -&gt; /output/datasink/1stLevel/sub-01/con_0004.nii
250815-11:29:59,940 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/con_0005.nii -&gt; /output/datasink/1stLevel/sub-01/con_0005.nii
250815-11:29:59,960 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-01/ess_0006.nii
250815-11:29:59,981 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/spmF_0006.nii -&gt; /output/datasink/1stLevel/sub-01/spmF_0006.nii
250815-11:30:00,2 nipype.interface INFO:
	 sub: /output/datasink/1stLevel/_subject_id_01/ess_0006.nii -&gt; /output/datasink/1stLevel/sub-01/ess_0006.nii
250815-11:30:00,248 nipype.workflow INFO:
	 [Node] Finished &quot;l1analysis.datasink&quot;.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;networkx.classes.digraph.DiGraph at 0x7f17fec6beb8&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Crashs information is stored in .pklz files</span>
<span class="c1"># In case of a crash use the following command</span>
<span class="c1">#!nipypecli crash &lt;Last generated .pklz file&gt;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="inspect-output">
<h2>Inspect output<a class="headerlink" href="#inspect-output" title="Link to this heading">#</a></h2>
<p>Let‚Äôs check the structure of the output folder, to see if we have everything we wanted to save. You should one image for each subject and contrast (<code class="docutils literal notranslate"><span class="pre">con_*.nii</span></code> for T-contrasts and <code class="docutils literal notranslate"><span class="pre">ess_*.nii</span></code> for F-contrasts)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>tree<span class="w"> </span>/output/datasink/1stLevel
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/output/datasink/1stLevel
‚îú‚îÄ‚îÄ sub-01
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0004.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0005.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ess_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmF_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ SPM.mat
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0004.nii
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ spmT_0005.nii
‚îú‚îÄ‚îÄ sub-02
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0004.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0005.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ess_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmF_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ SPM.mat
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0004.nii
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ spmT_0005.nii
‚îú‚îÄ‚îÄ sub-03
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0004.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0005.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ess_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmF_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ SPM.mat
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0004.nii
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ spmT_0005.nii
‚îú‚îÄ‚îÄ sub-04
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0004.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0005.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ess_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmF_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ SPM.mat
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0004.nii
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ spmT_0005.nii
‚îú‚îÄ‚îÄ sub-05
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0004.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0005.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ess_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmF_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ SPM.mat
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0004.nii
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ spmT_0005.nii
‚îú‚îÄ‚îÄ sub-06
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0004.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0005.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ess_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmF_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ SPM.mat
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0004.nii
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ spmT_0005.nii
‚îú‚îÄ‚îÄ sub-07
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0004.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0005.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ess_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmF_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ SPM.mat
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0004.nii
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ spmT_0005.nii
‚îú‚îÄ‚îÄ sub-08
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0004.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0005.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ess_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmF_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ SPM.mat
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0004.nii
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ spmT_0005.nii
‚îú‚îÄ‚îÄ sub-09
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0004.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ con_0005.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ ess_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmF_0006.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ SPM.mat
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0001.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0002.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0003.nii
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ spmT_0004.nii
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ spmT_0005.nii
‚îî‚îÄ‚îÄ sub-10
    ‚îú‚îÄ‚îÄ con_0001.nii
    ‚îú‚îÄ‚îÄ con_0002.nii
    ‚îú‚îÄ‚îÄ con_0003.nii
    ‚îú‚îÄ‚îÄ con_0004.nii
    ‚îú‚îÄ‚îÄ con_0005.nii
    ‚îú‚îÄ‚îÄ ess_0006.nii
    ‚îú‚îÄ‚îÄ spmF_0006.nii
    ‚îú‚îÄ‚îÄ SPM.mat
    ‚îú‚îÄ‚îÄ spmT_0001.nii
    ‚îú‚îÄ‚îÄ spmT_0002.nii
    ‚îú‚îÄ‚îÄ spmT_0003.nii
    ‚îú‚îÄ‚îÄ spmT_0004.nii
    ‚îî‚îÄ‚îÄ spmT_0005.nii

10 directories, 130 files
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-results">
<h2>Visualize results<a class="headerlink" href="#visualize-results" title="Link to this heading">#</a></h2>
<p>Let‚Äôs look at the contrasts of one subject that we‚Äôve just computed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">nilearn.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_stat_map</span>

<span class="c1">#Reminder the tests were </span>
<span class="n">test_to_number</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Finger&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Foot&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;Lips&#39;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;Foot &gt; others&#39;</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;activation&#39;</span>
    <span class="p">}</span>
<span class="n">subject_id</span> <span class="o">=</span> <span class="s1">&#39;01&#39;</span>
<span class="n">anatimg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/data/ds000114/derivatives/fmriprep/sub-</span><span class="si">{</span><span class="n">subject_id</span><span class="si">}</span><span class="s1">/anat/sub-</span><span class="si">{</span><span class="n">subject_id</span><span class="si">}</span><span class="s1">_t1w_preproc.nii.gz&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subject_id</span> <span class="o">=</span> <span class="s1">&#39;01&#39;</span>
 
<span class="n">anatimg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/data/ds000114/derivatives/fmriprep/sub-</span><span class="si">{</span><span class="n">subject_id</span><span class="si">}</span><span class="s1">/anat/sub-</span><span class="si">{</span><span class="n">subject_id</span><span class="si">}</span><span class="s1">_t1w_preproc.nii.gz&#39;</span>
<span class="k">for</span> <span class="n">contrast_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
    <span class="n">plot_stat_map</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;/output/datasink/1stLevel/sub-</span><span class="si">{</span><span class="n">subject_id</span><span class="si">}</span><span class="s1">/spmT_000</span><span class="si">{</span><span class="n">contrast_id</span><span class="si">}</span><span class="s1">.nii&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">test_to_number</span><span class="p">[</span><span class="n">contrast_id</span><span class="p">],</span>
        <span class="n">bg_img</span><span class="o">=</span><span class="n">anatimg</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ca5cda7adb493549b7ecca24c32eb87b84bce8f3307269fa0411f2215257550d.png" src="../_images/ca5cda7adb493549b7ecca24c32eb87b84bce8f3307269fa0411f2215257550d.png" />
<img alt="../_images/3b01ba3469a71292d004f1271dc41ac0a7cad517841a36a5ac092369835b067e.png" src="../_images/3b01ba3469a71292d004f1271dc41ac0a7cad517841a36a5ac092369835b067e.png" />
<img alt="../_images/d9cd269465eb3f0dcff385629d17b16a9267c07669f3b3b7fcc28afe59dbee0f.png" src="../_images/d9cd269465eb3f0dcff385629d17b16a9267c07669f3b3b7fcc28afe59dbee0f.png" />
<img alt="../_images/4ef0cd7fa4f3057cefd08a5aaa617dcb7c49c3ef8115daa9fb47bbd808170d53.png" src="../_images/4ef0cd7fa4f3057cefd08a5aaa617dcb7c49c3ef8115daa9fb47bbd808170d53.png" />
<img alt="../_images/88252fcd0160af825527bc002e24788c1d2a64c7ab3bc75171ca74b00246d618.png" src="../_images/88252fcd0160af825527bc002e24788c1d2a64c7ab3bc75171ca74b00246d618.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contrast_id</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">subject_id</span> <span class="o">=</span> <span class="s1">&#39;01&#39;</span>

<span class="n">plot_stat_map</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;/output/datasink/1stLevel/sub-</span><span class="si">{</span><span class="n">subject_id</span><span class="si">}</span><span class="s1">/spmF_000</span><span class="si">{</span><span class="n">contrast_id</span><span class="si">}</span><span class="s1">.nii&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">test_to_number</span><span class="p">[</span><span class="n">contrast_id</span><span class="p">],</span>
        <span class="n">bg_img</span><span class="o">=</span><span class="n">anatimg</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5c245779146ef77a3013b8d90029aa5c1c278c56ec4afba2bf2fe11ed60073cd.png" src="../_images/5c245779146ef77a3013b8d90029aa5c1c278c56ec4afba2bf2fe11ed60073cd.png" />
</div>
</div>
<p>The results of the <code class="docutils literal notranslate"><span class="pre">F-test</span></code> are displayed ‚Äústrangely‚Äù for any reason.</p>
<p><strong>Sources:</strong></p>
<p><a class="reference external" href="https://www.fmrib.ox.ac.uk/primers/appendices/glm.pdf">General Linear Model for Neuroimaging</a></p>
<p><a class="reference external" href="https://practical-neuroimaging.github.io/on_convolution.html">Convolution</a></p>
<p><a class="reference external" href="http://mriquestions.com/general-linear-model.html">General Linear Model (GLM)</a></p>
<p><strong>Special thanks to Michael Notter for the wonderful <a class="reference external" href="https://miykael.github.io/nipype_tutorial/">nipype tutorial</a></strong></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./seminars6_7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">GLM: 1st-level Analysis</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#st-level-analysis-in-nipype">1st Level Analysis in Nipype</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-design-matrix">Prepare design matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initiate-nodes">Initiate Nodes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-contrasts">Specify contrasts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-input-output-stream">Specify input &amp; output stream</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-workflow">Specify Workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-workflow">Visualize the workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-workflow">Run the Workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-output">Inspect output</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-results">Visualize results</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nadezhda Alsahanova, Aleksandra Beliaeva
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>