
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Group Analysis &#8212; Neuroimaging and Machine Learning for Biomedicine</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myadmonitions.css?v=0009bf62" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'seminars6_7/GroupAnalysis';</script>
    <link rel="icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Neuroimaging and Machine Learning for Biomedicine - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Neuroimaging and Machine Learning for Biomedicine - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to the Neuroimaging and Machine Learning for Biomedicine coursebook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../bio/intro_links.html">Links</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1AM67Sd37J0hIJ-kLyzAZRm8op_JcUQ9b?usp=sharing">Intro to shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar1/Seminar1_python_colab.html">How to work with Python</a></li>




<li class="toctree-l1"><a class="reference internal" href="../seminar1/Seminar1_ML.html">Intro to ML</a></li>

















<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1jkf4Jt0QvDz2O7UoZ-sZAi0V0oke5Yju?usp=sharing">Machine learning fundamentals on medical data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar1/00_pytorch_fundamentals.html">Pytorch fundamentals</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1q0XncKq2y_wHLXJaxhjfBCDGHABmzrjM/view?usp=sharing">Intro to computer vision</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminar 1. Opening Seminar</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../seminar1/intro.html">Lecture Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar1/opening_seminar.html">Motivation &amp; Overview</a></li>










</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminars 2-3. Working with EEG</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../seminars2_3/seminar1_working_with_eeg_ipynb_.html">Seminars 2 and 3. EEG analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminars 4-5. Working with MRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../seminar4/docker.html">Preparation to Seminar 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar4/seminar4_1_mri.html">Seminar 4.1. MRI data analysis, databases and tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seminar4/seminar4_2_transform.html">Transformations</a></li>





<li class="toctree-l1"><a class="reference internal" href="../seminar4/seminar4_3_freesurfer.html">FREESURFER</a></li>


<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/16--0U-QRcPJaWYqUe1RP5_V4zGvGOR76/view?usp=sharing">Seminar 5.1. MRI classification with classic ML</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1XMxW_Y73mbMGFIaWY6YlEfscD8YE35yN/view?usp=sharing">Seminar 5.2. MRI classification with 3D CNN</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/15M13NfhCGKN6akaWj8reFYvfDH7aLPsY/view?usp=sharing">Seminar 5.3. MRI segmentation with 3D U-net</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminars 6-8. Working with fMRI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="README.html">Preparation to Seminar 6-8</a></li>
<li class="toctree-l1"><a class="reference internal" href="seminars_content.html">Summary of Seminar 6-7</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1kSrmaPF5_bKvH1xEKgp0BMtpnm_I-DtY/view?usp=drive_link">Seminar 6. Preprocessing pipeline for task-based fMRI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1-9hT7K9lG_pUTIgtjwH7pvxL1mf9QnMP/view?usp=drive_link">Seminar 7.1. 1st-level fMRI data analysis</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1EuyJWzhmST66rDVugbRgsm_p8Jpc7KTQ/view?usp=drive_link">Seminar 7.2. 2st-level (Group) Analysis</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1Hed2ggYNbyvBMeYpNeapMAepxeQBVLRL?usp=sharing">Seminar 8.1. Analyze task-based fMRI for motor and emotion task</a></li>
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1F0UzTsmF1NK6F3NEsJHUw9G5K3j_-eYA?usp=sharing">Seminar 8.2. Functional connectivity</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Seminar 9. Interpretation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://colab.research.google.com/drive/1yMqKV14iPrhREWP7veNMTIHUKyLoic5-">Seminar 9. Interpretation of 3D CNNs for Brain MRI Data Classification</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BIMAI-lab/NEUROML_course" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BIMAI-lab/NEUROML_course/issues/new?title=Issue%20on%20page%20%2Fseminars6_7/GroupAnalysis.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/seminars6_7/GroupAnalysis.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Group Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Group Analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-data-to-mni-template">Normalize data to MNI template</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation">Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alternatively-prepare-yourself">Alternatively: Prepare yourself</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalization-with-ants">Normalization with ANTs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-parameters">Experiment parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-nodes">Specify Nodes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-input-output-stream">Specify input &amp; output stream</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-workflow-ants">Specify Workflow (ANTs)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-workflow">Visualize the workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-workflow">Run the Workflow</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-results">Visualize Results</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#nd-level-analysis">2nd level analysis</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-comparison-problem">Multiple comparison problem</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="group-analysis">
<h1>Group Analysis<a class="headerlink" href="#group-analysis" title="Link to this heading">#</a></h1>
<p>We often want to generalize the results from our experiment to out of sample data. Here we will infer from the individual
subjects activation maps to one activation map for all subjects.</p>
<p>To do this the following steps must be done:</p>
<p><strong>1. Normalize the subjects data to a common space</strong></p>
<p><strong>2. Build a second level GLM</strong></p>
<p><strong>3. Hypothesis testing</strong></p>
<p><img alt="Group Analysis" src="https://s3.studylib.net/store/data/008208763_1-08a21265815c4e2c11a8b6effd90bfa3.png" /></p>
<p>The second level GLM has the form
$<span class="math notranslate nohighlight">\( {\beta}= {\beta}_g X_g + {\eta} \)</span>$</p>
<p>where:</p>
<p><span class="math notranslate nohighlight">\(X_g\)</span> - new design matrix</p>
<p><span class="math notranslate nohighlight">\({\beta}\)</span> - estimated from 1st level</p>
<p>Then we can find <span class="math notranslate nohighlight">\({\beta}_g\)</span> and perform hypothesis testing on it</p>
<p><strong>NI-ed</strong> is a collection of neuroimaging-related course materials developed at the University of Amsterdam (Great Explanation) - <a class="reference external" href="https://lukas-snoek.com/NI-edu/section_intros/5_multilevel.html">https://lukas-snoek.com/NI-edu/section_intros/5_multilevel.html</a></p>
<section id="normalize-data-to-mni-template">
<h2>Normalize data to MNI template<a class="headerlink" href="#normalize-data-to-mni-template" title="Link to this heading">#</a></h2>
<p>We will take the computed 1st-level contrasts from the previous experiment  and normalize them into MNI-space.</p>
</section>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Link to this heading">#</a></h2>
<p>We first need to download the already computed deformation field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
datalad get -J 4 -d /data/ds000114 /data/ds000114/derivatives/fmriprep/sub-0[2345789]/anat/*h5
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bash: line 1: datalad: command not found
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">CalledProcessError</span><span class="g g-Whitespace">                        </span>Traceback (most recent call last)
<span class="nn">Input In [1],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_cell_magic</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;datalad get -J 4 -d /data/ds000114 /data/ds000114/derivatives/fmriprep/sub-0[2345789]/anat/*h5</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py:2347,</span> in <span class="ni">InteractiveShell.run_cell_magic</span><span class="nt">(self, magic_name, line, cell)</span>
<span class="g g-Whitespace">   </span><span class="mi">2345</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2346</span>     <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">magic_arg_s</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2347</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2348</span> <span class="k">return</span> <span class="n">result</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/IPython/core/magics/script.py:153,</span> in <span class="ni">ScriptMagics._make_script_magic.&lt;locals&gt;.named_script_magic</span><span class="nt">(line, cell)</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span>     <span class="n">line</span> <span class="o">=</span> <span class="n">script</span>
<span class="ne">--&gt; </span><span class="mi">153</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shebang</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/IPython/core/magics/script.py:305,</span> in <span class="ni">ScriptMagics.shebang</span><span class="nt">(self, line, cell)</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span> <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">raise_error</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>     <span class="c1"># If we get here and p.returncode is still None, we must have</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span>     <span class="c1"># killed it but not yet seen its return code. We don&#39;t wait for it,</span>
<span class="g g-Whitespace">    </span><span class="mi">303</span>     <span class="c1"># in case it&#39;s stuck in uninterruptible sleep. -9 = SIGKILL</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span>     <span class="n">rc</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="ow">or</span> <span class="o">-</span><span class="mi">9</span>
<span class="ne">--&gt; </span><span class="mi">305</span>     <span class="k">raise</span> <span class="n">CalledProcessError</span><span class="p">(</span><span class="n">rc</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>

<span class="ne">CalledProcessError</span>: Command &#39;b&#39;datalad get -J 4 -d /data/ds000114 /data/ds000114/derivatives/fmriprep/sub-0[2345789]/anat/*h5\n&#39;&#39; returned non-zero exit status 127.
</pre></div>
</div>
</div>
</div>
<section id="alternatively-prepare-yourself">
<h3>Alternatively: Prepare yourself<a class="headerlink" href="#alternatively-prepare-yourself" title="Link to this heading">#</a></h3>
<p>We’re using the precomputed warp field from <a class="reference external" href="http://fmriprep.readthedocs.io">fmriprep</a>, as this step otherwise would take up too much time. If you’re nonetheless interested in computing the warp parameters with ANTs yourself, without using <a class="reference external" href="http://fmriprep.readthedocs.io">fmriprep</a>, either check out the script <a class="reference external" href="https://github.com/miykael/nipype_tutorial/blob/master/notebooks/scripts/ANTS_registration.py">ANTS_registration.py</a> or even quicker, use <a class="reference external" href="http://nipype.readthedocs.io/en/latest/interfaces/generated/interfaces.ants/registration.html#registrationsynquick">RegistrationSynQuick</a>, Nipype’s implementation of <code class="docutils literal notranslate"><span class="pre">antsRegistrationSynQuick.sh</span></code>.</p>
</section>
</section>
<section id="normalization-with-ants">
<h2>Normalization with ANTs<a class="headerlink" href="#normalization-with-ants" title="Link to this heading">#</a></h2>
<p>The normalization with ANTs requires that you first compute the transformation matrix that would bring the anatomical images of each subject into template space. Depending on your system this might take a few hours per subject. To facilitate this step, the transformation matrix is already computed for the T1 images.</p>
<p>The data for it can be found under:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls<span class="w"> </span>/data/ds000114/derivatives/fmriprep/sub-*/anat/*h5
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/data/ds000114/derivatives/fmriprep/sub-01/anat/sub-01_t1w_space-mni152nlin2009casym_warp.h5
/data/ds000114/derivatives/fmriprep/sub-02/anat/sub-02_t1w_space-mni152nlin2009casym_warp.h5
/data/ds000114/derivatives/fmriprep/sub-03/anat/sub-03_t1w_space-mni152nlin2009casym_warp.h5
/data/ds000114/derivatives/fmriprep/sub-04/anat/sub-04_t1w_space-mni152nlin2009casym_warp.h5
/data/ds000114/derivatives/fmriprep/sub-05/anat/sub-05_t1w_space-mni152nlin2009casym_warp.h5
/data/ds000114/derivatives/fmriprep/sub-06/anat/sub-06_t1w_space-mni152nlin2009casym_warp.h5
/data/ds000114/derivatives/fmriprep/sub-07/anat/sub-07_t1w_space-mni152nlin2009casym_warp.h5
/data/ds000114/derivatives/fmriprep/sub-08/anat/sub-08_t1w_space-mni152nlin2009casym_warp.h5
/data/ds000114/derivatives/fmriprep/sub-09/anat/sub-09_t1w_space-mni152nlin2009casym_warp.h5
/data/ds000114/derivatives/fmriprep/sub-10/anat/sub-10_t1w_space-mni152nlin2009casym_warp.h5
</pre></div>
</div>
</div>
</div>
<p><strong>Now, let’s start with the ANTs normalization workflow!</strong></p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<p>First, we need to import all the modules we later want to use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">join</span> <span class="k">as</span> <span class="n">opj</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nipype</span><span class="w"> </span><span class="kn">import</span> <span class="n">Workflow</span><span class="p">,</span> <span class="n">Node</span><span class="p">,</span> <span class="n">MapNode</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nipype.interfaces.ants</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApplyTransforms</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nipype.interfaces.utility</span><span class="w"> </span><span class="kn">import</span> <span class="n">IdentityInterface</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nipype.interfaces.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">SelectFiles</span><span class="p">,</span> <span class="n">DataSink</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nipype.interfaces.fsl</span><span class="w"> </span><span class="kn">import</span> <span class="n">Info</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">nilearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">plotting</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span><span class="w"> </span><span class="nn">nipype.interfaces.spm</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">OneSampleTTestDesign</span><span class="p">,</span> <span class="n">EstimateModel</span><span class="p">,</span>
                                   <span class="n">EstimateContrast</span><span class="p">,</span> <span class="n">Threshold</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">nipype.algorithms.misc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gunzip</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="experiment-parameters">
<h2>Experiment parameters<a class="headerlink" href="#experiment-parameters" title="Link to this heading">#</a></h2>
<p>We will run the group analysis without subject <code class="docutils literal notranslate"><span class="pre">sub-01</span></code>, <code class="docutils literal notranslate"><span class="pre">sub-06</span></code> and <code class="docutils literal notranslate"><span class="pre">sub-10</span></code> because they are left-handed.</p>
<p>This is because all subjects were asked to use their dominant hand, either right or left. There were three subjects (<code class="docutils literal notranslate"><span class="pre">sub-01</span></code>, <code class="docutils literal notranslate"><span class="pre">sub-06</span></code> and <code class="docutils literal notranslate"><span class="pre">sub-10</span></code>) that were left-handed.</p>
<p><strong>Because of this, We will use only right-handed subjects for the following anlysis</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">experiment_dir</span> <span class="o">=</span> <span class="s1">&#39;/output&#39;</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;datasink&#39;</span>
<span class="n">working_dir</span> <span class="o">=</span> <span class="s1">&#39;workingdir&#39;</span>

<span class="c1"># list of subject identifiers (remember we use only right handed subjects)</span>
<span class="n">subject_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;02&#39;</span><span class="p">,</span> <span class="s1">&#39;03&#39;</span><span class="p">,</span> <span class="s1">&#39;04&#39;</span><span class="p">,</span> <span class="s1">&#39;05&#39;</span><span class="p">,</span> <span class="s1">&#39;07&#39;</span><span class="p">,</span> <span class="s1">&#39;08&#39;</span><span class="p">,</span> <span class="s1">&#39;09&#39;</span><span class="p">]</span>

<span class="c1"># task name</span>
<span class="n">task_name</span> <span class="o">=</span> <span class="s2">&quot;fingerfootlips&quot;</span>
<span class="n">number_contrasts</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># number of contrast from 1stlevel</span>


<span class="c1"># Template to normalize to</span>
<span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;/data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="specify-nodes">
<h2>Specify Nodes<a class="headerlink" href="#specify-nodes" title="Link to this heading">#</a></h2>
<p>Initiate ANTs interface</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply Transformation - applies the normalization matrix to contrast images</span>
<span class="n">apply2con</span> <span class="o">=</span> <span class="n">MapNode</span><span class="p">(</span><span class="n">ApplyTransforms</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="s1">&#39;--float&#39;</span><span class="p">,</span>
                                    <span class="n">input_image_type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                    <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;BSpline&#39;</span><span class="p">,</span>
                                    <span class="n">invert_transform_flags</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span>
                                    <span class="n">num_threads</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">reference_image</span><span class="o">=</span><span class="n">template</span><span class="p">,</span>
                                    <span class="n">terminal_output</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;apply2con&#39;</span><span class="p">,</span> <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;input_image&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="specify-input-output-stream">
<h2>Specify input &amp; output stream<a class="headerlink" href="#specify-input-output-stream" title="Link to this heading">#</a></h2>
<p>Specify where the input data can be found &amp; where and how to save the output data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Infosource - a function free node to iterate over the list of subject names</span>
<span class="n">infosource</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">IdentityInterface</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;subject_id&#39;</span><span class="p">]),</span>
                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;infosource&quot;</span><span class="p">)</span>
<span class="n">infosource</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <span class="n">subject_list</span><span class="p">)]</span>

<span class="c1"># SelectFiles - to grab the data (alternativ to DataGrabber)</span>
<span class="n">templates</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:</span> <span class="n">opj</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s1">&#39;1stLevel&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;sub-</span><span class="si">{subject_id}</span><span class="s1">/&#39;</span><span class="p">,</span> <span class="s1">&#39;???_00??.nii&#39;</span><span class="p">),</span>
             <span class="s1">&#39;transform&#39;</span><span class="p">:</span> <span class="n">opj</span><span class="p">(</span><span class="s1">&#39;/data/ds000114/derivatives/fmriprep/&#39;</span><span class="p">,</span> <span class="s1">&#39;sub-</span><span class="si">{subject_id}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;anat&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;sub-</span><span class="si">{subject_id}</span><span class="s1">_t1w_space-mni152nlin2009casym_warp.h5&#39;</span><span class="p">)}</span>
<span class="n">selectfiles</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SelectFiles</span><span class="p">(</span><span class="n">templates</span><span class="p">,</span>
                               <span class="n">base_directory</span><span class="o">=</span><span class="n">experiment_dir</span><span class="p">,</span>
                               <span class="n">sort_filelist</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                   <span class="n">name</span><span class="o">=</span><span class="s2">&quot;selectfiles&quot;</span><span class="p">)</span>

<span class="c1"># Datasink - creates output folder for important outputs</span>
<span class="n">datasink</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DataSink</span><span class="p">(</span><span class="n">base_directory</span><span class="o">=</span><span class="n">experiment_dir</span><span class="p">,</span>
                         <span class="n">container</span><span class="o">=</span><span class="n">output_dir</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;datasink&quot;</span><span class="p">)</span>

<span class="c1"># Use the following DataSink output substitutions</span>
<span class="n">substitutions</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;_subject_id_&#39;</span><span class="p">,</span> <span class="s1">&#39;sub-&#39;</span><span class="p">)]</span>
<span class="n">subjFolders</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;_apply2con</span><span class="si">%s</span><span class="s1">/&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_contrasts</span><span class="p">)]</span> 
<span class="n">substitutions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">subjFolders</span><span class="p">)</span>
<span class="n">datasink</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">substitutions</span> <span class="o">=</span> <span class="n">substitutions</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="specify-workflow-ants">
<h2>Specify Workflow (ANTs)<a class="headerlink" href="#specify-workflow-ants" title="Link to this heading">#</a></h2>
<p>Create a workflow and connect the interface nodes and the I/O stream to each other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initiation of the ANTs normalization workflow</span>
<span class="n">antsflow</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;antsflow&#39;</span><span class="p">)</span>
<span class="n">antsflow</span><span class="o">.</span><span class="n">base_dir</span> <span class="o">=</span> <span class="n">opj</span><span class="p">(</span><span class="n">experiment_dir</span><span class="p">,</span> <span class="n">working_dir</span><span class="p">)</span>

<span class="c1"># Connect up the ANTs normalization components</span>
<span class="n">antsflow</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">infosource</span><span class="p">,</span> <span class="n">selectfiles</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;subject_id&#39;</span><span class="p">,</span> <span class="s1">&#39;subject_id&#39;</span><span class="p">)]),</span>
                  <span class="p">(</span><span class="n">selectfiles</span><span class="p">,</span> <span class="n">apply2con</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;con&#39;</span><span class="p">,</span> <span class="s1">&#39;input_image&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;transform&#39;</span><span class="p">,</span> <span class="s1">&#39;transforms&#39;</span><span class="p">)]),</span>
                  <span class="p">(</span><span class="n">apply2con</span><span class="p">,</span> <span class="n">datasink</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;output_image&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_ants.@con&#39;</span><span class="p">)]),</span>
                  <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-the-workflow">
<h2>Visualize the workflow<a class="headerlink" href="#visualize-the-workflow" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create ANTs normalization graph</span>
<span class="n">antsflow</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;colored&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">simple_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Visualize the graph</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">opj</span><span class="p">(</span><span class="n">antsflow</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="s1">&#39;antsflow&#39;</span><span class="p">,</span> <span class="s1">&#39;graph.png&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>250815-12:00:32,349 nipype.workflow INFO:
	 Generated workflow graph: /output/workingdir/antsflow/graph.png (graph2use=colored, simple_form=True).
</pre></div>
</div>
<img alt="../_images/163514eeb1e01d0f9bf28428ed2c4f0997fadb29c6b9e855d955342c6635d2d5.png" src="../_images/163514eeb1e01d0f9bf28428ed2c4f0997fadb29c6b9e855d955342c6635d2d5.png" />
</div>
</div>
</section>
<section id="run-the-workflow">
<h2>Run the Workflow<a class="headerlink" href="#run-the-workflow" title="Link to this heading">#</a></h2>
<p>Now that everything is ready, we can run the ANTs normalization workflow.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">antsflow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;Linear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>250815-12:00:34,592 nipype.workflow INFO:
	 Workflow antsflow settings: [&#39;check&#39;, &#39;execution&#39;, &#39;logging&#39;, &#39;monitoring&#39;]
250815-12:00:35,8 nipype.workflow INFO:
	 Running serially.
250815-12:00:35,10 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.selectfiles&quot; in &quot;/output/workingdir/antsflow/_subject_id_09/selectfiles&quot;.
250815-12:00:35,137 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:00:35,312 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.selectfiles&quot;.
250815-12:00:35,314 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.apply2con&quot; in &quot;/output/workingdir/antsflow/_subject_id_09/apply2con&quot;.
250815-12:00:35,820 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con0&quot; in &quot;/output/workingdir/antsflow/_subject_id_09/apply2con/mapflow/_apply2con0&quot;.
250815-12:00:35,999 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con0&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-09/con_0001.nii --input-image-type 3 --interpolation BSpline --output con_0001_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-09/anat/sub-09_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:00:46,800 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con0&quot;.
250815-12:00:46,886 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con1&quot; in &quot;/output/workingdir/antsflow/_subject_id_09/apply2con/mapflow/_apply2con1&quot;.
250815-12:00:47,117 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con1&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-09/con_0002.nii --input-image-type 3 --interpolation BSpline --output con_0002_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-09/anat/sub-09_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:00:57,949 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con1&quot;.
250815-12:00:58,31 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con2&quot; in &quot;/output/workingdir/antsflow/_subject_id_09/apply2con/mapflow/_apply2con2&quot;.
250815-12:00:58,433 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con2&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-09/con_0003.nii --input-image-type 3 --interpolation BSpline --output con_0003_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-09/anat/sub-09_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:01:09,22 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con2&quot;.
250815-12:01:09,115 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con3&quot; in &quot;/output/workingdir/antsflow/_subject_id_09/apply2con/mapflow/_apply2con3&quot;.
250815-12:01:09,523 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con3&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-09/con_0004.nii --input-image-type 3 --interpolation BSpline --output con_0004_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-09/anat/sub-09_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:01:22,276 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con3&quot;.
250815-12:01:22,405 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con4&quot; in &quot;/output/workingdir/antsflow/_subject_id_09/apply2con/mapflow/_apply2con4&quot;.
250815-12:01:22,674 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con4&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-09/con_0005.nii --input-image-type 3 --interpolation BSpline --output con_0005_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-09/anat/sub-09_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:01:32,562 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con4&quot;.
250815-12:01:32,642 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con5&quot; in &quot;/output/workingdir/antsflow/_subject_id_09/apply2con/mapflow/_apply2con5&quot;.
250815-12:01:32,944 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con5&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-09/ess_0006.nii --input-image-type 3 --interpolation BSpline --output ess_0006_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-09/anat/sub-09_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:01:41,778 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con5&quot;.
250815-12:01:41,859 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.apply2con&quot;.
250815-12:01:41,861 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.datasink&quot; in &quot;/output/workingdir/antsflow/_subject_id_09/datasink&quot;.
250815-12:01:42,181 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:01:42,200 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_09/_apply2con0/con_0001_trans.nii -&gt; /output/datasink/norm_ants/sub-09/con_0001_trans.nii
250815-12:01:42,253 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_09/_apply2con1/con_0002_trans.nii -&gt; /output/datasink/norm_ants/sub-09/con_0002_trans.nii
250815-12:01:42,312 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_09/_apply2con2/con_0003_trans.nii -&gt; /output/datasink/norm_ants/sub-09/con_0003_trans.nii
250815-12:01:42,355 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_09/_apply2con3/con_0004_trans.nii -&gt; /output/datasink/norm_ants/sub-09/con_0004_trans.nii
250815-12:01:42,399 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_09/_apply2con4/con_0005_trans.nii -&gt; /output/datasink/norm_ants/sub-09/con_0005_trans.nii
250815-12:01:42,439 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_09/_apply2con5/ess_0006_trans.nii -&gt; /output/datasink/norm_ants/sub-09/_apply2con5/ess_0006_trans.nii
250815-12:01:42,637 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.datasink&quot;.
250815-12:01:42,639 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.selectfiles&quot; in &quot;/output/workingdir/antsflow/_subject_id_08/selectfiles&quot;.
250815-12:01:42,747 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:01:42,900 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.selectfiles&quot;.
250815-12:01:42,901 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.apply2con&quot; in &quot;/output/workingdir/antsflow/_subject_id_08/apply2con&quot;.
250815-12:01:43,363 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con0&quot; in &quot;/output/workingdir/antsflow/_subject_id_08/apply2con/mapflow/_apply2con0&quot;.
250815-12:01:43,584 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con0&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-08/con_0001.nii --input-image-type 3 --interpolation BSpline --output con_0001_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-08/anat/sub-08_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:01:54,723 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con0&quot;.
250815-12:01:54,869 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con1&quot; in &quot;/output/workingdir/antsflow/_subject_id_08/apply2con/mapflow/_apply2con1&quot;.
250815-12:01:55,132 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con1&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-08/con_0002.nii --input-image-type 3 --interpolation BSpline --output con_0002_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-08/anat/sub-08_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:02:04,461 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con1&quot;.
250815-12:02:04,617 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con2&quot; in &quot;/output/workingdir/antsflow/_subject_id_08/apply2con/mapflow/_apply2con2&quot;.
250815-12:02:05,152 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con2&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-08/con_0003.nii --input-image-type 3 --interpolation BSpline --output con_0003_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-08/anat/sub-08_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:02:14,735 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con2&quot;.
250815-12:02:14,805 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con3&quot; in &quot;/output/workingdir/antsflow/_subject_id_08/apply2con/mapflow/_apply2con3&quot;.
250815-12:02:14,992 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con3&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-08/con_0004.nii --input-image-type 3 --interpolation BSpline --output con_0004_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-08/anat/sub-08_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:02:24,729 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con3&quot;.
250815-12:02:24,838 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con4&quot; in &quot;/output/workingdir/antsflow/_subject_id_08/apply2con/mapflow/_apply2con4&quot;.
250815-12:02:25,58 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con4&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-08/con_0005.nii --input-image-type 3 --interpolation BSpline --output con_0005_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-08/anat/sub-08_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:02:34,242 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con4&quot;.
250815-12:02:34,378 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con5&quot; in &quot;/output/workingdir/antsflow/_subject_id_08/apply2con/mapflow/_apply2con5&quot;.
250815-12:02:34,834 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con5&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-08/ess_0006.nii --input-image-type 3 --interpolation BSpline --output ess_0006_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-08/anat/sub-08_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:02:45,748 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con5&quot;.
250815-12:02:45,822 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.apply2con&quot;.
250815-12:02:45,823 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.datasink&quot; in &quot;/output/workingdir/antsflow/_subject_id_08/datasink&quot;.
250815-12:02:46,92 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:02:46,102 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_08/_apply2con0/con_0001_trans.nii -&gt; /output/datasink/norm_ants/sub-08/con_0001_trans.nii
250815-12:02:46,142 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_08/_apply2con1/con_0002_trans.nii -&gt; /output/datasink/norm_ants/sub-08/con_0002_trans.nii
250815-12:02:46,173 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_08/_apply2con2/con_0003_trans.nii -&gt; /output/datasink/norm_ants/sub-08/con_0003_trans.nii
250815-12:02:46,204 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_08/_apply2con3/con_0004_trans.nii -&gt; /output/datasink/norm_ants/sub-08/con_0004_trans.nii
250815-12:02:46,237 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_08/_apply2con4/con_0005_trans.nii -&gt; /output/datasink/norm_ants/sub-08/con_0005_trans.nii
250815-12:02:46,267 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_08/_apply2con5/ess_0006_trans.nii -&gt; /output/datasink/norm_ants/sub-08/_apply2con5/ess_0006_trans.nii
250815-12:02:46,427 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.datasink&quot;.
250815-12:02:46,429 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.selectfiles&quot; in &quot;/output/workingdir/antsflow/_subject_id_07/selectfiles&quot;.
250815-12:02:46,544 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:02:46,707 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.selectfiles&quot;.
250815-12:02:46,708 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.apply2con&quot; in &quot;/output/workingdir/antsflow/_subject_id_07/apply2con&quot;.
250815-12:02:47,289 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con0&quot; in &quot;/output/workingdir/antsflow/_subject_id_07/apply2con/mapflow/_apply2con0&quot;.
250815-12:02:47,510 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con0&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-07/con_0001.nii --input-image-type 3 --interpolation BSpline --output con_0001_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-07/anat/sub-07_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:02:58,825 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con0&quot;.
250815-12:02:58,908 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con1&quot; in &quot;/output/workingdir/antsflow/_subject_id_07/apply2con/mapflow/_apply2con1&quot;.
250815-12:02:59,170 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con1&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-07/con_0002.nii --input-image-type 3 --interpolation BSpline --output con_0002_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-07/anat/sub-07_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:03:08,748 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con1&quot;.
250815-12:03:08,857 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con2&quot; in &quot;/output/workingdir/antsflow/_subject_id_07/apply2con/mapflow/_apply2con2&quot;.
250815-12:03:09,153 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con2&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-07/con_0003.nii --input-image-type 3 --interpolation BSpline --output con_0003_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-07/anat/sub-07_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:03:19,170 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con2&quot;.
250815-12:03:19,249 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con3&quot; in &quot;/output/workingdir/antsflow/_subject_id_07/apply2con/mapflow/_apply2con3&quot;.
250815-12:03:19,493 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con3&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-07/con_0004.nii --input-image-type 3 --interpolation BSpline --output con_0004_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-07/anat/sub-07_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:03:28,952 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con3&quot;.
250815-12:03:29,45 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con4&quot; in &quot;/output/workingdir/antsflow/_subject_id_07/apply2con/mapflow/_apply2con4&quot;.
250815-12:03:29,213 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con4&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-07/con_0005.nii --input-image-type 3 --interpolation BSpline --output con_0005_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-07/anat/sub-07_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:03:38,550 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con4&quot;.
250815-12:03:38,642 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con5&quot; in &quot;/output/workingdir/antsflow/_subject_id_07/apply2con/mapflow/_apply2con5&quot;.
250815-12:03:38,887 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con5&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-07/ess_0006.nii --input-image-type 3 --interpolation BSpline --output ess_0006_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-07/anat/sub-07_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:03:47,965 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con5&quot;.
250815-12:03:48,44 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.apply2con&quot;.
250815-12:03:48,46 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.datasink&quot; in &quot;/output/workingdir/antsflow/_subject_id_07/datasink&quot;.
250815-12:03:48,323 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:03:48,334 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_07/_apply2con0/con_0001_trans.nii -&gt; /output/datasink/norm_ants/sub-07/con_0001_trans.nii
250815-12:03:48,381 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_07/_apply2con1/con_0002_trans.nii -&gt; /output/datasink/norm_ants/sub-07/con_0002_trans.nii
250815-12:03:48,419 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_07/_apply2con2/con_0003_trans.nii -&gt; /output/datasink/norm_ants/sub-07/con_0003_trans.nii
250815-12:03:48,474 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_07/_apply2con3/con_0004_trans.nii -&gt; /output/datasink/norm_ants/sub-07/con_0004_trans.nii
250815-12:03:48,507 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_07/_apply2con4/con_0005_trans.nii -&gt; /output/datasink/norm_ants/sub-07/con_0005_trans.nii
250815-12:03:48,627 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_07/_apply2con5/ess_0006_trans.nii -&gt; /output/datasink/norm_ants/sub-07/_apply2con5/ess_0006_trans.nii
250815-12:03:48,758 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.datasink&quot;.
250815-12:03:48,759 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.selectfiles&quot; in &quot;/output/workingdir/antsflow/_subject_id_05/selectfiles&quot;.
250815-12:03:48,891 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:03:49,2 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.selectfiles&quot;.
250815-12:03:49,4 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.apply2con&quot; in &quot;/output/workingdir/antsflow/_subject_id_05/apply2con&quot;.
250815-12:03:49,468 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con0&quot; in &quot;/output/workingdir/antsflow/_subject_id_05/apply2con/mapflow/_apply2con0&quot;.
250815-12:03:49,697 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con0&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-05/con_0001.nii --input-image-type 3 --interpolation BSpline --output con_0001_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-05/anat/sub-05_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:03:59,436 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con0&quot;.
250815-12:03:59,517 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con1&quot; in &quot;/output/workingdir/antsflow/_subject_id_05/apply2con/mapflow/_apply2con1&quot;.
250815-12:03:59,951 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con1&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-05/con_0002.nii --input-image-type 3 --interpolation BSpline --output con_0002_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-05/anat/sub-05_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:04:09,801 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con1&quot;.
250815-12:04:09,887 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con2&quot; in &quot;/output/workingdir/antsflow/_subject_id_05/apply2con/mapflow/_apply2con2&quot;.
250815-12:04:10,137 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con2&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-05/con_0003.nii --input-image-type 3 --interpolation BSpline --output con_0003_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-05/anat/sub-05_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:04:19,568 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con2&quot;.
250815-12:04:19,651 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con3&quot; in &quot;/output/workingdir/antsflow/_subject_id_05/apply2con/mapflow/_apply2con3&quot;.
250815-12:04:20,44 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con3&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-05/con_0004.nii --input-image-type 3 --interpolation BSpline --output con_0004_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-05/anat/sub-05_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:04:30,689 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con3&quot;.
250815-12:04:30,772 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con4&quot; in &quot;/output/workingdir/antsflow/_subject_id_05/apply2con/mapflow/_apply2con4&quot;.
250815-12:04:31,81 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con4&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-05/con_0005.nii --input-image-type 3 --interpolation BSpline --output con_0005_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-05/anat/sub-05_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:04:40,674 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con4&quot;.
250815-12:04:40,807 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con5&quot; in &quot;/output/workingdir/antsflow/_subject_id_05/apply2con/mapflow/_apply2con5&quot;.
250815-12:04:41,131 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con5&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-05/ess_0006.nii --input-image-type 3 --interpolation BSpline --output ess_0006_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-05/anat/sub-05_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:04:50,815 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con5&quot;.
250815-12:04:50,919 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.apply2con&quot;.
250815-12:04:50,922 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.datasink&quot; in &quot;/output/workingdir/antsflow/_subject_id_05/datasink&quot;.
250815-12:04:51,309 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:04:51,323 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_05/_apply2con0/con_0001_trans.nii -&gt; /output/datasink/norm_ants/sub-05/con_0001_trans.nii
250815-12:04:51,399 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_05/_apply2con1/con_0002_trans.nii -&gt; /output/datasink/norm_ants/sub-05/con_0002_trans.nii
250815-12:04:51,454 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_05/_apply2con2/con_0003_trans.nii -&gt; /output/datasink/norm_ants/sub-05/con_0003_trans.nii
250815-12:04:51,509 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_05/_apply2con3/con_0004_trans.nii -&gt; /output/datasink/norm_ants/sub-05/con_0004_trans.nii
250815-12:04:51,561 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_05/_apply2con4/con_0005_trans.nii -&gt; /output/datasink/norm_ants/sub-05/con_0005_trans.nii
250815-12:04:51,608 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_05/_apply2con5/ess_0006_trans.nii -&gt; /output/datasink/norm_ants/sub-05/_apply2con5/ess_0006_trans.nii
250815-12:04:51,807 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.datasink&quot;.
250815-12:04:51,808 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.selectfiles&quot; in &quot;/output/workingdir/antsflow/_subject_id_04/selectfiles&quot;.
250815-12:04:51,922 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:04:52,114 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.selectfiles&quot;.
250815-12:04:52,115 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.apply2con&quot; in &quot;/output/workingdir/antsflow/_subject_id_04/apply2con&quot;.
250815-12:04:52,510 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con0&quot; in &quot;/output/workingdir/antsflow/_subject_id_04/apply2con/mapflow/_apply2con0&quot;.
250815-12:04:52,744 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con0&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-04/con_0001.nii --input-image-type 3 --interpolation BSpline --output con_0001_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-04/anat/sub-04_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:05:03,177 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con0&quot;.
250815-12:05:03,260 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con1&quot; in &quot;/output/workingdir/antsflow/_subject_id_04/apply2con/mapflow/_apply2con1&quot;.
250815-12:05:03,506 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con1&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-04/con_0002.nii --input-image-type 3 --interpolation BSpline --output con_0002_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-04/anat/sub-04_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:05:14,126 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con1&quot;.
250815-12:05:14,211 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con2&quot; in &quot;/output/workingdir/antsflow/_subject_id_04/apply2con/mapflow/_apply2con2&quot;.
250815-12:05:14,418 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con2&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-04/con_0003.nii --input-image-type 3 --interpolation BSpline --output con_0003_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-04/anat/sub-04_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:05:24,796 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con2&quot;.
250815-12:05:24,876 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con3&quot; in &quot;/output/workingdir/antsflow/_subject_id_04/apply2con/mapflow/_apply2con3&quot;.
250815-12:05:25,153 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con3&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-04/con_0004.nii --input-image-type 3 --interpolation BSpline --output con_0004_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-04/anat/sub-04_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:05:35,989 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con3&quot;.
250815-12:05:36,102 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con4&quot; in &quot;/output/workingdir/antsflow/_subject_id_04/apply2con/mapflow/_apply2con4&quot;.
250815-12:05:36,534 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con4&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-04/con_0005.nii --input-image-type 3 --interpolation BSpline --output con_0005_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-04/anat/sub-04_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:05:47,986 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con4&quot;.
250815-12:05:48,72 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con5&quot; in &quot;/output/workingdir/antsflow/_subject_id_04/apply2con/mapflow/_apply2con5&quot;.
250815-12:05:48,346 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con5&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-04/ess_0006.nii --input-image-type 3 --interpolation BSpline --output ess_0006_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-04/anat/sub-04_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:05:59,380 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con5&quot;.
250815-12:05:59,456 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.apply2con&quot;.
250815-12:05:59,458 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.datasink&quot; in &quot;/output/workingdir/antsflow/_subject_id_04/datasink&quot;.
250815-12:05:59,765 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:05:59,777 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_04/_apply2con0/con_0001_trans.nii -&gt; /output/datasink/norm_ants/sub-04/con_0001_trans.nii
250815-12:05:59,837 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_04/_apply2con1/con_0002_trans.nii -&gt; /output/datasink/norm_ants/sub-04/con_0002_trans.nii
250815-12:05:59,892 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_04/_apply2con2/con_0003_trans.nii -&gt; /output/datasink/norm_ants/sub-04/con_0003_trans.nii
250815-12:05:59,957 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_04/_apply2con3/con_0004_trans.nii -&gt; /output/datasink/norm_ants/sub-04/con_0004_trans.nii
250815-12:06:00,11 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_04/_apply2con4/con_0005_trans.nii -&gt; /output/datasink/norm_ants/sub-04/con_0005_trans.nii
250815-12:06:00,145 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_04/_apply2con5/ess_0006_trans.nii -&gt; /output/datasink/norm_ants/sub-04/_apply2con5/ess_0006_trans.nii
250815-12:06:00,365 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.datasink&quot;.
250815-12:06:00,366 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.selectfiles&quot; in &quot;/output/workingdir/antsflow/_subject_id_03/selectfiles&quot;.
250815-12:06:00,486 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:06:00,645 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.selectfiles&quot;.
250815-12:06:00,646 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.apply2con&quot; in &quot;/output/workingdir/antsflow/_subject_id_03/apply2con&quot;.
250815-12:06:01,252 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con0&quot; in &quot;/output/workingdir/antsflow/_subject_id_03/apply2con/mapflow/_apply2con0&quot;.
250815-12:06:01,511 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con0&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-03/con_0001.nii --input-image-type 3 --interpolation BSpline --output con_0001_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-03/anat/sub-03_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:06:14,122 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con0&quot;.
250815-12:06:14,223 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con1&quot; in &quot;/output/workingdir/antsflow/_subject_id_03/apply2con/mapflow/_apply2con1&quot;.
250815-12:06:14,769 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con1&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-03/con_0002.nii --input-image-type 3 --interpolation BSpline --output con_0002_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-03/anat/sub-03_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:06:26,361 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con1&quot;.
250815-12:06:26,446 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con2&quot; in &quot;/output/workingdir/antsflow/_subject_id_03/apply2con/mapflow/_apply2con2&quot;.
250815-12:06:26,685 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con2&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-03/con_0003.nii --input-image-type 3 --interpolation BSpline --output con_0003_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-03/anat/sub-03_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:06:36,969 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con2&quot;.
250815-12:06:37,52 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con3&quot; in &quot;/output/workingdir/antsflow/_subject_id_03/apply2con/mapflow/_apply2con3&quot;.
250815-12:06:37,335 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con3&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-03/con_0004.nii --input-image-type 3 --interpolation BSpline --output con_0004_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-03/anat/sub-03_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:06:48,114 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con3&quot;.
250815-12:06:48,229 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con4&quot; in &quot;/output/workingdir/antsflow/_subject_id_03/apply2con/mapflow/_apply2con4&quot;.
250815-12:06:48,521 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con4&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-03/con_0005.nii --input-image-type 3 --interpolation BSpline --output con_0005_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-03/anat/sub-03_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:06:59,512 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con4&quot;.
250815-12:06:59,601 nipype.workflow INFO:
	 [Node] Setting-up &quot;_apply2con5&quot; in &quot;/output/workingdir/antsflow/_subject_id_03/apply2con/mapflow/_apply2con5&quot;.
250815-12:06:59,838 nipype.workflow INFO:
	 [Node] Running &quot;_apply2con5&quot; (&quot;nipype.interfaces.ants.resampling.ApplyTransforms&quot;), a CommandLine Interface with command:
antsApplyTransforms --float --default-value 0 --float 0 --input /output/datasink/1stLevel/sub-03/ess_0006.nii --input-image-type 3 --interpolation BSpline --output ess_0006_trans.nii --reference-image /data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz --transform [ /data/ds000114/derivatives/fmriprep/sub-03/anat/sub-03_t1w_space-mni152nlin2009casym_warp.h5, 0 ]
250815-12:07:09,907 nipype.workflow INFO:
	 [Node] Finished &quot;_apply2con5&quot;.
250815-12:07:09,993 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.apply2con&quot;.
250815-12:07:09,995 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.datasink&quot; in &quot;/output/workingdir/antsflow/_subject_id_03/datasink&quot;.
250815-12:07:10,365 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:07:10,379 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_03/_apply2con0/con_0001_trans.nii -&gt; /output/datasink/norm_ants/sub-03/con_0001_trans.nii
250815-12:07:10,438 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_03/_apply2con1/con_0002_trans.nii -&gt; /output/datasink/norm_ants/sub-03/con_0002_trans.nii
250815-12:07:10,506 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_03/_apply2con2/con_0003_trans.nii -&gt; /output/datasink/norm_ants/sub-03/con_0003_trans.nii
250815-12:07:10,557 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_03/_apply2con3/con_0004_trans.nii -&gt; /output/datasink/norm_ants/sub-03/con_0004_trans.nii
250815-12:07:10,616 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_03/_apply2con4/con_0005_trans.nii -&gt; /output/datasink/norm_ants/sub-03/con_0005_trans.nii
250815-12:07:10,665 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_03/_apply2con5/ess_0006_trans.nii -&gt; /output/datasink/norm_ants/sub-03/_apply2con5/ess_0006_trans.nii
250815-12:07:10,859 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.datasink&quot;.
250815-12:07:10,861 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.selectfiles&quot; in &quot;/output/workingdir/antsflow/_subject_id_02/selectfiles&quot;.
250815-12:07:11,43 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:07:11,280 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.selectfiles&quot;.
250815-12:07:11,281 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.apply2con&quot; in &quot;/output/workingdir/antsflow/_subject_id_02/apply2con&quot;.
250815-12:07:11,585 nipype.workflow INFO:
	 [Node] &quot;antsflow.apply2con&quot; found cached.
250815-12:07:11,586 nipype.workflow INFO:
	 [Node] Setting-up &quot;antsflow.datasink&quot; in &quot;/output/workingdir/antsflow/_subject_id_02/datasink&quot;.
250815-12:07:11,824 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:07:11,833 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_02/_apply2con0/con_0001_trans.nii -&gt; /output/datasink/norm_ants/sub-02/con_0001_trans.nii
250815-12:07:11,861 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_02/_apply2con1/con_0002_trans.nii -&gt; /output/datasink/norm_ants/sub-02/con_0002_trans.nii
250815-12:07:11,890 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_02/_apply2con2/con_0003_trans.nii -&gt; /output/datasink/norm_ants/sub-02/con_0003_trans.nii
250815-12:07:11,919 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_02/_apply2con3/con_0004_trans.nii -&gt; /output/datasink/norm_ants/sub-02/con_0004_trans.nii
250815-12:07:11,950 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_02/_apply2con4/con_0005_trans.nii -&gt; /output/datasink/norm_ants/sub-02/con_0005_trans.nii
250815-12:07:11,978 nipype.interface INFO:
	 sub: /output/datasink/norm_ants/_subject_id_02/_apply2con5/ess_0006_trans.nii -&gt; /output/datasink/norm_ants/sub-02/_apply2con5/ess_0006_trans.nii
250815-12:07:12,120 nipype.workflow INFO:
	 [Node] Finished &quot;antsflow.datasink&quot;.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;networkx.classes.digraph.DiGraph at 0x7f1240761668&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="visualize-results">
<h1>Visualize Results<a class="headerlink" href="#visualize-results" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">nilearn.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_stat_map</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">subject_id</span> <span class="o">=</span> <span class="s1">&#39;02&#39;</span>
<span class="n">anatimg</span> <span class="o">=</span> <span class="s1">&#39;/data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>First, let’s chek the normalization of <strong>anatomical</strong> image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_stat_map</span><span class="p">(</span>
   <span class="sa">f</span><span class="s1">&#39;/data/ds000114/derivatives/fmriprep/sub-</span><span class="si">{</span><span class="n">subject_id</span><span class="si">}</span><span class="s1">/anat/sub-</span><span class="si">{</span><span class="n">subject_id</span><span class="si">}</span><span class="s1">_t1w_space-mni152nlin2009casym_preproc.nii.gz&#39;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;anatomy - ANTs (normalized to ICBM152)&#39;</span><span class="p">,</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">anatimg</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays.OrthoSlicer at 0x7f12476a24e0&gt;
</pre></div>
</div>
<img alt="../_images/c1cbf58924f80ee52f8645bc459f14f9b7b1b33dbde1a2ec2c85aa2bb2417c25.png" src="../_images/c1cbf58924f80ee52f8645bc459f14f9b7b1b33dbde1a2ec2c85aa2bb2417c25.png" />
</div>
</div>
<p>And what about the <strong>contrast</strong> images for <strong>Foot &gt; others</strong>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="sa">f</span><span class="s1">&#39;/output/datasink/norm_ants/sub-</span><span class="si">{</span><span class="n">subject_id</span><span class="si">}</span><span class="s1">/con_0005_trans.nii&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Foot &gt; others - Normed&#39;</span><span class="p">,</span>
    <span class="n">bg_img</span><span class="o">=</span><span class="n">anatimg</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">39</span><span class="p">,</span> <span class="o">-</span><span class="mi">37</span><span class="p">,</span> <span class="mi">56</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays.OrthoSlicer at 0x7f12400daac8&gt;
</pre></div>
</div>
<img alt="../_images/6c451eed16d65a136630332b63fec6a3c2a7cf0a61c759158959d355883209fa.png" src="../_images/6c451eed16d65a136630332b63fec6a3c2a7cf0a61c759158959d355883209fa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting.view_img(f&#39;/output/datasink/norm_ants/sub-{subject_id}/con_0005_trans.nii&#39;, </span>
<span class="c1">#                   bg_img=anatimg, threshold=2, cut_coords=(0,0,0), title=&#39;Foot &gt; others - Normed&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">nilearn.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_glass_brain</span>
<span class="n">plot_glass_brain</span><span class="p">(</span>
    <span class="sa">f</span><span class="s1">&#39;/output/datasink/norm_ants/sub-</span><span class="si">{</span><span class="n">subject_id</span><span class="si">}</span><span class="s1">/con_0005_trans.nii&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;lyrz&#39;</span><span class="p">,</span> <span class="n">black_bg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;contrast5 - ANTs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;nilearn.plotting.displays.LYRZProjector at 0x7f123e85f470&gt;
</pre></div>
</div>
<img alt="../_images/a1ab42be780aa5ac9b81a61b212f53b53a27b29d04429dc52751e894a36a57bb.png" src="../_images/a1ab42be780aa5ac9b81a61b212f53b53a27b29d04429dc52751e894a36a57bb.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nd-level-analysis">
<h1>2nd level analysis<a class="headerlink" href="#nd-level-analysis" title="Link to this heading">#</a></h1>
<p>After we normalized the subjects data into template space, we can now do the group analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">experiment_dir</span> <span class="o">=</span> <span class="s1">&#39;/output&#39;</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;datasink&#39;</span>
<span class="n">working_dir</span> <span class="o">=</span> <span class="s1">&#39;workingdir&#39;</span>


<span class="c1"># Which contrasts to use for the 2nd-level analysis</span>
<span class="n">contrast_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;con_0001&#39;</span><span class="p">,</span> <span class="s1">&#39;con_0002&#39;</span><span class="p">,</span> <span class="s1">&#39;con_0003&#39;</span><span class="p">,</span> <span class="s1">&#39;con_0004&#39;</span><span class="p">,</span> <span class="s1">&#39;con_0005&#39;</span><span class="p">]</span>

<span class="n">mask</span> <span class="o">=</span> <span class="s2">&quot;/data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_brainmask.nii.gz&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gunzip - unzip the mask image</span>
<span class="n">gunzip</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Gunzip</span><span class="p">(</span><span class="n">in_file</span><span class="o">=</span><span class="n">mask</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;gunzip&quot;</span><span class="p">)</span>

<span class="c1"># OneSampleTTestDesign - creates one sample T-Test Design</span>
<span class="n">onesamplettestdes</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OneSampleTTestDesign</span><span class="p">(),</span>
                         <span class="n">name</span><span class="o">=</span><span class="s2">&quot;onesampttestdes&quot;</span><span class="p">)</span>

<span class="c1"># EstimateModel - estimates the model</span>
<span class="n">level2estimate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">EstimateModel</span><span class="p">(</span><span class="n">estimation_method</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Classical&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span>
                      <span class="n">name</span><span class="o">=</span><span class="s2">&quot;level2estimate&quot;</span><span class="p">)</span>

<span class="c1"># EstimateContrast - estimates group contrast</span>
<span class="n">level2conestimate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">EstimateContrast</span><span class="p">(</span><span class="n">group_contrast</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                         <span class="n">name</span><span class="o">=</span><span class="s2">&quot;level2conestimate&quot;</span><span class="p">)</span>
<span class="n">cont1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="c1"># mean beta-ith &gt; mean betta- ith + 1</span>
<span class="n">level2conestimate</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">contrasts</span> <span class="o">=</span> <span class="p">[</span><span class="n">cont1</span><span class="p">]</span>

<span class="c1"># mean B1 - mean B2</span>
<span class="c1"># Threshold - thresholds contrasts, we use fdr correction</span>
<span class="n">level2thresh</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Threshold</span><span class="p">(</span><span class="n">contrast_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                              <span class="n">use_topo_fdr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># fdr correction for multiple hypos testing</span>
                              <span class="n">use_fwe_correction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">extent_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">height_threshold</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
                              <span class="n">height_threshold_type</span><span class="o">=</span><span class="s1">&#39;p-value&#39;</span><span class="p">,</span>
                              <span class="n">extent_fdr_p_threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;level2thresh&quot;</span><span class="p">)</span>

<span class="c1"># Infosource - a function free node to iterate over the list of subject names</span>
<span class="n">infosource</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">IdentityInterface</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;contrast_id&#39;</span><span class="p">]),</span>
                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;infosource&quot;</span><span class="p">)</span>
<span class="n">infosource</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;contrast_id&#39;</span><span class="p">,</span> <span class="n">contrast_list</span><span class="p">)]</span>

<span class="c1"># SelectFiles - to grab the data</span>
<span class="n">templates</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cons&#39;</span><span class="p">:</span> <span class="n">opj</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s1">&#39;norm_ants&#39;</span><span class="p">,</span> <span class="s1">&#39;sub-*&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;</span><span class="si">{contrast_id}</span><span class="s1">_trans.nii&#39;</span><span class="p">)}</span>
<span class="n">selectfiles</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SelectFiles</span><span class="p">(</span><span class="n">templates</span><span class="p">,</span>
                               <span class="n">base_directory</span><span class="o">=</span><span class="n">experiment_dir</span><span class="p">,</span>
                               <span class="n">sort_filelist</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                   <span class="n">name</span><span class="o">=</span><span class="s2">&quot;selectfiles&quot;</span><span class="p">)</span>
<span class="c1"># Datasink - creates output folder for important outputs</span>
<span class="n">datasink</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">DataSink</span><span class="p">(</span><span class="n">base_directory</span><span class="o">=</span><span class="n">experiment_dir</span><span class="p">,</span>
                         <span class="n">container</span><span class="o">=</span><span class="n">output_dir</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;datasink&quot;</span><span class="p">)</span>

<span class="c1"># Use the following DataSink output substitutions</span>
<span class="n">substitutions</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;_contrast_id_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)]</span>
<span class="n">datasink</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">substitutions</span> <span class="o">=</span> <span class="n">substitutions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initiation of the 2nd-level analysis workflow</span>
<span class="n">l2analysis</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ants_l2analysis&#39;</span><span class="p">)</span>
<span class="n">l2analysis</span><span class="o">.</span><span class="n">base_dir</span> <span class="o">=</span> <span class="n">opj</span><span class="p">(</span><span class="n">experiment_dir</span><span class="p">,</span> <span class="n">working_dir</span><span class="p">)</span>

<span class="c1"># Connect up the 2nd-level analysis components</span>
<span class="n">l2analysis</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">infosource</span><span class="p">,</span> <span class="n">selectfiles</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;contrast_id&#39;</span><span class="p">,</span> <span class="s1">&#39;contrast_id&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">selectfiles</span><span class="p">,</span> <span class="n">onesamplettestdes</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;cons&#39;</span><span class="p">,</span> <span class="s1">&#39;in_files&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">gunzip</span><span class="p">,</span> <span class="n">onesamplettestdes</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;explicit_mask_file&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">onesamplettestdes</span><span class="p">,</span> <span class="n">level2estimate</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;spm_mat_file&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;spm_mat_file&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">level2estimate</span><span class="p">,</span> <span class="n">level2conestimate</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;spm_mat_file&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;spm_mat_file&#39;</span><span class="p">),</span>
                                                         <span class="p">(</span><span class="s1">&#39;beta_images&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;beta_images&#39;</span><span class="p">),</span>
                                                         <span class="p">(</span><span class="s1">&#39;residual_image&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;residual_image&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">level2conestimate</span><span class="p">,</span> <span class="n">level2thresh</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;spm_mat_file&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;spm_mat_file&#39;</span><span class="p">),</span>
                                                       <span class="p">(</span><span class="s1">&#39;spmT_images&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;stat_image&#39;</span><span class="p">),</span>
                                                       <span class="p">]),</span>
                    <span class="p">(</span><span class="n">level2conestimate</span><span class="p">,</span> <span class="n">datasink</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;spm_mat_file&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;2ndLevel.@spm_mat&#39;</span><span class="p">),</span>
                                                   <span class="p">(</span><span class="s1">&#39;spmT_images&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;2ndLevel.@T&#39;</span><span class="p">),</span>
                                                   <span class="p">(</span><span class="s1">&#39;con_images&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;2ndLevel.@con&#39;</span><span class="p">)]),</span>
                    <span class="p">(</span><span class="n">level2thresh</span><span class="p">,</span> <span class="n">datasink</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;thresholded_map&#39;</span><span class="p">,</span>
                                               <span class="s1">&#39;2ndLevel.@threshold&#39;</span><span class="p">)]),</span>
                    <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l2analysis</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">simple_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;/output/workingdir/ants_l2analysis/graph_detailed.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>250815-12:09:27,738 nipype.workflow INFO:
	 Generated workflow graph: /output/workingdir/ants_l2analysis/graph.png (graph2use=flat, simple_form=True).
</pre></div>
</div>
<img alt="../_images/194ecdc7114a1b2571fe0b6243ffc17778a6e6072ca4cacaac0d0406f350da01.png" src="../_images/194ecdc7114a1b2571fe0b6243ffc17778a6e6072ca4cacaac0d0406f350da01.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l2analysis</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;Linear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>250815-12:09:42,603 nipype.workflow INFO:
	 Workflow ants_l2analysis settings: [&#39;check&#39;, &#39;execution&#39;, &#39;logging&#39;, &#39;monitoring&#39;]
250815-12:09:43,8 nipype.workflow INFO:
	 Running serially.
250815-12:09:43,10 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.selectfiles&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0005/selectfiles&quot;.
250815-12:09:43,75 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:09:43,241 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.selectfiles&quot;.
250815-12:09:43,242 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.selectfiles&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0004/selectfiles&quot;.
250815-12:09:43,304 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:09:43,446 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.selectfiles&quot;.
250815-12:09:43,448 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.selectfiles&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0003/selectfiles&quot;.
250815-12:09:43,511 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:09:43,664 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.selectfiles&quot;.
250815-12:09:43,666 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.selectfiles&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0002/selectfiles&quot;.
250815-12:09:43,726 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:09:43,902 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.selectfiles&quot;.
250815-12:09:43,904 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.selectfiles&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0001/selectfiles&quot;.
250815-12:09:43,982 nipype.workflow INFO:
	 [Node] Running &quot;selectfiles&quot; (&quot;nipype.interfaces.io.SelectFiles&quot;)
250815-12:09:44,165 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.selectfiles&quot;.
250815-12:09:44,166 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.gunzip&quot; in &quot;/output/workingdir/ants_l2analysis/gunzip&quot;.
250815-12:09:44,271 nipype.workflow INFO:
	 [Node] Running &quot;gunzip&quot; (&quot;nipype.algorithms.misc.Gunzip&quot;)
250815-12:09:44,876 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.gunzip&quot;.
250815-12:09:44,878 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.onesampttestdes&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0005/onesampttestdes&quot;.
250815-12:09:45,222 nipype.workflow INFO:
	 [Node] Running &quot;onesampttestdes&quot; (&quot;nipype.interfaces.spm.model.OneSampleTTestDesign&quot;)
250815-12:09:57,437 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.onesampttestdes&quot;.
250815-12:09:57,440 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2estimate&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0005/level2estimate&quot;.
250815-12:09:57,616 nipype.workflow INFO:
	 [Node] Running &quot;level2estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-12:11:20,323 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2estimate&quot;.
250815-12:11:20,325 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2conestimate&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0005/level2conestimate&quot;.
250815-12:11:20,798 nipype.workflow INFO:
	 [Node] Running &quot;level2conestimate&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-12:11:38,704 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2conestimate&quot;.
250815-12:11:38,707 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2thresh&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0005/level2thresh&quot;.
250815-12:11:39,80 nipype.workflow INFO:
	 [Node] Running &quot;level2thresh&quot; (&quot;nipype.interfaces.spm.model.Threshold&quot;)
250815-12:11:48,479 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2thresh&quot;.
250815-12:11:48,481 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.datasink&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0005/datasink&quot;.
250815-12:11:48,690 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:11:48,700 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0005/SPM.mat -&gt; /output/datasink/2ndLevel/con_0005/SPM.mat
250815-12:11:48,732 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0005/spmT_0001.nii -&gt; /output/datasink/2ndLevel/con_0005/spmT_0001.nii
250815-12:11:48,752 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0005/con_0001.nii -&gt; /output/datasink/2ndLevel/con_0005/con_0001.nii
250815-12:11:48,772 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0005/spmT_0001_thr.nii -&gt; /output/datasink/2ndLevel/con_0005/spmT_0001_thr.nii
250815-12:11:48,901 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.datasink&quot;.
250815-12:11:48,903 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.onesampttestdes&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0004/onesampttestdes&quot;.
250815-12:11:49,317 nipype.workflow INFO:
	 [Node] Running &quot;onesampttestdes&quot; (&quot;nipype.interfaces.spm.model.OneSampleTTestDesign&quot;)
250815-12:11:57,757 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.onesampttestdes&quot;.
250815-12:11:57,759 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2estimate&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0004/level2estimate&quot;.
250815-12:11:57,911 nipype.workflow INFO:
	 [Node] Running &quot;level2estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-12:13:10,458 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2estimate&quot;.
250815-12:13:10,460 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2conestimate&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0004/level2conestimate&quot;.
250815-12:13:10,972 nipype.workflow INFO:
	 [Node] Running &quot;level2conestimate&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-12:13:30,201 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2conestimate&quot;.
250815-12:13:30,203 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2thresh&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0004/level2thresh&quot;.
250815-12:13:30,588 nipype.workflow INFO:
	 [Node] Running &quot;level2thresh&quot; (&quot;nipype.interfaces.spm.model.Threshold&quot;)
250815-12:13:40,746 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2thresh&quot;.
250815-12:13:40,748 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.datasink&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0004/datasink&quot;.
250815-12:13:40,947 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:13:40,959 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0004/SPM.mat -&gt; /output/datasink/2ndLevel/con_0004/SPM.mat
250815-12:13:40,989 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0004/spmT_0001.nii -&gt; /output/datasink/2ndLevel/con_0004/spmT_0001.nii
250815-12:13:41,9 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0004/con_0001.nii -&gt; /output/datasink/2ndLevel/con_0004/con_0001.nii
250815-12:13:41,29 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0004/spmT_0001_thr.nii -&gt; /output/datasink/2ndLevel/con_0004/spmT_0001_thr.nii
250815-12:13:41,197 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.datasink&quot;.
250815-12:13:41,200 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.onesampttestdes&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0003/onesampttestdes&quot;.
250815-12:13:41,724 nipype.workflow INFO:
	 [Node] Running &quot;onesampttestdes&quot; (&quot;nipype.interfaces.spm.model.OneSampleTTestDesign&quot;)
250815-12:13:50,575 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.onesampttestdes&quot;.
250815-12:13:50,577 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2estimate&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0003/level2estimate&quot;.
250815-12:13:50,760 nipype.workflow INFO:
	 [Node] Running &quot;level2estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-12:15:04,232 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2estimate&quot;.
250815-12:15:04,233 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2conestimate&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0003/level2conestimate&quot;.
250815-12:15:04,744 nipype.workflow INFO:
	 [Node] Running &quot;level2conestimate&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-12:15:22,690 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2conestimate&quot;.
250815-12:15:22,692 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2thresh&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0003/level2thresh&quot;.
250815-12:15:23,250 nipype.workflow INFO:
	 [Node] Running &quot;level2thresh&quot; (&quot;nipype.interfaces.spm.model.Threshold&quot;)
250815-12:15:33,712 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2thresh&quot;.
250815-12:15:33,715 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.datasink&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0003/datasink&quot;.
250815-12:15:33,988 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:15:33,999 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0003/SPM.mat -&gt; /output/datasink/2ndLevel/con_0003/SPM.mat
250815-12:15:34,25 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0003/spmT_0001.nii -&gt; /output/datasink/2ndLevel/con_0003/spmT_0001.nii
250815-12:15:34,46 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0003/con_0001.nii -&gt; /output/datasink/2ndLevel/con_0003/con_0001.nii
250815-12:15:34,67 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0003/spmT_0001_thr.nii -&gt; /output/datasink/2ndLevel/con_0003/spmT_0001_thr.nii
250815-12:15:34,206 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.datasink&quot;.
250815-12:15:34,210 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.onesampttestdes&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0002/onesampttestdes&quot;.
250815-12:15:34,711 nipype.workflow INFO:
	 [Node] Running &quot;onesampttestdes&quot; (&quot;nipype.interfaces.spm.model.OneSampleTTestDesign&quot;)
250815-12:15:43,375 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.onesampttestdes&quot;.
250815-12:15:43,377 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2estimate&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0002/level2estimate&quot;.
250815-12:15:43,525 nipype.workflow INFO:
	 [Node] Running &quot;level2estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-12:16:55,525 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2estimate&quot;.
250815-12:16:55,528 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2conestimate&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0002/level2conestimate&quot;.
250815-12:16:56,55 nipype.workflow INFO:
	 [Node] Running &quot;level2conestimate&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-12:17:13,934 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2conestimate&quot;.
250815-12:17:13,935 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2thresh&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0002/level2thresh&quot;.
250815-12:17:14,220 nipype.workflow INFO:
	 [Node] Running &quot;level2thresh&quot; (&quot;nipype.interfaces.spm.model.Threshold&quot;)
250815-12:17:24,659 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2thresh&quot;.
250815-12:17:24,661 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.datasink&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0002/datasink&quot;.
250815-12:17:24,858 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:17:24,866 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0002/SPM.mat -&gt; /output/datasink/2ndLevel/con_0002/SPM.mat
250815-12:17:24,893 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0002/spmT_0001.nii -&gt; /output/datasink/2ndLevel/con_0002/spmT_0001.nii
250815-12:17:24,914 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0002/con_0001.nii -&gt; /output/datasink/2ndLevel/con_0002/con_0001.nii
250815-12:17:24,936 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0002/spmT_0001_thr.nii -&gt; /output/datasink/2ndLevel/con_0002/spmT_0001_thr.nii
250815-12:17:25,78 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.datasink&quot;.
250815-12:17:25,81 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.onesampttestdes&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0001/onesampttestdes&quot;.
250815-12:17:25,486 nipype.workflow INFO:
	 [Node] Running &quot;onesampttestdes&quot; (&quot;nipype.interfaces.spm.model.OneSampleTTestDesign&quot;)
250815-12:17:34,280 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.onesampttestdes&quot;.
250815-12:17:34,281 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2estimate&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0001/level2estimate&quot;.
250815-12:17:34,441 nipype.workflow INFO:
	 [Node] Running &quot;level2estimate&quot; (&quot;nipype.interfaces.spm.model.EstimateModel&quot;)
250815-12:18:49,263 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2estimate&quot;.
250815-12:18:49,265 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2conestimate&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0001/level2conestimate&quot;.
250815-12:18:49,842 nipype.workflow INFO:
	 [Node] Running &quot;level2conestimate&quot; (&quot;nipype.interfaces.spm.model.EstimateContrast&quot;)
250815-12:19:08,567 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2conestimate&quot;.
250815-12:19:08,569 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.level2thresh&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0001/level2thresh&quot;.
250815-12:19:08,980 nipype.workflow INFO:
	 [Node] Running &quot;level2thresh&quot; (&quot;nipype.interfaces.spm.model.Threshold&quot;)
250815-12:19:19,152 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.level2thresh&quot;.
250815-12:19:19,155 nipype.workflow INFO:
	 [Node] Setting-up &quot;ants_l2analysis.datasink&quot; in &quot;/output/workingdir/ants_l2analysis/_contrast_id_con_0001/datasink&quot;.
250815-12:19:19,346 nipype.workflow INFO:
	 [Node] Running &quot;datasink&quot; (&quot;nipype.interfaces.io.DataSink&quot;)
250815-12:19:19,353 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0001/SPM.mat -&gt; /output/datasink/2ndLevel/con_0001/SPM.mat
250815-12:19:19,376 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0001/spmT_0001.nii -&gt; /output/datasink/2ndLevel/con_0001/spmT_0001.nii
250815-12:19:19,391 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0001/con_0001.nii -&gt; /output/datasink/2ndLevel/con_0001/con_0001.nii
250815-12:19:19,411 nipype.interface INFO:
	 sub: /output/datasink/2ndLevel/_contrast_id_con_0001/spmT_0001_thr.nii -&gt; /output/datasink/2ndLevel/con_0001/spmT_0001_thr.nii
250815-12:19:19,528 nipype.workflow INFO:
	 [Node] Finished &quot;ants_l2analysis.datasink&quot;.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;networkx.classes.digraph.DiGraph at 0x7f123e027c88&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!nipypecli crash /home/neuro/nipype_tutorial/lection/crash-20200721-181746-neuro-selectfiles.a5-607b7489-d773-4d9c-ae69-49eca16a30d1.pklz</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Keep in mind, that the group analysis was only done on <em><code class="docutils literal notranslate"><span class="pre">N=7</span></code></em> subjects, and that we chose a voxel-wise threshold of <em><code class="docutils literal notranslate"><span class="pre">p&lt;0.005</span></code></em>. Nonetheless, we corrected for multiple comparisons with a cluster-wise FDR threshold of <em><code class="docutils literal notranslate"><span class="pre">p&lt;0.05</span></code></em>.</strong></p>
<p>So let’s first look at the contrast <strong>average</strong>:</p>
<p>Let’s take a look at the files we produced</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>tree<span class="w"> </span>/output/datasink/2ndLevel
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/output/datasink/2ndLevel
├── con_0001
│   ├── con_0001.nii
│   ├── SPM.mat
│   ├── spmT_0001.nii
│   └── spmT_0001_thr.nii
├── con_0002
│   ├── con_0001.nii
│   ├── SPM.mat
│   ├── spmT_0001.nii
│   └── spmT_0001_thr.nii
├── con_0003
│   ├── con_0001.nii
│   ├── SPM.mat
│   ├── spmT_0001.nii
│   └── spmT_0001_thr.nii
├── con_0004
│   ├── con_0001.nii
│   ├── SPM.mat
│   ├── spmT_0001.nii
│   └── spmT_0001_thr.nii
└── con_0005
    ├── con_0001.nii
    ├── SPM.mat
    ├── spmT_0001.nii
    └── spmT_0001_thr.nii

5 directories, 20 files
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">anatimg</span> <span class="o">=</span> <span class="s1">&#39;/data/ds000114/derivatives/fmriprep/mni_icbm152_nlin_asym_09c/1mm_T1.nii.gz&#39;</span>
<span class="n">plot_stat_map</span><span class="p">(</span>
    <span class="s1">&#39;/output/datasink/2ndLevel/con_0001/spmT_0001_thr.nii&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ants&#39;</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">bg_img</span><span class="o">=</span><span class="n">anatimg</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/abb949f5228fc67710f63f468e451d43d673cb1943f105ad1f656a69efb37de0.png" src="../_images/abb949f5228fc67710f63f468e451d43d673cb1943f105ad1f656a69efb37de0.png" />
</div>
</div>
<p>Now, let’s see other contrast <strong>Foot &gt; others</strong>  using the glass brain plotting method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">nilearn.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_glass_brain</span>

<span class="n">plot_glass_brain</span><span class="p">(</span>
    <span class="s1">&#39;/output/datasink/2ndLevel/con_0005/spmT_0001_thr.nii&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;lyrz&#39;</span><span class="p">,</span> <span class="n">black_bg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Foot &gt; others&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b6bb6dad638cc8ea7f6bdf45f248d014440518b7112145729bb9aa69fe9db6b0.png" src="../_images/b6bb6dad638cc8ea7f6bdf45f248d014440518b7112145729bb9aa69fe9db6b0.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="multiple-comparison-problem">
<h1>Multiple comparison problem<a class="headerlink" href="#multiple-comparison-problem" title="Link to this heading">#</a></h1>
<p>When we make statistical maps we set a threshold at a given confidence level <span class="math notranslate nohighlight">\(\alpha\)</span> and declare all voxels for which beta is above this level as active.
Typically our  <span class="math notranslate nohighlight">\(H_0\)</span> is that the voxel is not active.</p>
<p><img alt="Hypothesis testing" src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fnmeth.2698/MediaObjects/41592_2013_Article_BFnmeth2698_Fig1_HTML.jpg" /></p>
<p>The probability that a test will correctly reject <span class="math notranslate nohighlight">\(H_0\)</span> is called the power of the test.</p>
<p>During fMRI experiments we perform test for each voxel, which means there will be many false active voxels.
There are many ways to deal with this problem.</p>
<p>How to choose the threshold ?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>
    <span class="n">plot_stat_map</span><span class="p">(</span>
        <span class="s1">&#39;/output/datasink/2ndLevel/con_0001/spmT_0001.nii&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;threshold </span><span class="si">{</span><span class="n">tr</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">bg_img</span><span class="o">=</span><span class="n">anatimg</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">tr</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b268491c390454f9e4e9b594b72993a623d8508b9569ac77bcd1a99639f28a67.png" src="../_images/b268491c390454f9e4e9b594b72993a623d8508b9569ac77bcd1a99639f28a67.png" />
<img alt="../_images/65b742a33eec057fd556860afe49df160d19bddae51b57cbac30e30999591232.png" src="../_images/65b742a33eec057fd556860afe49df160d19bddae51b57cbac30e30999591232.png" />
<img alt="../_images/da243b3a316312aede318ae24a2269b58d4eb57250cfee11b1493bced43ada52.png" src="../_images/da243b3a316312aede318ae24a2269b58d4eb57250cfee11b1493bced43ada52.png" />
<img alt="../_images/ab323e31a9211b07940d0ff746d360b2cd66c8c58b7807516bf49e8776e8c740.png" src="../_images/ab323e31a9211b07940d0ff746d360b2cd66c8c58b7807516bf49e8776e8c740.png" />
</div>
</div>
<p><strong>FWER (family-wize error rate) methods</strong></p>
<p>We control for any false positives <span class="math notranslate nohighlight">\(FP\)</span>:
$<span class="math notranslate nohighlight">\(FWER=P(FP \geq 1)\)</span><span class="math notranslate nohighlight">\(
\)</span>H_0<span class="math notranslate nohighlight">\( is that there is no activation in any of the \)</span>V$ voxels.</p>
<p>Control for type 1 errors(We wrongly have rejected the <span class="math notranslate nohighlight">\(H_0\)</span>).</p>
<ol class="arabic">
<li><p><strong>Bonferoni correction</strong>. The threshold is adjusted as <span class="math notranslate nohighlight">\(\alpha/V\)</span>.</p>
<p>Decreases too much the probability of correctly rejecting  <span class="math notranslate nohighlight">\(H_0\)</span>.</p>
<p>The voxels are not completely independent.</p>
</li>
<li><p><strong>Random field theory</strong> estimates the number of independent statistical tests based upon the spatial correlation, or smoothness.</p>
<p>The number of independent comparisons for smoothed data is:
$<span class="math notranslate nohighlight">\(V /FWHM^3 \)</span>$</p>
<p>where
<span class="math notranslate nohighlight">\(FWHM\)</span>-full width at half maximum</p>
<p>At a smoothness of 3 voxels, there would be 1 /27 as many independent comparisons.</p>
<p>The Euler characteristic of the data give us estimation  how many clusters of activity should be found by chance at a given statistical threshold</p>
</li>
</ol>
<p>FWER methods often give too conservative threshold, oftentimes FDR gives a better threshold.</p>
<p><strong>FDR (False discovery rate)</strong></p>
<p>Control for the false positives <span class="math notranslate nohighlight">\(FP\)</span> among all declared positives <span class="math notranslate nohighlight">\(P\)</span>.
$<span class="math notranslate nohighlight">\(FDR=E(FP/P)\)</span>$</p>
<p><strong>Special thanks to Michael Notter for the wonderful <a class="reference external" href="https://miykael.github.io/nipype_tutorial/">nipype tutorial</a></strong></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./seminars6_7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Group Analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-data-to-mni-template">Normalize data to MNI template</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation">Preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alternatively-prepare-yourself">Alternatively: Prepare yourself</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalization-with-ants">Normalization with ANTs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-parameters">Experiment parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-nodes">Specify Nodes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-input-output-stream">Specify input &amp; output stream</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-workflow-ants">Specify Workflow (ANTs)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-workflow">Visualize the workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-workflow">Run the Workflow</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-results">Visualize Results</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#nd-level-analysis">2nd level analysis</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-comparison-problem">Multiple comparison problem</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nadezhda Alsahanova, Aleksandra Beliaeva
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>